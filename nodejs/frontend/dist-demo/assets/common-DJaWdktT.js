var Le=Object.defineProperty,xe=Object.defineProperties;var ze=Object.getOwnPropertyDescriptors;var Y=Object.getOwnPropertySymbols,De=Object.getPrototypeOf,be=Object.prototype.hasOwnProperty,Ce=Object.prototype.propertyIsEnumerable,Ge=Reflect.get;var re=(n,t,e)=>t in n?Le(n,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[t]=e,m=(n,t)=>{for(var e in t||(t={}))be.call(t,e)&&re(n,e,t[e]);if(Y)for(var e of Y(t))Ce.call(t,e)&&re(n,e,t[e]);return n},Z=(n,t)=>xe(n,ze(t));var Ie=(n,t)=>{var e={};for(var s in n)be.call(n,s)&&t.indexOf(s)<0&&(e[s]=n[s]);if(n!=null&&Y)for(var s of Y(n))t.indexOf(s)<0&&Ce.call(n,s)&&(e[s]=n[s]);return e};var d=(n,t,e)=>re(n,typeof t!="symbol"?t+"":t,e);var ne=(n,t,e)=>Ge(De(n),e,t);var l=(n,t,e)=>new Promise((s,i)=>{var a=c=>{try{o(e.next(c))}catch(f){i(f)}},r=c=>{try{o(e.throw(c))}catch(f){i(f)}},o=c=>c.done?s(c.value):Promise.resolve(c.value).then(a,r);o((e=e.apply(n,t)).next())});import{p as B,P as R}from"./vendor-phaser-okqv2z6J.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const r of a.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&s(r)}).observe(document,{childList:!0,subtree:!0});function e(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function s(i){if(i.ep)return;i.ep=!0;const a=e(i);fetch(i.href,a)}})();var bt=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};function Ct(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var v=(n=>(n[n.TRACE=0]="TRACE",n[n.DEBUG=1]="DEBUG",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n))(v||{});const de={id:"default-logger-config",name:"Default Logger Configuration",version:"1.0.0",isActive:!0,lastModified:new Date,metadata:{description:"Default configuration for the enhanced logger system",author:"System",environment:"development"},globalLevel:v.INFO,objects:[{name:"Game",enabled:!0,level:v.DEBUG,includePerformance:!0,includeStackTrace:!0},{name:"Scene",enabled:!0,level:v.DEBUG,includePerformance:!0,includeStackTrace:!0},{name:"Player",enabled:!0,level:v.INFO,includePerformance:!1,includeStackTrace:!0},{name:"Network",enabled:!0,level:v.DEBUG,includePerformance:!0,includeStackTrace:!0},{name:"Performance",enabled:!0,level:v.INFO,includePerformance:!0,includeStackTrace:!1},{name:"Error",enabled:!0,level:v.ERROR,includePerformance:!0,includeStackTrace:!0}],server:{enabled:!0,endpoint:"/api/logs",apiKey:void 0,batchSize:50,retryAttempts:3,retryDelay:1e3,timeout:5e3,sendErrorsImmediately:!0,sendGameEventsImmediately:!0,includePerformanceData:!0,includeUserAgent:!0,includeSessionData:!0},console:{enabled:!0,colors:!0,showData:!0,showStackTrace:!0,maxDataDepth:3},formatOptions:{showTimestamp:!0,showLogLevel:!0,showObjectName:!0,useJsonStringify:!0,maxMessageLength:1e3},performance:{enabled:!0,fpsThreshold:30,memoryThreshold:80,networkMonitoring:!0,customMetrics:[]},buffering:{enabled:!0,maxBufferSize:100,flushInterval:5e3,persistOnUnload:!0},errorTracking:{enabled:!0,includeStackTrace:!0,trackUnhandledErrors:!0,trackPromiseRejections:!0,maxErrorHistory:100},session:{enabled:!0,generateSessionId:!0,includeUserInfo:!1,trackPageViews:!0},validate(){return Ne(this)},clone(n){return Ae(n||{})},toJSON(){const i=this,{toJSON:n,fromJSON:t,clone:e}=i,s=Ie(i,["toJSON","fromJSON","clone"]);return JSON.stringify(s,null,2)},fromJSON(n){try{const t=JSON.parse(n);return Ae(t)}catch(t){throw new Error(`Failed to parse JSON: ${t}`)}},isValid(){return this.validate().length===0},getSummary(){return{id:this.id,name:this.name,version:this.version,isActive:this.isActive,lastModified:this.lastModified,isValid:this.isValid(),validationErrors:this.validate(),metadataKeys:Object.keys(this.metadata)}}};function Ae(n){return Z(m(m({},de),n),{objects:[...de.objects,...n.objects||[]]})}function Ne(n){const t=[];return(n.globalLevel<v.TRACE||n.globalLevel>v.ERROR)&&t.push("Invalid global log level"),n.server.enabled&&!n.server.endpoint&&t.push("Server endpoint is required when server logging is enabled"),n.buffering.enabled&&n.buffering.maxBufferSize<=0&&t.push("Buffer size must be greater than 0"),n.buffering.enabled&&n.buffering.flushInterval<=0&&t.push("Flush interval must be greater than 0"),n.performance.enabled&&n.performance.fpsThreshold<=0&&t.push("FPS threshold must be greater than 0"),(n.performance.enabled&&n.performance.memoryThreshold<=0||n.performance.memoryThreshold>100)&&t.push("Memory threshold must be between 1 and 100"),t}class We{constructor(t){d(this,"logger");d(this,"errorHistory",[]);d(this,"errorCounts",new Map);d(this,"objectErrorCounts",new Map);d(this,"errorRateWindow",[]);d(this,"maxHistorySize");this.logger=t,this.maxHistorySize=100}trackError(t){this.errorHistory.push(t),this.errorHistory.length>this.maxHistorySize&&this.errorHistory.shift();const e=t.level,s=this.errorCounts.get(e)||0;this.errorCounts.set(e,s+1);const i=t.objectName,a=this.objectErrorCounts.get(i)||0;this.objectErrorCounts.set(i,a+1);const r=Date.now();this.errorRateWindow.push(r);const o=r-6e4;this.errorRateWindow=this.errorRateWindow.filter(c=>c>o),this.logger.debug("ErrorTracker","trackError",`Error tracked: ${t.message}`,{level:t.level,objectName:t.objectName,totalErrors:this.errorHistory.length,errorRate:this.calculateErrorRate()})}calculateErrorRate(){const e=Date.now()-6e4;return this.errorRateWindow.filter(i=>i>e).length}getStatistics(){const t=this.errorHistory.slice(-10);return{totalErrors:this.errorHistory.length,errorsByLevel:Object.fromEntries(this.errorCounts),errorsByObject:Object.fromEntries(this.objectErrorCounts),recentErrors:t,errorRate:this.calculateErrorRate()}}getErrorsByLevel(t){return this.errorHistory.filter(e=>e.level===t)}getErrorsByObject(t){return this.errorHistory.filter(e=>e.objectName===t)}getErrorsInTimeRange(t,e){return this.errorHistory}getMostFrequentErrors(t=10){const e=new Map;return this.errorHistory.forEach(s=>{const i=`${s.level}:${s.message}`,a=e.get(i);a?a.count++:e.set(i,{count:1,level:s.level})}),Array.from(e.entries()).map(([s,i])=>({message:s.split(":")[1],count:i.count,level:i.level})).sort((s,i)=>i.count-s.count).slice(0,t)}getErrorTrends(t=60){const e=Date.now(),s=t*60*1e3,i=10,a=s/i,r=[];for(let o=0;o<i;o++){const c=e-s+o*a,f=this.errorHistory.length;r.push({timestamp:c,count:f})}return r}clearHistory(){this.errorHistory=[],this.errorCounts.clear(),this.objectErrorCounts.clear(),this.errorRateWindow=[],this.logger.info("ErrorTracker","clearHistory","clearHistory","Error history cleared")}setMaxHistorySize(t){this.maxHistorySize=t,this.errorHistory.length>t&&(this.errorHistory=this.errorHistory.slice(-t)),this.logger.debug("ErrorTracker","setMaxHistorySize","setMaxHistorySize",`Max history size set to ${t}`)}exportErrorData(){return{statistics:this.getStatistics(),mostFrequentErrors:this.getMostFrequentErrors(),errorTrends:this.getErrorTrends(),exportTimestamp:new Date().toISOString(),totalErrors:this.errorHistory.length}}isErrorRateHigh(t=10){return this.calculateErrorRate()>t}getErrorRateAlertLevel(){const t=this.calculateErrorRate();return t<=5?"normal":t<=20?"warning":"critical"}getMemoryUsage(){const t=this.errorHistory.length,e=this.errorHistory.length,s=t*1024;return{historySize:t,totalErrors:e,memoryEstimate:s}}}class Ve{constructor(t){d(this,"defaultHeaders",{});d(this,"authToken");d(this,"requestTimeout",5e3);t!=null&&t.defaultTimeout&&(this.requestTimeout=t.defaultTimeout),t!=null&&t.defaultHeaders&&(this.defaultHeaders=m(m({},this.defaultHeaders),t.defaultHeaders))}request(t){return l(this,null,function*(){const{url:e,method:s,headers:i={},body:a,timeout:r=this.requestTimeout,signal:o,credentials:c}=t,f={method:s,headers:m(m(m({"Content-Type":"application/json"},this.defaultHeaders),this.authToken&&{Authorization:`Bearer ${this.authToken}`}),i),body:a?JSON.stringify(a):void 0,signal:o||AbortSignal.timeout(r),credentials:c||"same-origin"};try{const g=yield fetch(e,f);let u;try{u=yield g.json()}catch(C){u={}}const p={data:u,status:g.status,statusText:g.statusText,headers:this.extractHeaders(g.headers),ok:g.ok,url:g.url};if(!g.ok){const C=new Error(`HTTP ${g.status}: ${g.statusText}`);throw C.status=g.status,C.statusText=g.statusText,C.response=p,C.request=t,C}return p}catch(g){if(g instanceof Error&&g.name==="AbortError"){const u=new Error("Request timeout");throw u.request=t,u}throw g}})}get(t,e){return l(this,null,function*(){return this.request(m({url:t,method:"GET"},e))})}post(t,e,s){return l(this,null,function*(){return this.request(m({url:t,method:"POST",body:e},s))})}put(t,e,s){return l(this,null,function*(){return this.request(m({url:t,method:"PUT",body:e},s))})}delete(t,e){return l(this,null,function*(){return this.request(m({url:t,method:"DELETE"},e))})}setDefaultHeaders(t){this.defaultHeaders=m(m({},this.defaultHeaders),t)}setAuthToken(t){this.authToken=t}clearAuthToken(){this.authToken=void 0}setTimeout(t){this.requestTimeout=t}testConnection(t){return l(this,null,function*(){try{return(yield this.get(t)).ok}catch(e){return!1}})}extractHeaders(t){const e={};return t.forEach((s,i)=>{e[i]=s}),e}}const Ke={baseUrl:"http://localhost:3001",apiVersion:"v1",timeout:1e4,retryAttempts:3,retryDelay:1e3,logging:{single:"/api/logs/log",batch:"/api/logs/batch",stats:"/api/logs/stats",gameEvent:"/api/logs/game-event"},games:{state:"/api/games/state",action:"/api/games/action",result:"/api/games/result"},health:"/api/health",auth:{apiKeyHeader:"X-API-Key",sessionHeader:"X-Session-Token",required:!1},rateLimit:{maxRequestsPerMinute:1e3,windowMs:6e4}},He={baseUrl:"https://your-production-domain.com",apiVersion:"v1",timeout:15e3,retryAttempts:5,retryDelay:2e3,logging:{single:"/api/logs/log",batch:"/api/logs/batch",stats:"/api/logs/stats",gameEvent:"/api/logs/game-event"},games:{state:"/api/games/state",action:"/api/games/action",result:"/api/games/result"},health:"/api/health",auth:{apiKeyHeader:"X-API-Key",sessionHeader:"X-Session-Token",required:!0},rateLimit:{maxRequestsPerMinute:500,windowMs:6e4}};function we(){return typeof process=="undefined"?Ke:He}function oe(n){const t=we();return`${t.baseUrl}${t.logging[n]}`}function $e(){const n=we();return`${n.baseUrl}${n.health}`}class Ue{constructor(t){d(this,"config");d(this,"isOnline",!0);d(this,"retryQueue",[]);d(this,"isProcessingQueue",!1);d(this,"httpClient");d(this,"lastRequestTime",0);d(this,"minRequestInterval",100);this.config=t,this.httpClient=new Ve({defaultTimeout:t.timeout,defaultHeaders:m({"Content-Type":"application/json"},t.apiKey&&{Authorization:`Bearer ${t.apiKey}`})}),this.setupOnlineStatusMonitoring()}updateConfig(t){this.config=m(m({},this.config),t)}setupOnlineStatusMonitoring(){typeof window!="undefined"&&(window.addEventListener("online",()=>{this.isOnline=!0,this.processRetryQueue()}),window.addEventListener("offline",()=>{this.isOnline=!1}))}sendLog(t){return l(this,null,function*(){if(!this.config.enabled||!this.isOnline)return this.addToRetryQueue({data:t,attempts:0,type:"log"}),{success:!1,message:"Server logging disabled or offline"};try{return yield this.makeRequest("/log",{method:"POST",body:t})}catch(e){throw this.shouldRetryError(e)&&this.addToRetryQueue({data:t,attempts:0,type:"log"}),e instanceof Error?e:new Error(String(e))}})}sendLogs(t){return l(this,null,function*(){if(!this.config.enabled||!this.isOnline)return this.addToRetryQueue({data:t,attempts:0,type:"batch"}),{success:!1,message:"Server logging disabled or offline"};const e=this.splitIntoBatches(t,this.config.batchSize),s=[];for(const r of e)try{const o={logs:r,sessionId:this.getSessionId(),timestamp:new Date().toISOString(),version:"1.0.0"},c=yield this.makeRequest("/batch",{method:"POST",body:o});s.push(c)}catch(o){this.shouldRetryError(o)&&this.addToRetryQueue({data:r,attempts:0,type:"batch"});const c=o instanceof Error?o.message:String(o);s.push({success:!1,message:"Failed to send batch",error:c})}const i=s.every(r=>r.success),a=s.reduce((r,o)=>{var c;return r+(((c=o.logIds)==null?void 0:c.length)||0)},0);return{success:i,message:`Processed ${a} logs in ${e.length} batches`,logIds:s.flatMap(r=>r.logIds||[])}})}sendGameEvent(t){return l(this,null,function*(){if(!this.config.enabled||!this.isOnline)return this.addToRetryQueue({data:t,attempts:0,type:"gameEvent"}),{success:!1,message:"Server logging disabled or offline"};try{return yield this.makeRequest("/game-event",{method:"POST",body:t})}catch(e){throw this.shouldRetryError(e)&&this.addToRetryQueue({data:t,attempts:0,type:"gameEvent"}),e}})}makeRequest(t,e){return l(this,null,function*(){let s;switch(t){case"/log":s=oe("single");break;case"/batch":s=oe("batch");break;case"/game-event":s=oe("gameEvent");break;case"/health":s=$e();break;default:s=`${this.config.endpoint}${t}`}yield this.enforceRateLimit();try{const i=yield this.httpClient.post(s,e.body);return{success:i.ok,message:i.statusText,logIds:i.data.logIds,error:i.ok?void 0:i.data.error,retryAfter:i.data.retryAfter}}catch(i){throw i instanceof Error&&i.name==="AbortError"?new Error("Request timeout"):i}})}enforceRateLimit(){return l(this,null,function*(){const e=Date.now()-this.lastRequestTime;if(e<this.minRequestInterval){const s=this.minRequestInterval-e;yield this.delay(s)}this.lastRequestTime=Date.now()})}splitIntoBatches(t,e){const s=[];for(let i=0;i<t.length;i+=e)s.push(t.slice(i,i+e));return s}addToRetryQueue(t){this.retryQueue.find(s=>s.type===t.type&&JSON.stringify(s.data)===JSON.stringify(t.data))||(this.retryQueue.push(t),this.autoCleanRetryQueue(),this.isProcessingQueue||this.processRetryQueue())}processRetryQueue(){return l(this,null,function*(){if(!(this.isProcessingQueue||this.retryQueue.length===0||!this.isOnline)){this.isProcessingQueue=!0;try{for(;this.retryQueue.length>0;){const t=this.retryQueue.shift();if(t){if(t.attempts>=1){console.warn(`[LogServerClient] Max retry attempts (1) reached for ${t.type}, dropping item`);continue}try{let e;switch(t.type){case"log":e=yield this.sendLog(t.data);break;case"batch":e=yield this.sendLogs(t.data);break;case"gameEvent":e=yield this.sendGameEvent(t.data);break;default:continue}if(e.success)continue;t.attempts++,this.retryQueue.push(t),yield this.delay(3e3)}catch(e){t.attempts++,this.retryQueue.push(t),yield this.delay(3e3)}}}}finally{this.isProcessingQueue=!1}}})}delay(t){return new Promise(e=>setTimeout(e,t))}getSessionId(){return typeof sessionStorage!="undefined"&&sessionStorage.getItem("logger_session_id")||"unknown"}getRetryQueueStatus(){return{size:this.retryQueue.length,isProcessing:this.isProcessingQueue,isOnline:this.isOnline}}clearRetryQueue(){this.retryQueue=[]}getRetryQueueSize(){return this.retryQueue.length}autoCleanRetryQueue(){this.retryQueue.length>100&&(this.retryQueue=this.retryQueue.slice(-100/2),console.warn(`[LogServerClient] Retry queue exceeded 100 items, cleaned to ${this.retryQueue.length} items`))}forceProcessQueue(){return l(this,null,function*(){yield this.processRetryQueue()})}testConnection(){return l(this,null,function*(){if(!this.config.enabled)return!1;try{return(yield this.makeRequest("/health",{method:"GET",body:void 0})).success}catch(t){return!1}})}getServerStatus(){return l(this,null,function*(){return{online:yield this.testConnection(),endpoint:this.config.endpoint,lastCheck:new Date}})}shouldRetryError(t){return!(t.status&&t.status>=400&&t.status<500||t.status&&t.status>=500&&t.status!==503)}}const D=class D{constructor(t){d(this,"config");d(this,"logQueue",[]);d(this,"isProcessingQueue",!1);d(this,"queueProcessor",null);d(this,"batchProcessor",null);d(this,"logBuffer",[]);d(this,"performanceMetrics",new Map);d(this,"errorTracker");d(this,"serverClient");d(this,"memoryUsage",0);d(this,"lastMemoryCheck",0);d(this,"memoryCheckInterval",1e4);this.config=m(m({},de),t);const e={debug:(s,i,a,r)=>this.debug(s,i,a,r),error:(s,i,a,r)=>this.error(s,i,a,r)};this.errorTracker=new We(e),this.serverClient=new Ue(this.config.server),this.initializeOptimizedProcessing(),this.setupMinimalPerformanceMonitoring(),this.setupLogBuffering()}static getInstance(t){return D.instance||(D.instance=new D(t)),D.instance}initializeOptimizedProcessing(){if(typeof Worker!="undefined"&&this.config.buffering.enabled)try{this.queueProcessor=new Worker(URL.createObjectURL(new Blob([`
              self.onmessage = function(e) {
                const { entry, priority } = e.data;
                
                // Process log entry asynchronously
                const processedEntry = {
                  ...entry,
                  processedAt: Date.now(),
                  workerId: self.name || 'logger-worker'
                };
                
                self.postMessage({ type: 'processed', entry: processedEntry });
              };
            `]))),this.queueProcessor.onmessage=t=>{t.data.type==="processed"&&this.handleProcessedLog(t.data.entry)}}catch(t){console.warn("Web Worker not available, falling back to main thread processing")}this.setupBatchProcessing()}setupBatchProcessing(){this.config.buffering.enabled&&(this.batchProcessor=setInterval(()=>{this.processLogBatch()},this.config.buffering.flushInterval),typeof window!="undefined"&&window.addEventListener("beforeunload",()=>{this.processLogBatch()}))}setupMinimalPerformanceMonitoring(){this.config.performance.enabled&&(this.startMinimalMemoryMonitoring(),this.config.performance.networkMonitoring&&this.startMinimalNetworkMonitoring())}startMinimalMemoryMonitoring(){"memory"in performance&&setInterval(()=>{const t=Date.now();if(t-this.lastMemoryCheck>=this.memoryCheckInterval){const e=performance.memory;this.memoryUsage=Math.round(e.usedJSHeapSize/1048576),this.performanceMetrics.set("memory",{value:{used:this.memoryUsage,total:Math.round(e.totalJSHeapSize/1048576),limit:Math.round(e.jsHeapSizeLimit/1048576)},timestamp:t}),this.lastMemoryCheck=t;const s=e.usedJSHeapSize/e.jsHeapSizeLimit*100;s>this.config.performance.memoryThreshold&&this.queueLog("Performance","MemoryWarning",`High memory usage: ${s.toFixed(1)}%`,{memoryUsage:s,threshold:this.config.performance.memoryThreshold},v.WARN,2)}},5e3)}startMinimalNetworkMonitoring(){if("connection"in navigator){const t=navigator.connection;this.performanceMetrics.set("network",{value:{effectiveType:t.effectiveType,downlink:t.downlink,rtt:t.rtt},timestamp:Date.now()})}}setupLogBuffering(){this.config.buffering.enabled&&setInterval(()=>{this.flushLogBuffer()},this.config.buffering.flushInterval)}queueLog(t,e,s,i,a=v.INFO,r=1){if(!this.shouldLog(t,a))return;const o=this.createMinimalLogEntry(t,a,s,i,e);this.logQueue.push({entry:o,priority:r,timestamp:Date.now()}),this.logQueue.sort((c,f)=>f.priority-c.priority),r>=2&&this.processLogImmediately(o),this.isProcessingQueue||this.processQueueAsync(),this.logBuffer.push(o)}createMinimalLogEntry(t,e,s,i,a){return{level:v[e],objectName:t,message:s,data:this.sanitizeDataMinimal(i),methodName:a,stackTrace:(v.ERROR,void 0),performance:e>=v.WARN?this.getCurrentPerformanceMetricsMinimal():void 0}}sanitizeDataMinimal(t){if(t==null)return t;try{if(typeof t=="object"){if(Array.isArray(t))return t.slice(0,10).map(i=>typeof i=="object"&&i!==null?this.sanitizeDataMinimal(i):i);const e={},s=Object.keys(t).slice(0,10);for(const i of s)this.isSafeProperty(i,t[i])&&(typeof t[i]=="object"&&t[i]!==null?e[i]=this.sanitizeDataMinimal(t[i]):e[i]=t[i]);return e}return t}catch(e){return{error:"Data sanitization failed",originalData:String(t)}}}isSafeProperty(t,e){return typeof e!="function"&&typeof e!="symbol"&&!this.isSensitiveField(t)}isSensitiveField(t){return["password","token","key","secret","auth","credential"].some(s=>t.toLowerCase().includes(s))}getStackTraceMinimal(){try{const t=new Error().stack;return t?t.split(`
`).slice(1,4).join(`
`):"Stack trace not available"}catch(t){return"Stack trace not available"}}getCurrentPerformanceMetricsMinimal(){const t={};return this.memoryUsage>0&&(t.memory=this.memoryUsage),t}processLogImmediately(t){if(t.level==="ERROR"&&this.config.console.enabled){const e=this.formatLogMessage(t);console.error(e)}t.level==="ERROR"&&this.config.server.sendErrorsImmediately&&this.serverClient.sendLog(t).catch(()=>{})}processQueueAsync(){return l(this,null,function*(){if(!(this.isProcessingQueue||this.logQueue.length===0)){this.isProcessingQueue=!0;try{const t=Math.min(10,this.logQueue.length),e=this.logQueue.splice(0,t);if(this.queueProcessor)for(const s of e)this.queueProcessor.postMessage({entry:s.entry,priority:s.priority});else for(const s of e)this.handleProcessedLog(s.entry)}finally{this.isProcessingQueue=!1,this.logQueue.length>0&&setTimeout(()=>this.processQueueAsync(),0)}}})}handleProcessedLog(t){this.config.console.enabled&&this.outputToConsoleMinimal(t),this.config.buffering.enabled}formatLogMessage(t){const e=new Date().toISOString(),s=t.objectName||"Unknown",i=t.methodName||"Unknown",a=t.message||"",r=this.getLogLevelColor(t.level),o="\x1B[0m";let c="";if(t.data!==void 0&&t.data!==null)try{const g=(u,p)=>typeof p=="function"?"[Function]":typeof p=="symbol"?"[Symbol]":p instanceof Error?{name:p.name,message:p.message,stack:p.stack}:p;c=JSON.stringify(t.data,g,2)}catch(g){c=`[Circular or non-serializable data: ${g instanceof Error?g.message:String(g)}]`}return`[${e}] ${r}[${t.level}]${o} [${s}.${i}] ${a}${c?`
`+c:""}`}getLogLevelColor(t){switch(t){case"ERROR":return"\x1B[31m";case"WARN":return"\x1B[33m";case"INFO":return"\x1B[36m";case"DEBUG":return"\x1B[32m";case"TRACE":return"\x1B[35m";default:return"\x1B[37m"}}outputToConsoleMinimal(t){const e=this.formatLogMessage(t);switch(t.level){case"ERROR":console.error(e);break;case"WARN":console.warn(e);break;case"INFO":console.info(e);break;case"DEBUG":console.debug(e);break;default:console.log(e)}}processLogBatch(){return l(this,null,function*(){if(this.logQueue.length===0)return;const t=this.logQueue.filter(e=>e.entry.level==="ERROR"||e.priority>=2).map(e=>e.entry);if(t.length>0)try{yield this.serverClient.sendLogs(t)}catch(e){t.forEach(s=>{this.logQueue.push({entry:s,priority:0,timestamp:Date.now()})})}})}flushLogBuffer(){if(this.logBuffer.length>0){const t=[...this.logBuffer];this.logBuffer=[],this.serverClient.sendLogs(t).catch(e=>{this.warn("Logger","flushLogBuffer","Failed to send logs to server",{error:e})})}}shouldLog(t,e){var a;if(e>this.config.globalLevel)return!1;const s=(a=this.config.objects)==null?void 0:a.find(r=>r.name===t);if(s&&!s.enabled)return!1;const i=(s==null?void 0:s.level)||v.DEBUG;return e>=i}error(t,e,s,i){this.queueLog(t,e,s,i,v.ERROR,3)}warn(t,e,s,i){this.queueLog(t,e,s,i,v.WARN,2)}info(t,e,s,i){this.queueLog(t,e,s,i,v.INFO,1)}debug(t,e,s,i){this.queueLog(t,e,s,i,v.DEBUG,0)}trace(t,e,s,i){this.queueLog(t,e,s,i,v.TRACE,0)}logPerformance(t,e,s="",i){this.config.performance.enabled&&this.performanceMetrics.set(t,{value:{value:e,unit:s,metadata:i},timestamp:Date.now()})}getPerformanceMetrics(){return new Map(this.performanceMetrics)}getErrorStatistics(){return this.errorTracker.getStatistics()}flushLogs(){return l(this,null,function*(){yield this.processLogBatch(),this.flushLogBuffer()})}log(t,e,s,i){this.info(t,e,s,i)}logGameEvent(t,e){this.info("GameEvent",t,`Game event: ${t}`,e)}destroy(){this.queueProcessor&&(this.queueProcessor.terminate(),this.queueProcessor=null),this.batchProcessor&&(clearInterval(this.batchProcessor),this.batchProcessor=null),this.logQueue=[],this.logBuffer=[]}getQueueStatus(){return{size:this.logQueue.length,isProcessing:this.isProcessingQueue}}};d(D,"instance");let J=D;J.getInstance();const S=class S{static getInstance(t){return S.instance||(S.instance=J.getInstance(t)),S.instance}error(t,e,s,i){S.instance.error(t,e,s,i)}warn(t,e,s,i){S.instance.warn(t,e,s,i)}info(t,e,s,i){S.instance.info(t,e,s,i)}debug(t,e,s,i){S.instance.debug(t,e,s,i)}trace(t,e,s,i){S.instance.trace(t,e,s,i)}logPerformance(t,e,s="",i){S.instance.logPerformance(t,e,s,i)}getPerformanceMetrics(){return S.instance.getPerformanceMetrics()}getErrorStatistics(){return S.instance.getErrorStatistics()}destroy(){S.instance.destroy()}getQueueStatus(){return S.instance.getQueueStatus()}flushLogs(){S.instance.flushLogs()}log(t,e,s,i){S.instance.log(t,e,s,i)}logGameEvent(t,e){S.instance.logGameEvent(t,e)}};d(S,"instance");let A=S;const h=A.getInstance();class Xe{constructor(t){d(this,"game");d(this,"logger",A.getInstance());d(this,"config");this.config=t,this.logger.debug("BaseGame","constructor","Initializing minimal base game",{gameId:t.gameId});const e={type:B.AUTO,width:window.innerWidth,height:window.innerHeight,parent:"game-container",backgroundColor:"#1a1a2e",scene:[],physics:{default:"arcade",arcade:{gravity:{x:0,y:0},debug:!1}},scale:{mode:B.Scale.RESIZE,autoCenter:B.Scale.CENTER_BOTH,width:window.innerWidth,height:window.innerHeight}},s=m(m({},e),t.phaserConfig);this.logger.info("BaseGame","constructor","Creating Phaser game instance",{width:s.width,height:s.height}),this.game=new B.Game(s)}getConfig(){return this.config}getGame(){return this.game}addScene(t){const e=t.sys.settings.key;this.game.scene.add(e,t)}startScene(t){this.game.scene.start(t)}destroy(){this.game&&(this.logger.info("BaseGame","destroy","Destroying Phaser game instance"),this.game.destroy(!0),this.logger.debug("BaseGame","destroy","Phaser game instance destroyed successfully"))}}const G=class G{constructor(){d(this,"loadedConfigs",new Map)}static getInstance(){return G.instance||(G.instance=new G),G.instance}registerConfig(t,e){this.loadedConfigs.set(t,e),h.info("LoggingConfigLoader","registerConfig","registerConfig","Registered logging config for scene: ${sceneName}")}loadConfig(t){const e=this.loadedConfigs.get(t);if(!e)return h.warn("LoggingConfigLoader","loadConfig","loadConfig","No logging config found for scene: ${sceneName}, using default"),!1;try{return h.info("LoggingConfigLoader","loadConfig","Applied logging config for scene: ${sceneName}",{globalLevel:e.globalLevel,consoleEnabled:e.console.enabled,serverEnabled:e.server.enabled,objectCount:e.objects.length}),!0}catch(s){return h.error("LoggingConfigLoader","loadConfig","Failed to apply logging config for scene: ${sceneName}",s),!1}}getAvailableConfigs(){return Array.from(this.loadedConfigs.keys())}hasConfig(t){return this.loadedConfigs.has(t)}getConfig(t){return this.loadedConfigs.get(t)}resetToDefault(){try{h.info("LoggingConfigLoader","resetToDefault","resetToDefault","Reset logger to default configuration")}catch(t){h.error("LoggingConfigLoader","resetToDefault","Failed to reset logger to default configuration",t)}}};d(G,"instance");let ce=G;const x=class x{constructor(){d(this,"loadedConfigs",new Map)}static getInstance(){return x.instance||(x.instance=new x),x.instance}registerConfig(t,e){this.loadedConfigs.set(t,e),h.info("ResponsiveConfigLoader","registerConfig","registerConfig","Registered responsive config for scene: ${sceneName}")}loadConfig(t){const e=this.loadedConfigs.get(t);return e?(h.info("ResponsiveConfigLoader","loadConfig","loadConfig","Loaded responsive config for scene: ${sceneName}"),e):(h.warn("ResponsiveConfigLoader","loadConfig","loadConfig","No responsive config found for scene: ${sceneName}"),null)}hasConfig(t){return this.loadedConfigs.has(t)}getAvailableConfigs(){return Array.from(this.loadedConfigs.keys())}static getBreakpointKeys(t){return t.responsiveSettings?Object.keys(t.responsiveSettings):[]}static getObjectIds(t){const e=new Set;return t.default&&t.default.forEach(s=>e.add(s.id)),t.responsiveSettings&&Object.values(t.responsiveSettings).forEach(s=>{s.forEach(i=>e.add(i.id))}),Array.from(e)}static getCurrentBreakpointKey(t,e){if(!t.responsiveSettings)return null;const s=Object.entries(t.responsiveSettings).map(([i,a])=>{var o,c;const r=((c=(o=a[0])==null?void 0:o.breakpointCondition)==null?void 0:c.minWidth)||0;return{key:i,minWidth:r}}).sort((i,a)=>i.minWidth-a.minWidth);for(let i=s.length-1;i>=0;i--){const a=s[i];if(e>=a.minWidth)return a.key}return null}static getResponsiveBehavior(t,e){if(t.responsiveSettings){const s=this.getCurrentBreakpointKey(t,e);if(s&&t.responsiveSettings[s])return{breakpoint:s,layouts:t.responsiveSettings[s],default:t.default||[]}}return null}static getObjectLayout(t,e,s){if(t.default){const i=t.default.find(a=>a.id===e);if(i)return i.layoutProperties}if(t.responsiveSettings){const i=this.getCurrentBreakpointKey(t,s);if(i&&t.responsiveSettings[i]){const a=t.responsiveSettings[i].find(r=>r.id===e);if(a)return a.layoutProperties}}return null}static getObjectLayoutsAcrossBreakpoints(t,e){const s={};if(t.default){const i=t.default.find(a=>a.id===e);i&&(s.default=i.layoutProperties)}return t.responsiveSettings&&Object.entries(t.responsiveSettings).forEach(([i,a])=>{const r=a.find(o=>o.id===e);r&&(s[i]=r.layoutProperties)}),s}static hasObjectResponsiveConfig(t,e){return t.default&&t.default.some(s=>s.id===e)?!0:t.responsiveSettings?Object.values(t.responsiveSettings).some(s=>s.some(i=>i.id===e)):!1}static getBreakpointInfo(t){const e=this.getBreakpointKeys(t),s=this.getObjectIds(t);return{breakpoints:e,objectCount:s.length,hasDefault:!!t.default&&t.default.length>0}}static detectDeviceType(t){return t>=1024?"desktop":"mobile"}static getStandardBreakpoints(){return m({},this.STANDARD_BREAKPOINTS)}static validateConfig(t){const e=[],s=[];return t.responsiveSettings?Object.entries(t.responsiveSettings).forEach(([i,a])=>{Array.isArray(a)?a.forEach((r,o)=>{r.id||e.push(`Layout at index ${o} in breakpoint '${i}' missing id`),r.breakpointCondition||e.push(`Layout at index ${o} in breakpoint '${i}' missing breakpointCondition`),r.layoutProperties||e.push(`Layout at index ${o} in breakpoint '${i}' missing layoutProperties`)}):e.push(`Breakpoint '${i}' must be an array`)}):e.push("Missing responsiveSettings property"),t.default&&!Array.isArray(t.default)&&e.push("Default breakpoint must be an array"),{isValid:e.length===0,errors:e,warnings:s}}};d(x,"instance"),d(x,"STANDARD_BREAKPOINTS",{xs:{minWidth:0,maxWidth:575,name:"Extra Small"},sm:{minWidth:576,maxWidth:767,name:"Small"},md:{minWidth:768,maxWidth:991,name:"Medium"},lg:{minWidth:992,maxWidth:1199,name:"Large"},xl:{minWidth:1200,maxWidth:1399,name:"Extra Large"},xxl:{minWidth:1400,maxWidth:void 0,name:"Extra Extra Large"}});let ee=x;var Te=(n=>(n.CONTAINER="container",n.IMAGE="image",n.TEXT="text",n.BUTTON="button",n.BACKGROUND_CONTAINER="background-container",n.SHAPE="shape",n))(Te||{});const N=class N{constructor(){d(this,"loadedConfigs",new Map)}static getInstance(){return N.instance||(N.instance=new N),N.instance}registerConfig(t,e){this.loadedConfigs.set(t,e),h.info("SceneLoaderConfigLoader","registerConfig","registerConfig","Registered scene config for: ${sceneName}")}loadConfig(t){const e=this.loadedConfigs.get(t);return e?(h.info("SceneLoaderConfigLoader","loadConfig","loadConfig","Loaded scene config for: ${sceneName}"),e):(h.warn("SceneLoaderConfigLoader","loadConfig","loadConfig","No scene config found for: ${sceneName}"),null)}hasConfig(t){return this.loadedConfigs.has(t)}getAvailableConfigs(){return Array.from(this.loadedConfigs.keys())}findGameObject(t,e){const s=this.loadedConfigs.get(t);if(s)return this.findGameObjectRecursive(s.gameObjects,e)}findGameObjectRecursive(t,e){for(const s of t){if(s.id===e)return s;if(s.children.length>0){const i=this.findGameObjectRecursive(s.children,e);if(i)return i}}}getAllGameObjects(t){const e=this.loadedConfigs.get(t);return e?e.gameObjects:[]}};d(N,"instance");let le=N;var b=(n=>(n.IMAGE="image",n.AUDIO="audio",n.SPRITE="sprite",n.FONT="font",n.VIDEO="video",n.JSON="json",n.XML="xml",n.TEXT="text",n.BINARY="binary",n.CUSTOM="custom",n))(b||{}),w=(n=>(n.PENDING="pending",n.LOADING="loading",n.LOADED="loaded",n.FAILED="failed",n.CACHED="cached",n.DISPOSED="disposed",n))(w||{}),y=(n=>(n.CRITICAL="critical",n.HIGH="high",n.NORMAL="normal",n.LOW="low",n.BACKGROUND="background",n))(y||{}),L=(n=>(n.SCENE="scene",n.UI="ui",n.AUDIO="audio",n.TEXTURE="texture",n.FONT="font",n.CUSTOM="custom",n))(L||{}),T=(n=>(n.PENDING="pending",n.LOADING="loading",n.LOADED="loaded",n.FAILED="failed",n.DISPOSED="disposed",n))(T||{});class me{constructor(t,e,s,i){d(this,"assetId");d(this,"assetKey");d(this,"assetType");d(this,"assetState");d(this,"assetConfig");d(this,"assetData");d(this,"assetSize");d(this,"assetLoadTime");d(this,"assetLastAccessedTime");d(this,"assetAccessCount");d(this,"assetMetadata");d(this,"logger",A.getInstance());this.assetId=t,this.assetKey=e,this.assetType=s,this.assetConfig=i,this.assetState=w.PENDING,this.assetData=null,this.assetSize=0,this.assetLoadTime=0,this.assetLastAccessedTime=Date.now(),this.assetAccessCount=0,this.assetMetadata={},this.logger.debug("Asset","constructor",`Asset created: ${t}`,{assetKey:e,assetType:s,priority:i.priority})}setAssetState(t){const e=this.assetState;return this.assetState=t,this.logger.debug("Asset","setAssetState",`State changed: ${e} â†’ ${t}`,{assetId:this.assetId,assetKey:this.assetKey}),this}setAssetConfig(t){return this.assetConfig=t,this.logger.debug("Asset","setAssetConfig","Configuration updated",{assetId:this.assetId,assetKey:this.assetKey,priority:t.priority,preload:t.preload}),this}setAssetData(t){return this.assetData=t,this.assetLastAccessedTime=Date.now(),this.assetAccessCount++,this.logger.debug("Asset","setAssetData","Data updated",{assetId:this.assetId,assetKey:this.assetKey,dataType:typeof t,accessCount:this.assetAccessCount}),this}setAssetSize(t){return this.assetSize=t,this.logger.debug("Asset","setAssetSize","Size updated",{assetId:this.assetId,assetKey:this.assetKey,size:t}),this}setAssetLoadTime(t){return this.assetLoadTime=t,this.logger.debug("Asset","setAssetLoadTime","Load time updated",{assetId:this.assetId,assetKey:this.assetKey,loadTime:t}),this}setAssetLastAccessedTime(t){return this.assetLastAccessedTime=t,this.logger.debug("Asset","setAssetLastAccessedTime","Last accessed time updated",{assetId:this.assetId,assetKey:this.assetKey,lastAccessed:t}),this}setAssetAccessCount(t){return this.assetAccessCount=t,this.logger.debug("Asset","setAssetAccessCount","Access count updated",{assetId:this.assetId,assetKey:this.assetKey,accessCount:t}),this}setAssetMetadata(t){return this.assetMetadata=m(m({},this.assetMetadata),t),this.logger.debug("Asset","setAssetMetadata","Metadata updated",{assetId:this.assetId,assetKey:this.assetKey,metadataKeys:Object.keys(t)}),this}getAssetState(){return this.assetState}getAssetConfig(){return this.assetConfig}getAssetData(){return this.assetLastAccessedTime=Date.now(),this.assetAccessCount++,this.logger.debug("Asset","getAssetData","Data accessed",{assetId:this.assetId,assetKey:this.assetKey,accessCount:this.assetAccessCount}),this.assetData}getAssetSize(){return this.assetSize}getAssetLoadTime(){return this.assetLoadTime}getAssetLastAccessedTime(){return this.assetLastAccessedTime}getAssetAccessCount(){return this.assetAccessCount}getAssetMetadata(){return this.assetMetadata}loadAsset(){return l(this,null,function*(){if(this.assetState===w.LOADED)return this.logger.debug("Asset","loadAsset","Asset already loaded",{assetId:this.assetId,assetKey:this.assetKey}),this;if(this.assetState===w.LOADING)return this.logger.warn("Asset","loadAsset","Asset already loading",{assetId:this.assetId,assetKey:this.assetKey}),this;try{this.setAssetState(w.LOADING);const t=Date.now();this.logger.info("Asset","loadAsset","Starting asset load",{assetId:this.assetId,assetKey:this.assetKey,assetType:this.assetType,path:this.assetConfig.path}),yield this.loadAssetByType();const e=Date.now()-t;return this.setAssetLoadTime(e),this.setAssetState(w.LOADED),this.logger.info("Asset","loadAsset","Asset loaded successfully",{assetId:this.assetId,assetKey:this.assetKey,loadTime:e}),this}catch(t){throw this.setAssetState(w.FAILED),this.logger.error("Asset","loadAsset","Asset load failed",{assetId:this.assetId,assetKey:this.assetKey,error:t instanceof Error?t.message:String(t)}),t}})}unloadAsset(){return l(this,null,function*(){if(this.assetState===w.PENDING)return this.logger.debug("Asset","unloadAsset","Asset not loaded",{assetId:this.assetId,assetKey:this.assetKey}),this;try{return this.logger.info("Asset","unloadAsset","Unloading asset",{assetId:this.assetId,assetKey:this.assetKey}),this.assetData=null,this.assetSize=0,this.assetLoadTime=0,this.setAssetState(w.PENDING),this.logger.info("Asset","unloadAsset","Asset unloaded successfully",{assetId:this.assetId,assetKey:this.assetKey}),this}catch(t){throw this.logger.error("Asset","unloadAsset","Asset unload failed",{assetId:this.assetId,assetKey:this.assetKey,error:t instanceof Error?t.message:String(t)}),t}})}isAssetLoaded(){return this.assetState===w.LOADED}isAssetCached(){return this.assetState===w.CACHED}isAssetPreloadable(){return this.assetConfig.preload}getAssetUrl(){return this.assetConfig.path}cloneAsset(){const t=new me(`${this.assetId}_clone_${Date.now()}`,`${this.assetKey}_clone`,this.assetType,m({},this.assetConfig));return t.setAssetMetadata(this.assetMetadata),this.logger.debug("Asset","cloneAsset","Asset cloned",{originalId:this.assetId,clonedId:t.assetId,assetKey:this.assetKey}),t}disposeAsset(){this.logger.info("Asset","disposeAsset","Disposing asset",{assetId:this.assetId,assetKey:this.assetKey}),this.assetData=null,this.assetSize=0,this.assetLoadTime=0,this.assetAccessCount=0,this.assetMetadata={},this.setAssetState(w.DISPOSED)}loadAssetByType(){return l(this,null,function*(){switch(this.assetType){case b.IMAGE:yield this.loadImageAsset();break;case b.AUDIO:yield this.loadAudioAsset();break;case b.SPRITE:yield this.loadSpriteAsset();break;case b.FONT:yield this.loadFontAsset();break;case b.VIDEO:yield this.loadVideoAsset();break;case b.JSON:yield this.loadJsonAsset();break;case b.XML:yield this.loadXmlAsset();break;case b.TEXT:yield this.loadTextAsset();break;case b.BINARY:yield this.loadBinaryAsset();break;case b.CUSTOM:yield this.loadCustomAsset();break;default:throw new Error(`Unsupported asset type: ${this.assetType}`)}})}loadImageAsset(){return l(this,null,function*(){yield new Promise(t=>setTimeout(t,100)),this.assetData={type:"image",url:this.assetConfig.path,width:1920,height:1080,format:"png"},this.assetSize=1024*1024})}loadAudioAsset(){return l(this,null,function*(){yield new Promise(t=>setTimeout(t,200)),this.assetData={type:"audio",url:this.assetConfig.path,duration:30,format:"mp3"},this.assetSize=512*1024})}loadSpriteAsset(){return l(this,null,function*(){yield new Promise(t=>setTimeout(t,150)),this.assetData={type:"sprite",url:this.assetConfig.path,frames:10,frameWidth:64,frameHeight:64},this.assetSize=256*1024})}loadFontAsset(){return l(this,null,function*(){yield new Promise(t=>setTimeout(t,50)),this.assetData={type:"font",url:this.assetConfig.path,family:"Arial",weight:"normal"},this.assetSize=64*1024})}loadVideoAsset(){return l(this,null,function*(){yield new Promise(t=>setTimeout(t,500)),this.assetData={type:"video",url:this.assetConfig.path,duration:60,width:1920,height:1080,format:"mp4"},this.assetSize=10*1024*1024})}loadJsonAsset(){return l(this,null,function*(){yield new Promise(t=>setTimeout(t,25)),this.assetData={type:"json",url:this.assetConfig.path,data:{mock:"data"}},this.assetSize=1*1024})}loadXmlAsset(){return l(this,null,function*(){yield new Promise(t=>setTimeout(t,30)),this.assetData={type:"xml",url:this.assetConfig.path,data:"<root><item>mock</item></root>"},this.assetSize=2*1024})}loadTextAsset(){return l(this,null,function*(){yield new Promise(t=>setTimeout(t,20)),this.assetData={type:"text",url:this.assetConfig.path,content:"Mock text content"},this.assetSize=512})}loadBinaryAsset(){return l(this,null,function*(){yield new Promise(t=>setTimeout(t,100)),this.assetData={type:"binary",url:this.assetConfig.path,size:1024},this.assetSize=1024})}loadCustomAsset(){return l(this,null,function*(){yield new Promise(t=>setTimeout(t,75)),this.assetData={type:"custom",url:this.assetConfig.path,customType:this.assetMetadata.customType||"unknown"},this.assetSize=5*1024})}}class _e{constructor(t,e){d(this,"factoryId");d(this,"factoryConfig");d(this,"factoryStatistics");d(this,"factoryMetadata");d(this,"logger",A.getInstance());d(this,"assetTypeCreators",new Map);d(this,"creationTimes",[]);this.factoryId=t,this.factoryConfig=m({enableValidation:!0,enableCaching:!0,enablePooling:!1,defaultPriority:y.NORMAL,defaultPreload:!0,defaultCache:!0,metadata:{}},e),this.factoryStatistics={totalCreated:0,createdByType:{},totalCloned:0,totalConfigured:0,totalValidated:0,validationFailures:0,lastCreationTime:0},this.factoryMetadata={},this.initializeDefaultAssetTypeCreators(),this.logger.debug("AssetFactory","constructor",`Factory created: ${t}`,{factoryId:t,enableValidation:this.factoryConfig.enableValidation,enableCaching:this.factoryConfig.enableCaching,defaultPriority:this.factoryConfig.defaultPriority})}setFactoryConfig(t){return this.factoryConfig=t,this.logger.debug("AssetFactory","setFactoryConfig","Configuration updated",{factoryId:this.factoryId,enableValidation:t.enableValidation,enableCaching:t.enableCaching,defaultPriority:t.defaultPriority}),this}setFactoryMetadata(t){return this.factoryMetadata=m(m({},this.factoryMetadata),t),this.logger.debug("AssetFactory","setFactoryMetadata","Metadata updated",{factoryId:this.factoryId,metadataKeys:Object.keys(t)}),this}getFactoryConfig(){return this.factoryConfig}getFactoryStatistics(){return this.factoryStatistics}getFactoryMetadata(){return this.factoryMetadata}createAsset(t){return l(this,null,function*(){const e=Date.now();try{if(this.logger.info("AssetFactory","createAsset","Creating asset",{factoryId:this.factoryId,assetType:t.assetType,assetKey:t.assetKey,assetPath:t.assetPath}),!this.isAssetTypeSupported(t.assetType))throw new Error(`Unsupported asset type: ${t.assetType}`);const s=this.assetTypeCreators.get(t.assetType);if(!s)throw new Error(`No creator registered for asset type: ${t.assetType}`);const i=yield s(t);return this.updateCreationStatistics(t.assetType,e),this.logger.info("AssetFactory","createAsset","Asset created successfully",{factoryId:this.factoryId,assetId:i.assetId,assetKey:i.assetKey,assetType:i.assetType,creationTime:Date.now()-e}),i}catch(s){throw this.factoryStatistics.validationFailures++,this.logger.error("AssetFactory","createAsset","Asset creation failed",{factoryId:this.factoryId,assetType:t.assetType,assetKey:t.assetKey,error:s instanceof Error?s.message:String(s)}),s}})}createAssetFromConfig(t){return l(this,null,function*(){const e=Date.now();try{if(this.logger.info("AssetFactory","createAssetFromConfig","Creating asset from config",{factoryId:this.factoryId,assetType:t.type,assetKey:t.key,assetPath:t.path}),this.factoryConfig.enableValidation&&!(yield this.validateAssetConfig(t)))throw new Error(`Invalid asset configuration for key: ${t.key}`);const s={assetType:t.type,assetKey:t.key,assetPath:t.path,priority:t.priority,preload:t.preload,cache:t.cache,metadata:t.metadata},i=yield this.createAsset(s);return this.logger.info("AssetFactory","createAssetFromConfig","Asset created from config successfully",{factoryId:this.factoryId,assetId:i.assetId,assetKey:i.assetKey,creationTime:Date.now()-e}),i}catch(s){throw this.logger.error("AssetFactory","createAssetFromConfig","Asset creation from config failed",{factoryId:this.factoryId,assetKey:t.key,error:s instanceof Error?s.message:String(s)}),s}})}cloneAsset(t,e){return l(this,null,function*(){const s=Date.now();try{this.logger.info("AssetFactory","cloneAsset","Cloning asset",{factoryId:this.factoryId,originalAssetId:t.assetId,originalAssetKey:t.assetKey,newKey:e});const i=t.cloneAsset();return e&&this.logger.warn("AssetFactory","cloneAsset","Cannot modify readonly assetKey",{factoryId:this.factoryId,originalKey:t.assetKey,requestedKey:e}),this.factoryStatistics.totalCloned++,this.factoryStatistics.lastCreationTime=Date.now(),this.logger.info("AssetFactory","cloneAsset","Asset cloned successfully",{factoryId:this.factoryId,originalAssetId:t.assetId,clonedAssetId:i.assetId,cloneTime:Date.now()-s}),i}catch(i){throw this.logger.error("AssetFactory","cloneAsset","Asset cloning failed",{factoryId:this.factoryId,originalAssetId:t.assetId,error:i instanceof Error?i.message:String(i)}),i}})}configureAsset(t,e){return l(this,null,function*(){try{this.logger.info("AssetFactory","configureAsset","Configuring asset",{factoryId:this.factoryId,assetId:t.assetId,assetKey:t.assetKey,configKeys:Object.keys(e)});const s=t.getAssetConfig(),i=m(m({},s),e);if(this.factoryConfig.enableValidation&&!(yield this.validateAssetConfig(i)))throw new Error(`Invalid asset configuration for key: ${t.assetKey}`);return t.setAssetConfig(i),this.factoryStatistics.totalConfigured++,this.logger.info("AssetFactory","configureAsset","Asset configured successfully",{factoryId:this.factoryId,assetId:t.assetId,assetKey:t.assetKey}),t}catch(s){throw this.logger.error("AssetFactory","configureAsset","Asset configuration failed",{factoryId:this.factoryId,assetId:t.assetId,error:s instanceof Error?s.message:String(s)}),s}})}validateAssetConfig(t){return l(this,null,function*(){try{return this.logger.debug("AssetFactory","validateAssetConfig","Validating asset config",{factoryId:this.factoryId,assetKey:t.key,assetType:t.type}),!t.key||typeof t.key!="string"?(this.logger.warn("AssetFactory","validateAssetConfig","Invalid asset key",{factoryId:this.factoryId,key:t.key}),this.factoryStatistics.validationFailures++,!1):!t.path||typeof t.path!="string"?(this.logger.warn("AssetFactory","validateAssetConfig","Invalid asset path",{factoryId:this.factoryId,path:t.path}),this.factoryStatistics.validationFailures++,!1):Object.values(b).includes(t.type)?Object.values(y).includes(t.priority)?typeof t.preload!="boolean"?(this.logger.warn("AssetFactory","validateAssetConfig","Invalid preload value",{factoryId:this.factoryId,preload:t.preload}),this.factoryStatistics.validationFailures++,!1):typeof t.cache!="boolean"?(this.logger.warn("AssetFactory","validateAssetConfig","Invalid cache value",{factoryId:this.factoryId,cache:t.cache}),this.factoryStatistics.validationFailures++,!1):(this.factoryStatistics.totalValidated++,this.logger.debug("AssetFactory","validateAssetConfig","Asset config validation passed",{factoryId:this.factoryId,assetKey:t.key}),!0):(this.logger.warn("AssetFactory","validateAssetConfig","Invalid asset priority",{factoryId:this.factoryId,priority:t.priority}),this.factoryStatistics.validationFailures++,!1):(this.logger.warn("AssetFactory","validateAssetConfig","Invalid asset type",{factoryId:this.factoryId,type:t.type}),this.factoryStatistics.validationFailures++,!1)}catch(e){return this.factoryStatistics.validationFailures++,this.logger.error("AssetFactory","validateAssetConfig","Asset config validation failed",{factoryId:this.factoryId,assetKey:t.key,error:e instanceof Error?e.message:String(e)}),!1}})}registerAssetTypeCreator(t,e){return this.assetTypeCreators.set(t,e),this.logger.debug("AssetFactory","registerAssetTypeCreator","Asset type creator registered",{factoryId:this.factoryId,assetType:t}),this}unregisterAssetTypeCreator(t){return this.assetTypeCreators.delete(t)?this.logger.debug("AssetFactory","unregisterAssetTypeCreator","Asset type creator unregistered",{factoryId:this.factoryId,assetType:t}):this.logger.warn("AssetFactory","unregisterAssetTypeCreator","Asset type creator not found",{factoryId:this.factoryId,assetType:t}),this}isAssetTypeSupported(t){return this.assetTypeCreators.has(t)}getSupportedAssetTypes(){return Array.from(this.assetTypeCreators.keys())}getAssetTypeCreator(t){return this.assetTypeCreators.get(t)||null}createAssets(t){return l(this,null,function*(){this.logger.info("AssetFactory","createAssets","Creating multiple assets",{factoryId:this.factoryId,count:t.length});const e=t.map(r=>this.createAsset(r)),s=yield Promise.allSettled(e),i=[],a=s.filter(r=>r.status==="rejected").length;for(const r of s)r.status==="fulfilled"&&i.push(r.value);return this.logger.info("AssetFactory","createAssets","Multiple assets creation completed",{factoryId:this.factoryId,total:t.length,successful:i.length,failed:a}),i})}createAssetsFromConfigs(t){return l(this,null,function*(){this.logger.info("AssetFactory","createAssetsFromConfigs","Creating multiple assets from configs",{factoryId:this.factoryId,count:t.length});const e=t.map(r=>this.createAssetFromConfig(r)),s=yield Promise.allSettled(e),i=[],a=s.filter(r=>r.status==="rejected").length;for(const r of s)r.status==="fulfilled"&&i.push(r.value);return this.logger.info("AssetFactory","createAssetsFromConfigs","Multiple assets creation from configs completed",{factoryId:this.factoryId,total:t.length,successful:i.length,failed:a}),i})}getCreationStatistics(){const t=this.factoryStatistics.totalCreated,e=t+this.factoryStatistics.validationFailures,s=e>0?t/e*100:100,i=this.creationTimes.length>0?this.creationTimes.reduce((r,o)=>r+o,0)/this.creationTimes.length:0,a=this.getMostCreatedAssetType();return{totalCreated:t,successRate:s,averageCreationTime:i,mostCreatedType:a}}clearFactory(){return this.logger.info("AssetFactory","clearFactory","Clearing factory",{factoryId:this.factoryId}),this.factoryStatistics={totalCreated:0,createdByType:{},totalCloned:0,totalConfigured:0,totalValidated:0,validationFailures:0,lastCreationTime:0},this.creationTimes.length=0,this.factoryMetadata={},this.logger.info("AssetFactory","clearFactory","Factory cleared",{factoryId:this.factoryId}),this}updateFactory(t){this.logger.debug("AssetFactory","updateFactory","Factory updated",{factoryId:this.factoryId,deltaTime:t})}initializeDefaultAssetTypeCreators(){const t=Object.values(b);for(const e of t)this.registerAssetTypeCreator(e,this.createDefaultAsset.bind(this));this.logger.debug("AssetFactory","initializeDefaultAssetTypeCreators","Default asset type creators initialized",{factoryId:this.factoryId,supportedTypes:t.length})}createDefaultAsset(t){return l(this,null,function*(){const e={key:t.assetKey,path:t.assetPath,type:t.assetType,priority:t.priority||this.factoryConfig.defaultPriority,preload:t.preload!==void 0?t.preload:this.factoryConfig.defaultPreload,cache:t.cache!==void 0?t.cache:this.factoryConfig.defaultCache,metadata:t.metadata||{}},s=`${this.factoryId}_${t.assetKey}_${Date.now()}`;return new me(s,t.assetKey,t.assetType,e)})}updateCreationStatistics(t,e){const s=Date.now()-e;this.factoryStatistics.totalCreated++,this.factoryStatistics.createdByType[t]=(this.factoryStatistics.createdByType[t]||0)+1,this.factoryStatistics.lastCreationTime=Date.now(),this.creationTimes.push(s),this.creationTimes.length>100&&this.creationTimes.shift()}getMostCreatedAssetType(){let t=b.IMAGE,e=0;for(const[s,i]of Object.entries(this.factoryStatistics.createdByType))i>e&&(e=i,t=s);return t}}class pe{constructor(t,e,s){d(this,"bundleId");d(this,"bundleType");d(this,"bundleState");d(this,"bundleConfig");d(this,"bundleAssets");d(this,"bundleProgress");d(this,"bundleMetadata");d(this,"logger",A.getInstance());this.bundleId=t,this.bundleType=e,this.bundleConfig=s,this.bundleState=T.PENDING,this.bundleAssets=new Map,this.bundleProgress={totalAssets:0,loadedAssets:0,failedAssets:0,percentage:0,estimatedTimeRemaining:0},this.bundleMetadata={},this.logger.debug("AssetBundle","constructor",`Bundle created: ${t}`,{bundleType:e,priority:s.priority})}setBundleState(t){const e=this.bundleState;return this.bundleState=t,this.logger.debug("AssetBundle","setBundleState",`State changed: ${e} â†’ ${t}`,{bundleId:this.bundleId,bundleType:this.bundleType}),this}setBundleConfig(t){return this.bundleConfig=t,this.logger.debug("AssetBundle","setBundleConfig","Configuration updated",{bundleId:this.bundleId,bundleType:this.bundleType,priority:t.priority,preload:t.preload}),this}setBundleMetadata(t){return this.bundleMetadata=m(m({},this.bundleMetadata),t),this.logger.debug("AssetBundle","setBundleMetadata","Metadata updated",{bundleId:this.bundleId,bundleType:this.bundleType,metadataKeys:Object.keys(t)}),this}getBundleState(){return this.bundleState}getBundleConfig(){return this.bundleConfig}getBundleAssets(){return this.bundleAssets}getBundleProgress(){return this.bundleProgress}getBundleMetadata(){return this.bundleMetadata}addAsset(t){return this.bundleAssets.set(t.assetKey,t),this.updateProgress(),this.logger.debug("AssetBundle","addAsset","Asset added to bundle",{bundleId:this.bundleId,assetKey:t.assetKey,assetType:t.assetType,totalAssets:this.bundleAssets.size}),this}removeAsset(t){return this.bundleAssets.delete(t)?(this.updateProgress(),this.logger.debug("AssetBundle","removeAsset","Asset removed from bundle",{bundleId:this.bundleId,assetKey:t,totalAssets:this.bundleAssets.size})):this.logger.warn("AssetBundle","removeAsset","Asset not found in bundle",{bundleId:this.bundleId,assetKey:t}),this}getAsset(t){const e=this.bundleAssets.get(t)||null;return this.logger.debug("AssetBundle","getAsset","Asset retrieved from bundle",{bundleId:this.bundleId,assetKey:t,found:e!==null}),e}getAssetsByType(t){const e=Array.from(this.bundleAssets.values()).filter(s=>s.assetType===t);return this.logger.debug("AssetBundle","getAssetsByType","Assets filtered by type",{bundleId:this.bundleId,assetType:t,count:e.length}),e}loadBundle(){return l(this,null,function*(){if(this.bundleState===T.LOADED)return this.logger.debug("AssetBundle","loadBundle","Bundle already loaded",{bundleId:this.bundleId}),this;if(this.bundleState===T.LOADING)return this.logger.warn("AssetBundle","loadBundle","Bundle already loading",{bundleId:this.bundleId}),this;try{this.setBundleState(T.LOADING);const t=Date.now();this.logger.info("AssetBundle","loadBundle","Starting bundle load",{bundleId:this.bundleId,bundleType:this.bundleType,totalAssets:this.bundleAssets.size}),yield this.loadAllAssets();const e=Date.now()-t;return this.setBundleState(T.LOADED),this.logger.info("AssetBundle","loadBundle","Bundle loaded successfully",{bundleId:this.bundleId,loadTime:e,loadedAssets:this.bundleProgress.loadedAssets,failedAssets:this.bundleProgress.failedAssets}),this}catch(t){throw this.setBundleState(T.FAILED),this.logger.error("AssetBundle","loadBundle","Bundle load failed",{bundleId:this.bundleId,error:t instanceof Error?t.message:String(t)}),t}})}unloadBundle(){return l(this,null,function*(){if(this.bundleState===T.PENDING)return this.logger.debug("AssetBundle","unloadBundle","Bundle not loaded",{bundleId:this.bundleId}),this;try{return this.logger.info("AssetBundle","unloadBundle","Unloading bundle",{bundleId:this.bundleId,totalAssets:this.bundleAssets.size}),yield this.unloadAllAssets(),this.setBundleState(T.PENDING),this.resetProgress(),this.logger.info("AssetBundle","unloadBundle","Bundle unloaded successfully",{bundleId:this.bundleId}),this}catch(t){throw this.logger.error("AssetBundle","unloadBundle","Bundle unload failed",{bundleId:this.bundleId,error:t instanceof Error?t.message:String(t)}),t}})}isBundleLoaded(){return this.bundleState===T.LOADED}isBundleLoading(){return this.bundleState===T.LOADING}getBundleSize(){let t=0;for(const e of Array.from(this.bundleAssets.values()))t+=e.getAssetSize();return this.logger.debug("AssetBundle","getBundleSize","Bundle size calculated",{bundleId:this.bundleId,totalSize:t}),t}getBundleAssetCount(){return this.bundleAssets.size}cloneBundle(){const t=new pe(`${this.bundleId}_clone_${Date.now()}`,this.bundleType,m({},this.bundleConfig));t.setBundleMetadata(this.bundleMetadata);for(const e of Array.from(this.bundleAssets.values())){const s=e.cloneAsset();t.addAsset(s)}return this.logger.debug("AssetBundle","cloneBundle","Bundle cloned",{originalId:this.bundleId,clonedId:t.bundleId,assetCount:this.bundleAssets.size}),t}disposeBundle(){this.logger.info("AssetBundle","disposeBundle","Disposing bundle",{bundleId:this.bundleId,assetCount:this.bundleAssets.size});for(const t of Array.from(this.bundleAssets.values()))t.disposeAsset();this.bundleAssets.clear(),this.bundleMetadata={},this.resetProgress(),this.setBundleState(T.DISPOSED)}loadAllAssets(){return l(this,null,function*(){const e=Array.from(this.bundleAssets.values()).map(s=>this.loadAssetSafely(s));yield Promise.allSettled(e),this.updateProgress()})}unloadAllAssets(){return l(this,null,function*(){const e=Array.from(this.bundleAssets.values()).map(s=>this.unloadAssetSafely(s));yield Promise.allSettled(e),this.updateProgress()})}loadAssetSafely(t){return l(this,null,function*(){try{yield t.loadAsset(),this.logger.debug("AssetBundle","loadAssetSafely","Asset loaded successfully",{bundleId:this.bundleId,assetKey:t.assetKey})}catch(e){this.logger.error("AssetBundle","loadAssetSafely","Asset load failed",{bundleId:this.bundleId,assetKey:t.assetKey,error:e instanceof Error?e.message:String(e)})}})}unloadAssetSafely(t){return l(this,null,function*(){try{yield t.unloadAsset(),this.logger.debug("AssetBundle","unloadAssetSafely","Asset unloaded successfully",{bundleId:this.bundleId,assetKey:t.assetKey})}catch(e){this.logger.error("AssetBundle","unloadAssetSafely","Asset unload failed",{bundleId:this.bundleId,assetKey:t.assetKey,error:e instanceof Error?e.message:String(e)})}})}updateProgress(){const t=this.bundleAssets.size;let e=0,s=0;for(const r of Array.from(this.bundleAssets.values()))r.isAssetLoaded()?e++:r.getAssetState()==="failed"&&s++;const i=t>0?Math.round(e/t*100):0,a=this.calculateEstimatedTimeRemaining(e,t);this.bundleProgress={totalAssets:t,loadedAssets:e,failedAssets:s,percentage:i,estimatedTimeRemaining:a},this.logger.debug("AssetBundle","updateProgress","Progress updated",{bundleId:this.bundleId,totalAssets:t,loadedAssets:e,failedAssets:s,percentage:i})}resetProgress(){this.bundleProgress={totalAssets:0,loadedAssets:0,failedAssets:0,percentage:0,estimatedTimeRemaining:0}}calculateEstimatedTimeRemaining(t,e){return t===0||e===0?0:(e-t)*100}}class qe{constructor(t,e){d(this,"bundleFactoryId");d(this,"bundleFactoryConfig");d(this,"bundleFactoryStatistics");d(this,"bundleFactoryMetadata");d(this,"logger",A.getInstance());d(this,"bundleTypeCreators",new Map);d(this,"creationTimes",[]);this.bundleFactoryId=t,this.bundleFactoryConfig=m({enableValidation:!0,enableCaching:!0,enablePooling:!1,defaultPriority:y.NORMAL,defaultPreload:!0,defaultCache:!0,maxBundleSize:100*1024*1024,metadata:{}},e),this.bundleFactoryStatistics={totalCreated:0,createdByType:{},totalCloned:0,totalConfigured:0,totalValidated:0,validationFailures:0,lastCreationTime:0},this.bundleFactoryMetadata={},this.initializeDefaultBundleTypeCreators(),this.logger.debug("AssetBundleFactory","constructor",`Bundle factory created: ${t}`,{bundleFactoryId:t,enableValidation:this.bundleFactoryConfig.enableValidation,enableCaching:this.bundleFactoryConfig.enableCaching,defaultPriority:this.bundleFactoryConfig.defaultPriority,maxBundleSize:this.bundleFactoryConfig.maxBundleSize})}setBundleFactoryConfig(t){return this.bundleFactoryConfig=t,this.logger.debug("AssetBundleFactory","setBundleFactoryConfig","Configuration updated",{bundleFactoryId:this.bundleFactoryId,enableValidation:t.enableValidation,enableCaching:t.enableCaching,defaultPriority:t.defaultPriority,maxBundleSize:t.maxBundleSize}),this}setBundleFactoryMetadata(t){return this.bundleFactoryMetadata=m(m({},this.bundleFactoryMetadata),t),this.logger.debug("AssetBundleFactory","setBundleFactoryMetadata","Metadata updated",{bundleFactoryId:this.bundleFactoryId,metadataKeys:Object.keys(t)}),this}getBundleFactoryConfig(){return this.bundleFactoryConfig}getBundleFactoryStatistics(){return this.bundleFactoryStatistics}getBundleFactoryMetadata(){return this.bundleFactoryMetadata}createBundle(t){return l(this,null,function*(){const e=Date.now();try{if(this.logger.info("AssetBundleFactory","createBundle","Creating bundle",{bundleFactoryId:this.bundleFactoryId,bundleType:t.bundleType,bundleId:t.bundleId,bundleName:t.bundleName}),!this.isBundleTypeSupported(t.bundleType))throw new Error(`Unsupported bundle type: ${t.bundleType}`);const s=this.bundleTypeCreators.get(t.bundleType);if(!s)throw new Error(`No creator registered for bundle type: ${t.bundleType}`);const i=yield s(t);return this.updateCreationStatistics(t.bundleType,e),this.logger.info("AssetBundleFactory","createBundle","Bundle created successfully",{bundleFactoryId:this.bundleFactoryId,bundleId:i.bundleId,bundleType:i.bundleType,creationTime:Date.now()-e}),i}catch(s){throw this.bundleFactoryStatistics.validationFailures++,this.logger.error("AssetBundleFactory","createBundle","Bundle creation failed",{bundleFactoryId:this.bundleFactoryId,bundleType:t.bundleType,bundleId:t.bundleId,error:s instanceof Error?s.message:String(s)}),s}})}createBundleFromConfig(t){return l(this,null,function*(){const e=Date.now();try{if(this.logger.info("AssetBundleFactory","createBundleFromConfig","Creating bundle from config",{bundleFactoryId:this.bundleFactoryId,bundleType:t.bundleType,bundleId:t.bundleId,bundleName:t.bundleName}),this.bundleFactoryConfig.enableValidation&&!(yield this.validateBundleConfig(t)))throw new Error(`Invalid bundle configuration for ID: ${t.bundleId}`);const s={bundleType:t.bundleType,bundleId:t.bundleId,bundleName:t.bundleName,priority:t.priority,preload:t.preload,cache:t.cache,assets:[],metadata:t.metadata},i=yield this.createBundle(s);return this.logger.info("AssetBundleFactory","createBundleFromConfig","Bundle created from config successfully",{bundleFactoryId:this.bundleFactoryId,bundleId:i.bundleId,creationTime:Date.now()-e}),i}catch(s){throw this.logger.error("AssetBundleFactory","createBundleFromConfig","Bundle creation from config failed",{bundleFactoryId:this.bundleFactoryId,bundleId:t.bundleId,error:s instanceof Error?s.message:String(s)}),s}})}cloneBundle(t,e){return l(this,null,function*(){const s=Date.now();try{this.logger.info("AssetBundleFactory","cloneBundle","Cloning bundle",{bundleFactoryId:this.bundleFactoryId,originalBundleId:t.bundleId,newId:e});const i=t.cloneBundle();return this.bundleFactoryStatistics.totalCloned++,this.bundleFactoryStatistics.lastCreationTime=Date.now(),this.logger.info("AssetBundleFactory","cloneBundle","Bundle cloned successfully",{bundleFactoryId:this.bundleFactoryId,originalBundleId:t.bundleId,clonedBundleId:i.bundleId,cloneTime:Date.now()-s}),i}catch(i){throw this.logger.error("AssetBundleFactory","cloneBundle","Bundle cloning failed",{bundleFactoryId:this.bundleFactoryId,originalBundleId:t.bundleId,error:i instanceof Error?i.message:String(i)}),i}})}configureBundle(t,e){return l(this,null,function*(){try{this.logger.info("AssetBundleFactory","configureBundle","Configuring bundle",{bundleFactoryId:this.bundleFactoryId,bundleId:t.bundleId,configKeys:Object.keys(e)});const s=t.getBundleConfig(),i=m(m({},s),e);if(this.bundleFactoryConfig.enableValidation&&!(yield this.validateBundleConfig(i)))throw new Error(`Invalid bundle configuration for ID: ${t.bundleId}`);return t.setBundleConfig(i),this.bundleFactoryStatistics.totalConfigured++,this.logger.info("AssetBundleFactory","configureBundle","Bundle configured successfully",{bundleFactoryId:this.bundleFactoryId,bundleId:t.bundleId}),t}catch(s){throw this.logger.error("AssetBundleFactory","configureBundle","Bundle configuration failed",{bundleFactoryId:this.bundleFactoryId,bundleId:t.bundleId,error:s instanceof Error?s.message:String(s)}),s}})}validateBundleConfig(t){return l(this,null,function*(){try{return this.logger.debug("AssetBundleFactory","validateBundleConfig","Validating bundle config",{bundleFactoryId:this.bundleFactoryId,bundleId:t.bundleId,bundleType:t.bundleType}),!t.bundleId||typeof t.bundleId!="string"?(this.logger.warn("AssetBundleFactory","validateBundleConfig","Invalid bundle ID",{bundleFactoryId:this.bundleFactoryId,bundleId:t.bundleId}),this.bundleFactoryStatistics.validationFailures++,!1):!t.bundleName||typeof t.bundleName!="string"?(this.logger.warn("AssetBundleFactory","validateBundleConfig","Invalid bundle name",{bundleFactoryId:this.bundleFactoryId,bundleName:t.bundleName}),this.bundleFactoryStatistics.validationFailures++,!1):Object.values(L).includes(t.bundleType)?Object.values(y).includes(t.priority)?typeof t.preload!="boolean"?(this.logger.warn("AssetBundleFactory","validateBundleConfig","Invalid preload value",{bundleFactoryId:this.bundleFactoryId,preload:t.preload}),this.bundleFactoryStatistics.validationFailures++,!1):typeof t.cache!="boolean"?(this.logger.warn("AssetBundleFactory","validateBundleConfig","Invalid cache value",{bundleFactoryId:this.bundleFactoryId,cache:t.cache}),this.bundleFactoryStatistics.validationFailures++,!1):(this.bundleFactoryStatistics.totalValidated++,this.logger.debug("AssetBundleFactory","validateBundleConfig","Bundle config validation passed",{bundleFactoryId:this.bundleFactoryId,bundleId:t.bundleId}),!0):(this.logger.warn("AssetBundleFactory","validateBundleConfig","Invalid bundle priority",{bundleFactoryId:this.bundleFactoryId,priority:t.priority}),this.bundleFactoryStatistics.validationFailures++,!1):(this.logger.warn("AssetBundleFactory","validateBundleConfig","Invalid bundle type",{bundleFactoryId:this.bundleFactoryId,bundleType:t.bundleType}),this.bundleFactoryStatistics.validationFailures++,!1)}catch(e){return this.bundleFactoryStatistics.validationFailures++,this.logger.error("AssetBundleFactory","validateBundleConfig","Bundle config validation failed",{bundleFactoryId:this.bundleFactoryId,bundleId:t.bundleId,error:e instanceof Error?e.message:String(e)}),!1}})}registerBundleTypeCreator(t,e){return this.bundleTypeCreators.set(t,e),this.logger.debug("AssetBundleFactory","registerBundleTypeCreator","Bundle type creator registered",{bundleFactoryId:this.bundleFactoryId,bundleType:t}),this}unregisterBundleTypeCreator(t){return this.bundleTypeCreators.delete(t)?this.logger.debug("AssetBundleFactory","unregisterBundleTypeCreator","Bundle type creator unregistered",{bundleFactoryId:this.bundleFactoryId,bundleType:t}):this.logger.warn("AssetBundleFactory","unregisterBundleTypeCreator","Bundle type creator not found",{bundleFactoryId:this.bundleFactoryId,bundleType:t}),this}isBundleTypeSupported(t){return this.bundleTypeCreators.has(t)}getSupportedBundleTypes(){return Array.from(this.bundleTypeCreators.keys())}getBundleTypeCreator(t){return this.bundleTypeCreators.get(t)||null}createBundles(t){return l(this,null,function*(){this.logger.info("AssetBundleFactory","createBundles","Creating multiple bundles",{bundleFactoryId:this.bundleFactoryId,count:t.length});const e=t.map(r=>this.createBundle(r)),s=yield Promise.allSettled(e),i=[],a=s.filter(r=>r.status==="rejected").length;for(const r of s)r.status==="fulfilled"&&i.push(r.value);return this.logger.info("AssetBundleFactory","createBundles","Multiple bundles creation completed",{bundleFactoryId:this.bundleFactoryId,total:t.length,successful:i.length,failed:a}),i})}createBundlesFromConfigs(t){return l(this,null,function*(){this.logger.info("AssetBundleFactory","createBundlesFromConfigs","Creating multiple bundles from configs",{bundleFactoryId:this.bundleFactoryId,count:t.length});const e=t.map(r=>this.createBundleFromConfig(r)),s=yield Promise.allSettled(e),i=[],a=s.filter(r=>r.status==="rejected").length;for(const r of s)r.status==="fulfilled"&&i.push(r.value);return this.logger.info("AssetBundleFactory","createBundlesFromConfigs","Multiple bundles creation from configs completed",{bundleFactoryId:this.bundleFactoryId,total:t.length,successful:i.length,failed:a}),i})}createBundleFromAssets(t,e,s,i){return l(this,null,function*(){const a=Date.now();try{this.logger.info("AssetBundleFactory","createBundleFromAssets","Creating bundle from assets",{bundleFactoryId:this.bundleFactoryId,bundleType:e,bundleId:s,bundleName:i,assetCount:t.length});const r={bundleType:e,bundleId:s,bundleName:i,priority:this.bundleFactoryConfig.defaultPriority,preload:this.bundleFactoryConfig.defaultPreload,cache:this.bundleFactoryConfig.defaultCache,assets:t,metadata:{}},o=yield this.createBundle(r);for(const c of t)o.addAsset(c);return this.logger.info("AssetBundleFactory","createBundleFromAssets","Bundle created from assets successfully",{bundleFactoryId:this.bundleFactoryId,bundleId:o.bundleId,assetCount:t.length,creationTime:Date.now()-a}),o}catch(r){throw this.logger.error("AssetBundleFactory","createBundleFromAssets","Bundle creation from assets failed",{bundleFactoryId:this.bundleFactoryId,bundleId:s,assetCount:t.length,error:r instanceof Error?r.message:String(r)}),r}})}getCreationStatistics(){const t=this.bundleFactoryStatistics.totalCreated,e=t+this.bundleFactoryStatistics.validationFailures,s=e>0?t/e*100:100,i=this.creationTimes.length>0?this.creationTimes.reduce((r,o)=>r+o,0)/this.creationTimes.length:0,a=this.getMostCreatedBundleType();return{totalCreated:t,successRate:s,averageCreationTime:i,mostCreatedType:a}}clearBundleFactory(){return this.logger.info("AssetBundleFactory","clearBundleFactory","Clearing bundle factory",{bundleFactoryId:this.bundleFactoryId}),this.bundleFactoryStatistics={totalCreated:0,createdByType:{},totalCloned:0,totalConfigured:0,totalValidated:0,validationFailures:0,lastCreationTime:0},this.creationTimes.length=0,this.bundleFactoryMetadata={},this.logger.info("AssetBundleFactory","clearBundleFactory","Bundle factory cleared",{bundleFactoryId:this.bundleFactoryId}),this}updateBundleFactory(t){this.logger.debug("AssetBundleFactory","updateBundleFactory","Bundle factory updated",{bundleFactoryId:this.bundleFactoryId,deltaTime:t})}initializeDefaultBundleTypeCreators(){const t=Object.values(L);for(const e of t)this.registerBundleTypeCreator(e,this.createDefaultBundle.bind(this));this.logger.debug("AssetBundleFactory","initializeDefaultBundleTypeCreators","Default bundle type creators initialized",{bundleFactoryId:this.bundleFactoryId,supportedTypes:t.length})}createDefaultBundle(t){return l(this,null,function*(){const e={bundleId:t.bundleId,bundleName:t.bundleName,bundleType:t.bundleType,priority:t.priority||this.bundleFactoryConfig.defaultPriority,preload:t.preload!==void 0?t.preload:this.bundleFactoryConfig.defaultPreload,cache:t.cache!==void 0?t.cache:this.bundleFactoryConfig.defaultCache,metadata:t.metadata||{}};return new pe(t.bundleId,t.bundleType,e)})}updateCreationStatistics(t,e){const s=Date.now()-e;this.bundleFactoryStatistics.totalCreated++,this.bundleFactoryStatistics.createdByType[t]=(this.bundleFactoryStatistics.createdByType[t]||0)+1,this.bundleFactoryStatistics.lastCreationTime=Date.now(),this.creationTimes.push(s),this.creationTimes.length>100&&this.creationTimes.shift()}getMostCreatedBundleType(){let t=L.SCENE,e=0;for(const[s,i]of Object.entries(this.bundleFactoryStatistics.createdByType))i>e&&(e=i,t=s);return t}}class Qe{constructor(t,e){d(this,"logger",A.getInstance());d(this,"managerId");d(this,"managerConfig");d(this,"assetFactory");d(this,"bundleFactory");d(this,"cacheManager");d(this,"poolManager");d(this,"validationManager");d(this,"statisticsManager");d(this,"managerMetadata",{});d(this,"managedAssets",new Map);d(this,"assetBundles",new Map);this.managerId=t,this.managerConfig=m({enableCaching:!0,enablePooling:!0,enableValidation:!0,enableStatistics:!0,maxCacheSize:100*1024*1024,maxPoolSize:50,defaultTimeout:3e4,retryAttempts:3,retryDelay:1e3,metadata:{}},e),this.initializeSubManagers(),this.logger.info("AssetManager","constructor","Asset manager created",{managerId:this.managerId,managerConfig:this.managerConfig})}initializeSubManagers(){this.assetFactory=new _e("default-asset-factory"),this.bundleFactory=new qe("default-bundle-factory"),this.cacheManager={cacheId:"default-cache-manager",cacheConfig:{maxSize:this.managerConfig.maxCacheSize},cacheMetadata:{},getCacheSize:()=>0,getCacheHitRate:()=>0,clearCache:()=>{},isCached:()=>!1,getCachedAsset:()=>{},cacheAsset:()=>{},removeCachedAsset:()=>{}},this.poolManager={poolId:"default-pool-manager",poolConfig:{maxSize:this.managerConfig.maxPoolSize},poolMetadata:{},getPoolSize:()=>0,getPooledAsset:()=>{},poolAsset:()=>{},removePooledAsset:()=>{},clearPool:()=>{}},this.validationManager={validationId:"default-validation-manager",validationConfig:{strictMode:!0},validationMetadata:{},validateAssetConfig:t=>!!(t&&t.key&&t.path&&t.type),validateBundleConfig:t=>!!(t&&t.bundleId&&t.bundleType&&Array.isArray(t.assetKeys)),validateAsset:()=>!0,validateBundle:()=>!0,getValidationErrors:()=>[],clearValidationErrors:()=>{}},this.statisticsManager={statisticsId:"default-statistics-manager",statisticsConfig:{enableTracking:!0},statisticsMetadata:{},getStatistics:()=>({totalAssets:0,loadedAssets:0,failedAssets:0,totalBundles:0,loadedBundles:0,failedBundles:0,totalLoadTime:0,averageLoadTime:0,cacheHitRate:0,successRate:0}),updateStatistics:()=>{},resetStatistics:()=>{}}}setManagerConfig(t){return this.managerConfig=m(m({},this.managerConfig),t),this.logger.debug("AssetManager","setManagerConfig","Manager configuration updated",{managerId:this.managerId,config:this.managerConfig}),this}setAssetFactory(t){return this.assetFactory=t,this.logger.debug("AssetManager","setAssetFactory","Asset factory set",{managerId:this.managerId,factoryId:t.factoryId}),this}setBundleFactory(t){return this.bundleFactory=t,this.logger.debug("AssetManager","setBundleFactory","Bundle factory set",{managerId:this.managerId,bundleFactoryId:t.bundleFactoryId}),this}setCacheManager(t){return this.cacheManager=t,this.logger.debug("AssetManager","setCacheManager","Cache manager set",{managerId:this.managerId,cacheManagerId:t.cacheManagerId}),this}setPoolManager(t){return this.poolManager=t,this.logger.debug("AssetManager","setPoolManager","Pool manager set",{managerId:this.managerId,poolManagerId:t.poolManagerId}),this}setValidationManager(t){return this.validationManager=t,this.logger.debug("AssetManager","setValidationManager","Validation manager set",{managerId:this.managerId,validationManagerId:t.validationManagerId}),this}setStatisticsManager(t){return this.statisticsManager=t,this.logger.debug("AssetManager","setStatisticsManager","Statistics manager set",{managerId:this.managerId,statisticsManagerId:t.statisticsManagerId}),this}setManagerMetadata(t){return this.managerMetadata=m(m({},this.managerMetadata),t),this.logger.debug("AssetManager","setManagerMetadata","Manager metadata updated",{managerId:this.managerId,metadata:this.managerMetadata}),this}getManagerConfig(){return m({},this.managerConfig)}getAssetFactory(){return this.assetFactory}getBundleFactory(){return this.bundleFactory}getCacheManager(){return this.cacheManager}getPoolManager(){return this.poolManager}getValidationManager(){return this.validationManager}getStatisticsManager(){return this.statisticsManager}getManagerMetadata(){return m({},this.managerMetadata)}loadAsset(t,e){return l(this,null,function*(){try{const s=this.managedAssets.get(t);return s?(s.isAssetLoaded()||(yield s.loadAsset(),s.isAssetLoaded()?this.logger.info("AssetManager","loadAsset","Asset loaded successfully",{managerId:this.managerId,assetKey:t,assetType:s.assetType,assetSize:s.assetSize}):this.logger.error("AssetManager","loadAsset","Asset loading failed",{managerId:this.managerId,assetKey:t,assetType:s.assetType})),s):(this.logger.warn("AssetManager","loadAsset","Asset not found",{managerId:this.managerId,assetKey:t}),null)}catch(s){return this.logger.error("AssetManager","loadAsset","Asset loading error",{managerId:this.managerId,assetKey:t,error:s instanceof Error?s.message:String(s)}),null}})}loadAssetsByType(t,e){return l(this,null,function*(){const s=Array.from(this.managedAssets.values()).filter(a=>a.assetType===t),i=[];for(const a of s){const r=yield this.loadAsset(a.assetKey,e);r&&i.push(r)}return i})}loadAssetsByPriority(t,e){return l(this,null,function*(){const s=Array.from(this.managedAssets.values()).filter(a=>a.assetConfig.priority===t),i=[];for(const a of s){const r=yield this.loadAsset(a.assetKey,e);r&&i.push(r)}return i})}loadBundle(t,e){return l(this,null,function*(){try{const s=this.assetBundles.get(t);return s?(s.isBundleLoaded()||(yield s.loadBundle(),s.isBundleLoaded()?this.logger.info("AssetManager","loadBundle","Bundle loaded successfully",{managerId:this.managerId,bundleId:t,bundleType:s.bundleType}):this.logger.error("AssetManager","loadBundle","Bundle loading failed",{managerId:this.managerId,bundleId:t,bundleType:s.bundleType})),s):(this.logger.warn("AssetManager","loadBundle","Bundle not found",{managerId:this.managerId,bundleId:t}),null)}catch(s){return this.logger.error("AssetManager","loadBundle","Bundle loading error",{managerId:this.managerId,bundleId:t,error:s instanceof Error?s.message:String(s)}),null}})}loadBundlesByType(t,e){return l(this,null,function*(){const s=Array.from(this.assetBundles.values()).filter(a=>a.bundleType===t),i=[];for(const a of s){const r=yield this.loadBundle(a.bundleId,e);r&&i.push(r)}return i})}unloadAsset(t){return l(this,null,function*(){try{const e=this.managedAssets.get(t);return e?(yield e.unloadAsset(),e.assetState===w.PENDING?(this.logger.info("AssetManager","unloadAsset","Asset unloaded successfully",{managerId:this.managerId,assetKey:t}),!0):!1):!1}catch(e){return this.logger.error("AssetManager","unloadAsset","Asset unloading error",{managerId:this.managerId,assetKey:t,error:e instanceof Error?e.message:String(e)}),!1}})}unloadBundle(t){return l(this,null,function*(){try{const e=this.assetBundles.get(t);return e?(yield e.unloadBundle(),e.bundleState===T.PENDING?(this.logger.info("AssetManager","unloadBundle","Bundle unloaded successfully",{managerId:this.managerId,bundleId:t}),!0):!1):!1}catch(e){return this.logger.error("AssetManager","unloadBundle","Bundle unloading error",{managerId:this.managerId,bundleId:t,error:e instanceof Error?e.message:String(e)}),!1}})}getAsset(t){return this.managedAssets.get(t)||null}registerAsset(t){return this.managedAssets.set(t.assetKey,t),this.logger.debug("AssetManager","registerAsset","Asset registered",{managerId:this.managerId,assetKey:t.assetKey,assetType:t.assetType}),this}unregisterAsset(t){return this.managedAssets.delete(t)&&this.logger.debug("AssetManager","unregisterAsset","Asset unregistered",{managerId:this.managerId,assetKey:t}),this}getBundle(t){return this.assetBundles.get(t)||null}getAllAssets(){return Array.from(this.managedAssets.values())}getAllBundles(){return Array.from(this.assetBundles.values())}getAssetsByType(t){return Array.from(this.managedAssets.values()).filter(e=>e.assetType===t)}getAssetsByPriority(t){return Array.from(this.managedAssets.values()).filter(e=>e.assetConfig.priority===t)}getBundlesByType(t){return Array.from(this.assetBundles.values()).filter(e=>e.bundleType===t)}isAssetLoaded(t){const e=this.managedAssets.get(t);return e?e.assetState===w.LOADED:!1}isBundleLoaded(t){const e=this.assetBundles.get(t);return e?e.bundleState===T.LOADED:!1}isAssetCached(t){const e=this.managedAssets.get(t);return e?e.assetState===w.CACHED:!1}isBundleCached(t){const e=this.assetBundles.get(t);return e?e.bundleState===T.LOADED:!1}validateAsset(t){if(!this.managerConfig.enableValidation||!this.validationManager)return!0;try{return this.validationManager.validateAsset(t),!0}catch(e){return this.logger.error("AssetManager","validateAsset","Asset validation error",{managerId:this.managerId,assetKey:t.assetKey,error:e instanceof Error?e.message:String(e)}),!1}}validateBundle(t){if(!this.managerConfig.enableValidation||!this.validationManager)return!0;try{return this.validationManager.validateBundle(t),!0}catch(e){return this.logger.error("AssetManager","validateBundle","Bundle validation error",{managerId:this.managerId,bundleId:t.bundleId,error:e instanceof Error?e.message:String(e)}),!1}}validateAssetConfig(t){if(!this.managerConfig.enableValidation)return!0;try{return!!(t&&t.key&&t.path&&t.type)}catch(e){return this.logger.error("AssetManager","validateAssetConfig","Asset config validation error",{managerId:this.managerId,assetConfig:t,error:e instanceof Error?e.message:String(e)}),!1}}validateBundleConfig(t){if(!this.managerConfig.enableValidation)return!0;try{return!!(t&&t.bundleId&&t.bundleType&&Array.isArray(t.assetKeys))}catch(e){return this.logger.error("AssetManager","validateBundleConfig","Bundle config validation error",{managerId:this.managerId,bundleConfig:t,error:e instanceof Error?e.message:String(e)}),!1}}getManagerStatistics(){const t=this.managedAssets.size,e=Array.from(this.managedAssets.values()).filter(C=>C.assetState===w.LOADED).length,s=Array.from(this.managedAssets.values()).filter(C=>C.assetState===w.FAILED).length,i=Array.from(this.managedAssets.values()).filter(C=>C.assetState===w.CACHED).length,a=this.assetBundles.size,r=Array.from(this.assetBundles.values()).filter(C=>C.bundleState===T.LOADED).length,o=Array.from(this.assetBundles.values()).filter(C=>C.bundleState===T.FAILED).length,c=Array.from(this.assetBundles.values()).filter(C=>C.bundleState===T.LOADED).length,f=Array.from(this.managedAssets.values()).reduce((C,k)=>C+k.assetLoadTime,0),g=t>0?f/t:0,u=t>0?e/t*100:0,p=t>0?i/t*100:0;return{totalAssets:t,loadedAssets:e,failedAssets:s,cachedAssets:i,totalBundles:a,loadedBundles:r,failedBundles:o,cachedBundles:c,totalLoadTime:f,averageLoadTime:g,cacheHitRate:p,successRate:u,lastUpdateTime:Date.now()}}clearManager(){try{this.managedAssets.clear(),this.assetBundles.clear(),this.logger.info("AssetManager","clearManager","Manager cleared",{managerId:this.managerId})}catch(t){this.logger.error("AssetManager","clearManager","Clear manager error",{managerId:this.managerId,error:t instanceof Error?t.message:String(t)})}return this}updateManager(t){try{this.managerConfig.enableStatistics&&this.statisticsManager&&this.statisticsManager.updateStatisticsManager(t)}catch(e){this.logger.error("AssetManager","updateManager","Manager update error",{managerId:this.managerId,error:e instanceof Error?e.message:String(e)})}}}var F=(n=>(n.INITIALIZATION="initialization",n.ASSET_LOADING="asset_loading",n.BUNDLE_LOADING="bundle_loading",n.VALIDATION="validation",n.OPTIMIZATION="optimization",n.COMPLETION="completion",n))(F||{}),E=(n=>(n.PENDING="pending",n.LOADING="loading",n.VALIDATING="validating",n.COMPLETED="completed",n.FAILED="failed",n.CANCELLED="cancelled",n))(E||{}),ke=(n=>(n.SEQUENTIAL="sequential",n.PARALLEL="parallel",n.PRIORITY_BASED="priority_based",n.LAZY="lazy",n.CUSTOM="custom",n))(ke||{}),z=(n=>(n.ASSETS="assets",n.BUNDLES="bundles",n.VALIDATION="validation",n.COMPLETE="complete",n))(z||{});class Ye{constructor(t,e,s,i,a){d(this,"logger",A.getInstance());d(this,"loaderId");d(this,"sceneId");d(this,"loadingState",E.PENDING);d(this,"currentPhase",F.INITIALIZATION);d(this,"loadingConfig");d(this,"assetManager");d(this,"sceneAssetConfig");d(this,"loadingProgress");d(this,"validationResult");d(this,"loaderMetadata",{});d(this,"loadingStartTime",0);d(this,"loadingEndTime",0);d(this,"loadingErrors",[]);d(this,"loadedAssets",new Map);d(this,"loadedBundles",new Map);d(this,"failedAssets",new Set);d(this,"failedBundles",new Set);this.loaderId=t,this.sceneId=e,this.assetManager=s,this.sceneAssetConfig=i,this.loadingConfig=m({enablePreloading:!0,enableValidation:!0,enableOptimization:!0,maxConcurrentLoads:5,timeout:3e4,retryAttempts:3,retryDelay:1e3,metadata:{}},a),this.loadingProgress={totalAssets:0,loadedAssets:0,failedAssets:0,totalBundles:0,loadedBundles:0,failedBundles:0,percentage:0,estimatedTimeRemaining:0,currentPhase:z.ASSETS},this.validationResult={isValid:!1,errors:[],warnings:[],missingAssets:[],missingBundles:[],invalidAssets:[],invalidBundles:[]},this.updateProgress(),this.logger.info("SceneAssetConfigLoader","constructor","Scene asset config loader created",{loaderId:this.loaderId,sceneId:this.sceneId,loadingConfig:this.loadingConfig})}setLoadingState(t){const e=this.loadingState;return this.loadingState=t,this.logger.debug("SceneAssetConfigLoader","setLoadingState",`Loading state changed: ${e} â†’ ${t}`,{loaderId:this.loaderId,sceneId:this.sceneId}),this}setCurrentPhase(t){const e=this.currentPhase;return this.currentPhase=t,this.logger.debug("SceneAssetConfigLoader","setCurrentPhase",`Loading phase changed: ${e} â†’ ${t}`,{loaderId:this.loaderId,sceneId:this.sceneId}),this}setLoadingConfig(t){return this.loadingConfig=t,this.logger.debug("SceneAssetConfigLoader","setLoadingConfig","Loading configuration updated",{loaderId:this.loaderId,sceneId:this.sceneId,config:t}),this}setAssetManager(t){return this.assetManager=t,this.logger.debug("SceneAssetConfigLoader","setAssetManager","Asset manager updated",{loaderId:this.loaderId,sceneId:this.sceneId,managerId:t.managerId}),this}setSceneAssetConfig(t){return this.sceneAssetConfig=t,this.logger.debug("SceneAssetConfigLoader","setSceneAssetConfig","Scene asset configuration updated",{loaderId:this.loaderId,sceneId:this.sceneId,configSceneId:t.sceneId}),this}setLoadingProgress(t){return this.loadingProgress=t,this.logger.debug("SceneAssetConfigLoader","setLoadingProgress","Loading progress updated",{loaderId:this.loaderId,sceneId:this.sceneId,progress:t}),this}setValidationResult(t){return this.validationResult=t,this.logger.debug("SceneAssetConfigLoader","setValidationResult","Validation result updated",{loaderId:this.loaderId,sceneId:this.sceneId,isValid:t.isValid,errorCount:t.errors.length,warningCount:t.warnings.length}),this}setLoaderMetadata(t){return this.loaderMetadata=t,this.logger.debug("SceneAssetConfigLoader","setLoaderMetadata","Loader metadata updated",{loaderId:this.loaderId,sceneId:this.sceneId,metadata:t}),this}getLoadingState(){return this.loadingState}getCurrentPhase(){return this.currentPhase}getLoadingConfig(){return this.loadingConfig}getAssetManager(){return this.assetManager}getSceneAssetConfig(){return this.sceneAssetConfig}getLoaderId(){return this.loaderId}getSceneId(){return this.sceneId}getResponsiveAssets(t){var r,o;const e=this.sceneAssetConfig,s=(o=(r=e.responsive)==null?void 0:r.breakpoints)==null?void 0:o[t];if(!s)return{assets:[],bundles:[]};const i=s.assets.map(c=>e.assets.find(f=>f.key===c)).filter(Boolean),a=s.bundles.map(c=>e.bundles.find(f=>f.bundleId===c)).filter(Boolean);return{assets:i,bundles:a}}validateConfiguration(){const t=this.sceneAssetConfig,e={isValid:!0,errors:[],warnings:[],invalidAssets:[],invalidBundles:[]};return t.sceneId||(e.errors.push("Scene ID is required"),e.isValid=!1),(!t.assets||t.assets.length===0)&&e.warnings.push("No assets configured"),(!t.bundles||t.bundles.length===0)&&e.warnings.push("No bundles configured"),e}getLoadingProgress(){return this.loadingProgress}getValidationResult(){return this.validationResult}getLoaderMetadata(){return this.loaderMetadata}loadSceneAssets(){return l(this,null,function*(){this.logger.info("SceneAssetConfigLoader","loadSceneAssets","Starting scene asset loading",{loaderId:this.loaderId,sceneId:this.sceneId});try{return this.loadingStartTime=Date.now(),this.setLoadingState(E.LOADING),this.setCurrentPhase(F.INITIALIZATION),this.updateProgress(),this.loadingConfig.enablePreloading&&(yield this.loadRequiredAssets()),yield this.loadOptionalAssets(),this.loadingConfig.enableValidation&&(this.setCurrentPhase(F.VALIDATION),yield this.validateSceneAssets()),this.loadingConfig.enableOptimization&&(this.setCurrentPhase(F.OPTIMIZATION),yield this.optimizeSceneAssets()),this.setCurrentPhase(F.COMPLETION),this.loadingEndTime=Date.now(),this.setLoadingState(E.COMPLETED),this.logger.info("SceneAssetConfigLoader","loadSceneAssets","Scene asset loading completed successfully",{loaderId:this.loaderId,sceneId:this.sceneId,loadTime:this.loadingEndTime-this.loadingStartTime,loadedAssets:this.loadedAssets.size,loadedBundles:this.loadedBundles.size}),!0}catch(t){return this.loadingEndTime=Date.now(),this.setLoadingState(E.FAILED),this.loadingErrors.push(t instanceof Error?t.message:String(t)),this.logger.error("SceneAssetConfigLoader","loadSceneAssets","Scene asset loading failed",{loaderId:this.loaderId,sceneId:this.sceneId,error:t instanceof Error?t.message:String(t),loadTime:this.loadingEndTime-this.loadingStartTime}),!1}})}loadSceneAssetsForBreakpoint(t){return l(this,null,function*(){this.logger.info("SceneAssetConfigLoader","loadSceneAssetsForBreakpoint","Loading scene assets for breakpoint",{loaderId:this.loaderId,sceneId:this.sceneId,breakpoint:t});try{const e=this.getResponsiveAssets(t);for(const s of e.assets)yield this.loadAsset(s.assetKey);for(const s of e.bundles)yield this.loadBundle(s.bundleId);return this.logger.info("SceneAssetConfigLoader","loadSceneAssetsForBreakpoint","Breakpoint assets loaded successfully",{loaderId:this.loaderId,sceneId:this.sceneId,breakpoint:t,assetCount:e.assets.length,bundleCount:e.bundles.length}),!0}catch(e){return this.logger.error("SceneAssetConfigLoader","loadSceneAssetsForBreakpoint","Breakpoint asset loading failed",{loaderId:this.loaderId,sceneId:this.sceneId,breakpoint:t,error:e instanceof Error?e.message:String(e)}),!1}})}loadRequiredAssets(){return l(this,null,function*(){this.logger.info("SceneAssetConfigLoader","loadRequiredAssets","Loading required assets",{loaderId:this.loaderId,sceneId:this.sceneId});try{const e=this.sceneAssetConfig.validation.required;for(const s of e)(yield this.loadAsset(s))||(this.failedAssets.add(s),this.logger.warn("SceneAssetConfigLoader","loadRequiredAssets","Required asset failed to load",{loaderId:this.loaderId,sceneId:this.sceneId,assetKey:s}));return this.logger.info("SceneAssetConfigLoader","loadRequiredAssets","Required assets loading completed",{loaderId:this.loaderId,sceneId:this.sceneId,totalRequired:e.length,loaded:this.loadedAssets.size,failed:this.failedAssets.size}),!0}catch(t){return this.logger.error("SceneAssetConfigLoader","loadRequiredAssets","Required assets loading failed",{loaderId:this.loaderId,sceneId:this.sceneId,error:t instanceof Error?t.message:String(t)}),!1}})}loadOptionalAssets(){return l(this,null,function*(){this.logger.info("SceneAssetConfigLoader","loadOptionalAssets","Loading optional assets",{loaderId:this.loaderId,sceneId:this.sceneId});try{const e=this.sceneAssetConfig.validation.optional;for(const s of e)(yield this.loadAsset(s))||(this.failedAssets.add(s),this.logger.debug("SceneAssetConfigLoader","loadOptionalAssets","Optional asset failed to load",{loaderId:this.loaderId,sceneId:this.sceneId,assetKey:s}));return this.logger.info("SceneAssetConfigLoader","loadOptionalAssets","Optional assets loading completed",{loaderId:this.loaderId,sceneId:this.sceneId,totalOptional:e.length,loaded:this.loadedAssets.size,failed:this.failedAssets.size}),!0}catch(t){return this.logger.error("SceneAssetConfigLoader","loadOptionalAssets","Optional assets loading failed",{loaderId:this.loaderId,sceneId:this.sceneId,error:t instanceof Error?t.message:String(t)}),!1}})}loadAsset(t){return l(this,null,function*(){this.logger.debug("SceneAssetConfigLoader","loadAsset","Loading asset",{loaderId:this.loaderId,sceneId:this.sceneId,assetKey:t});try{const e=yield this.assetManager.loadAsset(t);return e?(this.loadedAssets.set(t,e),this.updateProgress()):this.failedAssets.add(t),e}catch(e){return this.failedAssets.add(t),this.logger.error("SceneAssetConfigLoader","loadAsset","Asset loading failed",{loaderId:this.loaderId,sceneId:this.sceneId,assetKey:t,error:e instanceof Error?e.message:String(e)}),null}})}loadAssetsByType(t){return l(this,null,function*(){this.logger.debug("SceneAssetConfigLoader","loadAssetsByType","Loading assets by type",{loaderId:this.loaderId,sceneId:this.sceneId,assetType:t});try{const e=this.assetManager.getAssetsByType(t),s=[];for(const i of e){const a=yield this.assetManager.loadAsset(i.assetKey);a&&s.push(a)}for(const i of s)this.loadedAssets.set(i.assetKey,i);return this.updateProgress(),s}catch(e){return this.logger.error("SceneAssetConfigLoader","loadAssetsByType","Assets by type loading failed",{loaderId:this.loaderId,sceneId:this.sceneId,assetType:t,error:e instanceof Error?e.message:String(e)}),[]}})}loadAssetsByPriority(t){return l(this,null,function*(){this.logger.debug("SceneAssetConfigLoader","loadAssetsByPriority","Loading assets by priority",{loaderId:this.loaderId,sceneId:this.sceneId,priority:t});try{const e=this.assetManager.getAssetsByPriority(t),s=[];for(const i of e){const a=yield this.assetManager.loadAsset(i.assetKey);a&&s.push(a)}for(const i of s)this.loadedAssets.set(i.assetKey,i);return this.updateProgress(),s}catch(e){return this.logger.error("SceneAssetConfigLoader","loadAssetsByPriority","Assets by priority loading failed",{loaderId:this.loaderId,sceneId:this.sceneId,priority:t,error:e instanceof Error?e.message:String(e)}),[]}})}loadBundle(t){return l(this,null,function*(){this.logger.debug("SceneAssetConfigLoader","loadBundle","Loading bundle",{loaderId:this.loaderId,sceneId:this.sceneId,bundleId:t});try{const e=yield this.assetManager.loadBundle(t);return e?(this.loadedBundles.set(t,e),this.updateProgress()):this.failedBundles.add(t),e}catch(e){return this.failedBundles.add(t),this.logger.error("SceneAssetConfigLoader","loadBundle","Bundle loading failed",{loaderId:this.loaderId,sceneId:this.sceneId,bundleId:t,error:e instanceof Error?e.message:String(e)}),null}})}loadBundlesByType(t){return l(this,null,function*(){this.logger.debug("SceneAssetConfigLoader","loadBundlesByType","Loading bundles by type",{loaderId:this.loaderId,sceneId:this.sceneId,bundleType:t});try{const e=this.assetManager.getBundlesByType(t),s=[];for(const i of e){const a=yield this.assetManager.loadBundle(i.bundleId);a&&s.push(a)}for(const i of s)this.loadedBundles.set(i.bundleId,i);return this.updateProgress(),s}catch(e){return this.logger.error("SceneAssetConfigLoader","loadBundlesByType","Bundles by type loading failed",{loaderId:this.loaderId,sceneId:this.sceneId,bundleType:t,error:e instanceof Error?e.message:String(e)}),[]}})}unloadSceneAssets(){return l(this,null,function*(){this.logger.info("SceneAssetConfigLoader","unloadSceneAssets","Unloading scene assets",{loaderId:this.loaderId,sceneId:this.sceneId});try{for(const t of Array.from(this.loadedAssets.keys()))yield this.unloadAsset(t);for(const t of Array.from(this.loadedBundles.keys()))yield this.unloadBundle(t);return this.loadedAssets.clear(),this.loadedBundles.clear(),this.failedAssets.clear(),this.failedBundles.clear(),this.updateProgress(),this.logger.info("SceneAssetConfigLoader","unloadSceneAssets","Scene assets unloaded successfully",{loaderId:this.loaderId,sceneId:this.sceneId}),!0}catch(t){return this.logger.error("SceneAssetConfigLoader","unloadSceneAssets","Scene assets unloading failed",{loaderId:this.loaderId,sceneId:this.sceneId,error:t instanceof Error?t.message:String(t)}),!1}})}unloadAsset(t){return l(this,null,function*(){this.logger.debug("SceneAssetConfigLoader","unloadAsset","Unloading asset",{loaderId:this.loaderId,sceneId:this.sceneId,assetKey:t});try{const e=yield this.assetManager.unloadAsset(t);return e&&(this.loadedAssets.delete(t),this.failedAssets.delete(t),this.updateProgress()),e}catch(e){return this.logger.error("SceneAssetConfigLoader","unloadAsset","Asset unloading failed",{loaderId:this.loaderId,sceneId:this.sceneId,assetKey:t,error:e instanceof Error?e.message:String(e)}),!1}})}unloadBundle(t){return l(this,null,function*(){this.logger.debug("SceneAssetConfigLoader","unloadBundle","Unloading bundle",{loaderId:this.loaderId,sceneId:this.sceneId,bundleId:t});try{const e=yield this.assetManager.unloadBundle(t);return e&&(this.loadedBundles.delete(t),this.failedBundles.delete(t),this.updateProgress()),e}catch(e){return this.logger.error("SceneAssetConfigLoader","unloadBundle","Bundle unloading failed",{loaderId:this.loaderId,sceneId:this.sceneId,bundleId:t,error:e instanceof Error?e.message:String(e)}),!1}})}validateSceneAssets(){return l(this,null,function*(){this.logger.info("SceneAssetConfigLoader","validateSceneAssets","Validating scene assets",{loaderId:this.loaderId,sceneId:this.sceneId});try{const t=this.validateConfiguration();for(const[s,i]of Array.from(this.loadedAssets.entries()))(yield this.assetManager.validateAsset(i))||t.invalidAssets.push(s);for(const[s,i]of Array.from(this.loadedBundles.entries()))(yield this.assetManager.validateBundle(i))||t.invalidBundles.push(s);const e=this.sceneAssetConfig;for(const s of e.validation.required)this.loadedAssets.has(s)||t.missingAssets.push(s);return t.isValid=t.errors.length===0&&t.missingAssets.length===0&&t.invalidAssets.length===0,this.setValidationResult(t),this.logger.info("SceneAssetConfigLoader","validateSceneAssets","Scene assets validation completed",{loaderId:this.loaderId,sceneId:this.sceneId,isValid:t.isValid,errorCount:t.errors.length,warningCount:t.warnings.length,missingAssets:t.missingAssets.length,invalidAssets:t.invalidAssets.length}),t}catch(t){const e={isValid:!1,errors:[t instanceof Error?t.message:String(t)],warnings:[],missingAssets:[],missingBundles:[],invalidAssets:[],invalidBundles:[]};return this.setValidationResult(e),this.logger.error("SceneAssetConfigLoader","validateSceneAssets","Scene assets validation failed",{loaderId:this.loaderId,sceneId:this.sceneId,error:t instanceof Error?t.message:String(t)}),e}})}optimizeSceneAssets(){return l(this,null,function*(){this.logger.info("SceneAssetConfigLoader","optimizeSceneAssets","Optimizing scene assets",{loaderId:this.loaderId,sceneId:this.sceneId});try{return this.logger.info("SceneAssetConfigLoader","optimizeSceneAssets","Scene assets optimization completed",{loaderId:this.loaderId,sceneId:this.sceneId}),!0}catch(t){return this.logger.error("SceneAssetConfigLoader","optimizeSceneAssets","Scene assets optimization failed",{loaderId:this.loaderId,sceneId:this.sceneId,error:t instanceof Error?t.message:String(t)}),!1}})}cancelLoading(){return l(this,null,function*(){this.logger.info("SceneAssetConfigLoader","cancelLoading","Cancelling loading",{loaderId:this.loaderId,sceneId:this.sceneId});try{return this.setLoadingState(E.CANCELLED),yield this.unloadSceneAssets(),this.logger.info("SceneAssetConfigLoader","cancelLoading","Loading cancelled successfully",{loaderId:this.loaderId,sceneId:this.sceneId}),!0}catch(t){return this.logger.error("SceneAssetConfigLoader","cancelLoading","Loading cancellation failed",{loaderId:this.loaderId,sceneId:this.sceneId,error:t instanceof Error?t.message:String(t)}),!1}})}pauseLoading(){return l(this,null,function*(){return this.logger.info("SceneAssetConfigLoader","pauseLoading","Pausing loading",{loaderId:this.loaderId,sceneId:this.sceneId}),!0})}resumeLoading(){return l(this,null,function*(){return this.logger.info("SceneAssetConfigLoader","resumeLoading","Resuming loading",{loaderId:this.loaderId,sceneId:this.sceneId}),!0})}isLoadingComplete(){return this.loadingState===E.COMPLETED}isLoadingFailed(){return this.loadingState===E.FAILED}isAssetLoaded(t){return this.loadedAssets.has(t)}isBundleLoaded(t){return this.loadedBundles.has(t)}getLoadedAssetsCount(){return this.loadedAssets.size}getLoadedBundlesCount(){return this.loadedBundles.size}getFailedAssetsCount(){return this.failedAssets.size}getFailedBundlesCount(){return this.failedBundles.size}clearLoader(){return this.logger.info("SceneAssetConfigLoader","clearLoader","Clearing loader",{loaderId:this.loaderId,sceneId:this.sceneId}),this.loadedAssets.clear(),this.loadedBundles.clear(),this.failedAssets.clear(),this.failedBundles.clear(),this.loadingErrors=[],this.loadingStartTime=0,this.loadingEndTime=0,this.setLoadingState(E.PENDING),this.setCurrentPhase(F.INITIALIZATION),this.updateProgress(),this}updateLoader(t){if(this.updateProgress(),this.loadingState===E.LOADING&&this.loadingStartTime>0){const e=Date.now()-this.loadingStartTime,s=this.loadingProgress.totalAssets+this.loadingProgress.totalBundles,i=this.loadingProgress.loadedAssets+this.loadingProgress.loadedBundles;if(i>0&&s>i){const a=e/i,r=s-i;this.loadingProgress.estimatedTimeRemaining=a*r}}}mapLoadingPhaseToAssetPhase(t){switch(t){case F.INITIALIZATION:case F.ASSET_LOADING:return z.ASSETS;case F.BUNDLE_LOADING:return z.BUNDLES;case F.VALIDATION:return z.VALIDATION;case F.OPTIMIZATION:case F.COMPLETION:return z.COMPLETE;default:return z.ASSETS}}updateProgress(){const t=this.sceneAssetConfig,e=t.assets.length,s=t.bundles.length,i=this.loadedAssets.size,a=this.loadedBundles.size,r=this.failedAssets.size,o=this.failedBundles.size,c=e+s,f=i+a,g=c>0?f/c*100:0;this.loadingProgress={totalAssets:e,loadedAssets:i,failedAssets:r,totalBundles:s,loadedBundles:a,failedBundles:o,percentage:g,estimatedTimeRemaining:this.loadingProgress.estimatedTimeRemaining,currentPhase:this.mapLoadingPhaseToAssetPhase(this.getCurrentPhase())}}}const W=class W{constructor(){d(this,"loggingLoader");d(this,"responsiveLoader");d(this,"sceneLoader");d(this,"assetManager");d(this,"sceneAssetLoaders",new Map);d(this,"themes",new Map);this.loggingLoader=ce.getInstance(),this.responsiveLoader=ee.getInstance(),this.sceneLoader=le.getInstance(),this.assetManager=new Qe("config-manager-asset-manager")}static getInstance(){return W.instance||(W.instance=new W),W.instance}registerSceneConfigs(t,e,s,i,a,r){try{this.loggingLoader.registerConfig(t,e),this.responsiveLoader.registerConfig(t,s),this.sceneLoader.registerConfig(t,i);const o=new Ye(`${t}-asset-loader`,t,this.assetManager,a);this.sceneAssetLoaders.set(t,o),r&&(this.themes.set(t,r),h.debug("ConfigManager","registerSceneConfigs","Registered theme configuration for scene",{sceneName:t})),h.debug("ConfigManager","registerSceneConfigs","Registered all configurations for scene",{sceneName:t})}catch(o){h.error("ConfigManager","registerSceneConfigs","Failed to register configurations for scene",{sceneName:t,error:o})}}loadSceneConfigs(t){try{const e=this.loggingLoader.loadConfig(t),s=this.responsiveLoader.loadConfig(t),i=this.sceneLoader.loadConfig(t),a=this.sceneAssetLoaders.get(t)||null,r=this.themes.get(t)||null,o={logging:e,responsive:s,scene:i,asset:a,theme:r};return h.debug("ConfigManager","loadSceneConfigs","Loaded configurations for scene",{sceneName:t,result:o}),o}catch(e){return h.error("ConfigManager","loadSceneConfigs","Failed to load configurations for scene",{sceneName:t,error:e}),{logging:!1,responsive:null,scene:null,asset:null,theme:null}}}hasAllConfigs(t){return this.loggingLoader.hasConfig(t)&&this.responsiveLoader.hasConfig(t)&&this.sceneLoader.hasConfig(t)&&this.sceneAssetLoaders.has(t)}getAvailableScenes(){const t=this.loggingLoader.getAvailableConfigs(),e=this.responsiveLoader.getAvailableConfigs(),s=this.sceneLoader.getAvailableConfigs(),i=Array.from(this.sceneAssetLoaders.keys());return t.filter(a=>e.includes(a)&&s.includes(a)&&i.includes(a))}getLoggingLoader(){return this.loggingLoader}getResponsiveLoader(){return this.responsiveLoader}getSceneLoader(){return this.sceneLoader}getAssetManager(){return this.assetManager}getSceneAssetLoader(t){return this.sceneAssetLoaders.get(t)||null}getTheme(t){return this.themes.get(t)||null}getAllThemes(){return new Map(this.themes)}};d(W,"instance");let he=W;const Ze="modulepreload",Je=function(n){return"/"+n},ve={},Se=function(t,e,s){let i=Promise.resolve();if(e&&e.length>0){document.getElementsByTagName("link");const r=document.querySelector("meta[property=csp-nonce]"),o=(r==null?void 0:r.nonce)||(r==null?void 0:r.getAttribute("nonce"));i=Promise.allSettled(e.map(c=>{if(c=Je(c),c in ve)return;ve[c]=!0;const f=c.endsWith(".css"),g=f?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${g}`))return;const u=document.createElement("link");if(u.rel=f?"stylesheet":Ze,f||(u.as="script"),u.crossOrigin="",u.href=c,o&&u.setAttribute("nonce",o),document.head.appendChild(u),f)return new Promise((p,C)=>{u.addEventListener("load",p),u.addEventListener("error",()=>C(new Error(`Unable to preload CSS for ${c}`)))})}))}function a(r){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=r,window.dispatchEvent(o),!o.defaultPrevented)throw r}return i.then(r=>{for(const o of r||[])o.status==="rejected"&&a(o.reason);return t().catch(a)})};class Q{constructor(t){d(this,"supportedTypes");this.supportedTypes=t}canCreate(t){return this.supportedTypes.includes(t)}getSupportedTypes(){return this.supportedTypes}setCommonProperties(t,e){const s=e.config;if("x"in s&&s.x!==void 0&&"setPosition"in t&&t.setPosition(s.x,("y"in s?s.y:0)||0),"width"in s&&s.width&&s.width!=="fill"&&"setSize"in t){const i=("height"in s?s.height:s.width)||s.width;t.setSize(s.width,i)}t.name=("name"in s?s.name:void 0)||s.id,"alpha"in s&&s.alpha!==void 0&&"setAlpha"in t&&t.setAlpha(s.alpha),"visible"in s&&s.visible!==void 0&&"setVisible"in t&&t.setVisible(s.visible)}}class ie extends B.GameObjects.Container{constructor(e,s,i=0,a=0,r=null){super(e,i,a);d(this,"id");d(this,"parent");d(this,"children",[]);d(this,"containerType","div");d(this,"constraints",{maxChildren:1e3,autoSize:!1,clipOverflow:!1,overflow:"visible",respectParentBounds:!0,maintainAspectRatio:!1});d(this,"currentStyle",{maintainAspectRatio:!1,scaleStrategy:"stretch",alignment:"center"});d(this,"layoutProperties",{maintainAspectRatio:!1,scaleStrategy:"stretch",alignment:"center"});d(this,"spacing",{gap:10,padding:{left:0,right:0,top:0,bottom:0}});d(this,"logger",A.getInstance());d(this,"injectedConfigs",null);this.id=s,this.parent=r,this.setupContainer()}get childCount(){return this.children.length}get hasChildren(){return this.children.length>0}get isEmpty(){return this.children.length===0}get isActive(){return this.active}get isDestroyed(){return!this.active}get size(){return{width:this.width,height:this.height}}get interactive(){var e;return((e=this.input)==null?void 0:e.enabled)||!1}setupContainer(){this.setSize(100,100),this.setInteractive()}setStyle(e){this.logger.debug("Container","setStyle","Setting style properties",{id:this.id,newStyle:e});let s=this.applyStyleCascade(e);this.currentStyle=m({},s),this.applyPositionProperties(s),this.applySizeProperties(s),this.applyVisualProperties(s),this.applyBackgroundProperties(s),this.applyAdditionalStyleProperties(s)}getStyle(){return m({},this.currentStyle)}getStyleId(){return this.id}initializeWithConfigs(e){var s,i,a;if(this.logger.debug("Container","getStyleId","Initializing with injected configurations",{id:this.id,hasResponsive:!!e.responsive,hasTheme:!!e.theme,currentBreakpoint:e.currentBreakpoint,responsiveKeys:e.responsive?Object.keys(e.responsive):[],themeKeys:e.theme?Object.keys(e.theme):[]}),this.injectedConfigs=e,e.responsive&&(this.logger.debug("Container","getStyleId","Applying initial responsive configuration",{id:this.id,responsiveConfig:e.responsive,hasDefault:!!e.responsive.default,defaultCount:((s=e.responsive.default)==null?void 0:s.length)||0,hasResponsiveSettings:!!e.responsive.responsiveSettings,responsiveBreakpoints:e.responsive.responsiveSettings?Object.keys(e.responsive.responsiveSettings):[]}),e.responsive.default)){const r=e.responsive.default.find(o=>o.id===this.id);r!=null&&r.layoutProperties?(this.logger.debug("Container","getStyleId","Found default layout for container",{id:this.id,defaultLayout:r,layoutProperties:r.layoutProperties}),this.setStyle(r.layoutProperties)):this.logger.warn("Container","getStyleId","No default layout found for container",{id:this.id,availableLayouts:e.responsive.default.map(o=>o.id)})}if(e.theme&&((i=e.responsive)!=null&&i.default)){const r=e.responsive.default.find(o=>o.id===this.id);(a=r==null?void 0:r.layoutProperties)!=null&&a.classes&&(this.logger.debug("Container","getStyleId","Applying initial theme configuration",{id:this.id,themeName:e.theme.themeName,classes:r.layoutProperties.classes,availableThemeClasses:Object.keys(e.theme.themeClasses||{})}),this.applyThemeClasses(r.layoutProperties.classes,e.theme))}}getInjectedConfigs(){return this.injectedConfigs}applyThemeClasses(e,s){!e||!(s!=null&&s.themeClasses)||(this.logger.debug("Container","applyThemeClasses","Applying theme classes",{id:this.id,classes:e,availableThemeClasses:Object.keys(s.themeClasses)}),e.forEach(i=>{let a=s.themeClasses[i];!a&&!i.startsWith(".")&&(a=s.themeClasses[`.${i}`]),!a&&i.startsWith(".")&&(a=s.themeClasses[i.substring(1)]),a?(this.logger.debug("Container","unknown","Applying theme class",{id:this.id,className:i,themeClass:a,foundWithPrefix:i.startsWith("."),foundWithoutPrefix:!i.startsWith(".")}),this.currentStyle=m(m({},this.currentStyle),a),this.applyStylePropertiesDirectly(a)):this.logger.warn("Container","unknown","Theme class not found",{id:this.id,className:i,availableClasses:Object.keys(s.themeClasses),triedWithDot:i.startsWith(".")?null:`.${i}`,triedWithoutDot:i.startsWith(".")?i.substring(1):null})}))}applyPositionProperties(e){e.position!==void 0&&this.logger.debug("Container","applyPositionProperties","Applying position type",{id:this.id,position:e.position}),e.positionX!==void 0&&(this.x=this.calculatePositionValue(e.positionX,"x"),this.logger.debug("Container","applyPositionProperties","X position calculated",{id:this.id,x:this.x,originalValue:e.positionX})),e.positionY!==void 0&&(this.y=this.calculatePositionValue(e.positionY,"y"),this.logger.debug("Container","applyPositionProperties","Y position calculated",{id:this.id,y:this.y,originalValue:e.positionY})),e.positionZ!==void 0&&this.setDepth(e.positionZ),e.zIndex!==void 0&&(this.setDepth(e.zIndex),this.logger.debug("Container","applyPositionProperties","Applied zIndex",{id:this.id,zIndex:e.zIndex}))}calculatePositionValue(e,s){var i,a,r,o;if(typeof e=="number")return e;if(typeof e=="string")switch(e){case"center":return 0;case"left":return s==="x"?0:this.y;case"right":return s==="x"&&this.parent?(((a=(i=this.parent).getSize)==null?void 0:a.call(i))||{width:800}).width-(this.width||100):s==="x"?0:this.y;case"top":return s==="y"?0:this.x;case"bottom":return s==="y"&&this.parent?(((o=(r=this.parent).getSize)==null?void 0:o.call(r))||{height:600}).height-(this.height||100):s==="y"?0:this.x;default:return this.logger.warn("Container","applyPositionProperties","Unknown position keyword",{id:this.id,axis:s,value:e}),s==="x"?this.x:this.y}if(typeof e=="object"&&"getValue"in e){if(this.parent&&typeof this.parent.getSize=="function")try{return e.getValue(this.parent)}catch(c){this.logger.warn("Container","return","Failed to calculate parent-relative position",{id:this.id,axis:s,error:c instanceof Error?c.message:String(c)})}else this.logger.warn("Container","return","Parent-relative positioning requested but no parent available",{id:this.id,axis:s,value:e});return s==="x"?this.x:this.y}if(typeof e=="object"&&"getRandomValue"in e){try{return e.getRandomValue()}catch(c){this.logger.warn("Container","return","Failed to get random position value",{id:this.id,axis:s,error:c instanceof Error?c.message:String(c)})}return s==="x"?this.x:this.y}return this.logger.warn("Container","return","Unknown position value type",{id:this.id,axis:s,value:e,valueType:typeof e}),s==="x"?this.x:this.y}applySizeProperties(e){e.width!==void 0&&(this.width=this.calculateSizeValue(e.width,"width"),this.logger.debug("Container","applySizeProperties","Width calculated",{id:this.id,width:this.width,originalValue:e.width})),e.height!==void 0&&(this.height=this.calculateSizeValue(e.height,"height"),this.logger.debug("Container","applySizeProperties","Height calculated",{id:this.id,height:this.height,originalValue:e.height})),this.applyMarginProperties(e),this.applyPaddingProperties(e)}calculateSizeValue(e,s){if(typeof e=="number")return e;if(typeof e=="string")switch(e){case"fill":return s==="width"?this.scene.game.config.width:this.scene.game.config.height;case"auto":return s==="width"?200:150;default:return this.logger.warn("Container","applySizeProperties","Unknown size keyword",{id:this.id,dimension:s,value:e}),100}if(typeof e=="object"&&"getValue"in e){if(this.parent&&typeof this.parent.getSize=="function")try{return e.getValue(this.parent)}catch(i){this.logger.warn("Container","return","Failed to calculate parent-relative size",{id:this.id,dimension:s,error:i instanceof Error?i.message:String(i)})}else this.logger.warn("Container","return","Parent-relative sizing requested but no parent available",{id:this.id,dimension:s,value:e});return 100}if(typeof e=="object"&&"getRandomValue"in e){try{return e.getRandomValue()}catch(i){this.logger.warn("Container","return","Failed to get random size value",{id:this.id,dimension:s,error:i instanceof Error?i.message:String(i)})}return 100}return this.logger.warn("Container","return","Unknown size value type",{id:this.id,dimension:s,value:e,valueType:typeof e}),100}applyMarginProperties(e){e.margin!==void 0&&this.logger.debug("Container","applyMarginProperties","Applying uniform margin",{id:this.id,margin:e.margin}),["marginTop","marginRight","marginBottom","marginLeft"].forEach(i=>{e[i]!==void 0&&this.logger.debug("Container","applyMarginProperties","Applying individual margin",{id:this.id,property:i,value:e[i]})})}applyPaddingProperties(e){if(e.padding!==void 0){if(this.logger.debug("Container","applyPaddingProperties","Applying uniform padding",{id:this.id,padding:e.padding}),typeof e.padding=="number")this.spacing.padding={left:e.padding,right:e.padding,top:e.padding,bottom:e.padding};else if(typeof e.padding=="object"&&"getRandomValue"in e.padding){const i=e.padding.getRandomValue();this.spacing.padding={left:i,right:i,top:i,bottom:i}}this.logger.debug("Container","applyPaddingProperties","Padding updated",{id:this.id,newPadding:this.spacing.padding})}["paddingTop","paddingRight","paddingBottom","paddingLeft"].forEach(i=>{var a;if(e[i]!==void 0){const r=typeof e[i]=="number"?e[i]:((a=e[i])==null?void 0:a.getRandomValue())||0;switch(i){case"paddingTop":this.spacing.padding.top=r;break;case"paddingRight":this.spacing.padding.right=r;break;case"paddingBottom":this.spacing.padding.bottom=r;break;case"paddingLeft":this.spacing.padding.left=r;break}this.logger.debug("Container","applyPaddingProperties","Applied individual padding",{id:this.id,property:i,value:r})}})}applyVisualProperties(e){if(e.alpha!==void 0){if(typeof e.alpha=="number")this.setAlpha(e.alpha);else if(typeof e.alpha=="object"&&"min"in e.alpha&&"max"in e.alpha){const s=e.alpha.getRandomValue();this.setAlpha(s)}}if(e.rotation!==void 0){if(typeof e.rotation=="number")this.setRotation(e.rotation);else if(typeof e.rotation=="object"&&"min"in e.rotation&&"max"in e.rotation){const s=e.rotation.getRandomValue();this.setRotation(s)}}e.visible!==void 0&&this.setVisible(e.visible),e.interactive!==void 0&&(e.interactive?this.setInteractive():this.disableInteractive())}applyBackgroundProperties(e){if(e.backgroundColor!==void 0){this.logger.debug("Container","applyBackgroundProperties","Applying background color",{id:this.id,backgroundColor:e.backgroundColor});const s=this.getByName("background-rectangle");if(s&&s.destroy(),typeof e.backgroundColor=="string"){const i=this.width||this.scene.game.config.width,a=this.height||this.scene.game.config.height,r=this.scene.add.rectangle(0,0,i,a,B.Display.Color.ValueToColor(e.backgroundColor).color);r.setName("background-rectangle"),this.addAt(r,0),this.logger.debug("Container","applyBackgroundProperties","Background rectangle created",{id:this.id,backgroundColor:e.backgroundColor,size:{width:r.width,height:r.height}})}}}applyAdditionalStyleProperties(e){this.applyShadowProperties(e),this.applyBorderProperties(e),this.applyTransformProperties(e),this.applyBorderRadius(e),this.applyBoxShadow(e)}applyShadowProperties(e){const s=this.getByName("container-shadow");if(s&&s.destroy(),e.shadowColor!==void 0||e.shadowBlur!==void 0||e.shadowOffsetX!==void 0||e.shadowOffsetY!==void 0||e.shadowAlpha!==void 0){this.logger.debug("Container","applyShadowProperties","Applying shadow properties",{id:this.id,shadowColor:e.shadowColor,shadowBlur:e.shadowBlur,shadowOffsetX:e.shadowOffsetX,shadowOffsetY:e.shadowOffsetY,shadowAlpha:e.shadowAlpha});const i=e.shadowColor||"#000000",a=e.shadowBlur||0,r=e.shadowOffsetX||0,o=e.shadowOffsetY||0,c=e.shadowAlpha!==void 0?e.shadowAlpha:.3,f=this.scene.add.rectangle(r,o,(this.width||this.scene.game.config.width)+a*2,(this.height||this.scene.game.config.height)+a*2,B.Display.Color.ValueToColor(i).color,c);f.setName("container-shadow"),this.addAt(f,0),this.logger.debug("Container","applyShadowProperties","Shadow created",{id:this.id,shadowColor:i,shadowBlur:a,shadowOffset:{x:r,y:o},shadowAlpha:c})}}applyBorderProperties(e){const s=this.getByName("container-border");if(s&&s.destroy(),e.borderColor!==void 0||e.borderWidth!==void 0||e.borderBottomWidth!==void 0){const i=e.borderColor||"#000000",a=e.borderWidth||1,r=e.borderBottomWidth||a;this.logger.debug("Container","applyBorderProperties","Applying border properties",{id:this.id,borderColor:i,borderWidth:a,borderBottomWidth:r});const o=this.scene.add.rectangle(0,0,(this.width||this.scene.game.config.width)+a*2,(this.height||this.scene.game.config.height)+r*2,B.Display.Color.ValueToColor(i).color),c=this.scene.add.rectangle(0,0,this.width||this.scene.game.config.width,this.height||this.scene.game.config.height,0);o.setName("container-border"),this.addAt(o,1),this.addAt(c,2),this.logger.debug("Container","applyBorderProperties","Border created",{id:this.id,borderColor:i,borderWidth:a,borderBottomWidth:r})}}applyTransformProperties(e){var s,i,a;if(e.scale!==void 0){const r=typeof e.scale=="number"?e.scale:((s=e.scale)==null?void 0:s.getRandomValue())||1;this.setScale(r,r),this.logger.debug("Container","applyTransformProperties","Applied overall scale",{id:this.id,scale:r})}if(e.scaleMode!==void 0&&this.logger.debug("Container","applyTransformProperties","Applied scale mode",{id:this.id,scaleMode:e.scaleMode}),e.scaleX!==void 0){const r=typeof e.scaleX=="number"?e.scaleX:((i=e.scaleX)==null?void 0:i.getRandomValue())||1;this.scaleX=r,this.logger.debug("Container","applyTransformProperties","Applied scale X",{id:this.id,scaleX:r})}if(e.scaleY!==void 0){const r=typeof e.scaleY=="number"?e.scaleY:((a=e.scaleY)==null?void 0:a.getRandomValue())||1;this.scaleY=r,this.logger.debug("Container","applyTransformProperties","Applied scale Y",{id:this.id,scaleY:r})}}applyBorderRadius(e){const s=e.borderRadius||e.borderRadiusValue;s!==void 0&&(this.logger.debug("Container","applyBorderRadius","Applying border radius",{id:this.id,borderRadius:s}),this.logger.debug("Container","applyBorderRadius","Border radius placeholder - would create rounded rectangle",{id:this.id,borderRadius:s}))}applyBoxShadow(e){if(e.boxShadow!==void 0){this.logger.debug("Container","applyBoxShadow","Applying box shadow",{id:this.id,boxShadow:e.boxShadow});const s=this.parseBoxShadow(e.boxShadow);if(s){const i=this.getByName("box-shadow");i&&i.destroy();const a=this.scene.add.rectangle(s.offsetX,s.offsetY,(this.width||this.scene.game.config.width)+s.blur*2,(this.height||this.scene.game.config.height)+s.blur*2,B.Display.Color.ValueToColor(s.color).color,s.alpha);a.setName("box-shadow"),this.addAt(a,0),this.logger.debug("Container","applyBoxShadow","Box shadow created",{id:this.id,boxShadow:s})}}}parseBoxShadow(e){try{const s=e.match(/(-?\d+(?:px)?)\s+(-?\d+(?:px)?)\s+(\d+(?:px)?)\s+(.+)/);if(s){const i=parseInt(s[1])||0,a=parseInt(s[2])||0,r=parseInt(s[3])||0;let o="#000000",c=.3;const f=s[4].trim();if(f.includes("rgba")){const g=f.match(/rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*([\d.]+))?\)/);if(g){const u=parseInt(g[1]),p=parseInt(g[2]),C=parseInt(g[3]);c=g[4]?parseFloat(g[4]):1,o=`#${u.toString(16).padStart(2,"0")}${p.toString(16).padStart(2,"0")}${C.toString(16).padStart(2,"0")}`}}else f.includes("#"),o=f;return{offsetX:i,offsetY:a,blur:r,color:o,alpha:c}}}catch(s){this.logger.warn("Container","parseBoxShadow","Failed to parse box shadow",{id:this.id,boxShadow:e,error:s instanceof Error?s.message:String(s)})}return null}applyStylePropertiesDirectly(e){this.applyPositionProperties(e),this.applySizeProperties(e),this.applyVisualProperties(e),this.applyBackgroundProperties(e),this.applyAdditionalStyleProperties(e)}applyStyleCascade(e){var i,a,r,o,c;if(!this.injectedConfigs)return this.logger.debug("Container","applyStyleCascade","No injected configs, using layout properties directly",{id:this.id}),e;let s=m({},e);if((i=this.injectedConfigs.responsive)!=null&&i.default){const f=this.injectedConfigs.responsive.default.find(g=>g.id===this.id);f!=null&&f.layoutProperties&&(this.logger.debug("Container","applyStyleCascade","Applying default responsive settings",{id:this.id,defaultProperties:f.layoutProperties}),s=m(m({},s),f.layoutProperties))}if((a=this.injectedConfigs.responsive)!=null&&a.responsiveSettings&&this.injectedConfigs.currentBreakpoint){const f=this.injectedConfigs.responsive.responsiveSettings[this.injectedConfigs.currentBreakpoint];if(f){const g=f.find(u=>u.id===this.id);g!=null&&g.layoutProperties&&(this.logger.debug("Container","applyStyleCascade","Applying breakpoint-specific settings",{id:this.id,breakpoint:this.injectedConfigs.currentBreakpoint,breakpointProperties:g.layoutProperties}),s=m(m({},s),g.layoutProperties))}}if(s.classes&&((r=this.injectedConfigs.theme)!=null&&r.themeClasses)&&(this.logger.debug("Container","applyStyleCascade","Applying theme classes",{id:this.id,classes:s.classes,themeName:this.injectedConfigs.theme.themeName}),this.applyThemeClasses(s.classes,this.injectedConfigs.theme),s.classes&&((c=(o=this.injectedConfigs)==null?void 0:o.theme)!=null&&c.themeClasses))){const f=this.injectedConfigs.theme.themeClasses;s.classes.forEach(g=>{const u=f[g];u&&(this.logger.debug("Container","unknown","Merging theme class properties",{id:this.id,className:g,themeClass:u}),s=m(m({},s),u))})}return this.logger.debug("Container","unknown","Style cascade completed",{id:this.id,originalProperties:e,finalProperties:s}),s}addChild(e){if(this.children.length>=this.constraints.maxChildren){this.logger.warn("Container","addChild","Cannot add child - max children reached",{id:this.id,currentCount:this.children.length,maxCount:this.constraints.maxChildren});return}this.children.push(e),e.phaserObject?this.add(e.phaserObject):e instanceof B.GameObjects.GameObject&&this.add(e),this.logger.debug("Container","addChild","Child added to container",{id:this.id,childId:e.id||"unknown",childCount:this.children.length})}removeChild(e){const s=this.children.indexOf(e);s!==-1&&(this.children.splice(s,1),e.phaserObject?this.remove(e.phaserObject):e instanceof B.GameObjects.GameObject&&this.remove(e),this.logger.debug("Container","removeChild","Child removed from container",{id:this.id,childId:e.id||"unknown",childCount:this.children.length}))}getChild(e){return this.children.find(s=>s.id===e)}getAllChildren(){return[...this.children]}clearChildren(){this.children.length=0,this.removeAll(),this.logger.debug("Container","clearChildren","All children cleared",{id:this.id})}handleResponsiveResize(e,s){this.logger.debug("Container","handleResponsiveResize","Handling responsive resize",{id:this.id,newDimensions:{width:e,height:s},currentDimensions:this.size}),this.layoutProperties&&(this.layoutProperties=Z(m({},this.layoutProperties),{width:e,height:s}),this.setStyle(this.layoutProperties))}resize(e,s){this.logger.debug("Container","resize","Resize called",{id:this.id,newDimensions:{width:e,height:s},currentDimensions:this.size}),this.resizeSelf(e,s),this.propagateResizeToChildren(e,s),this.resizeAfter(e,s)}resizeSelf(e,s){this.logger.debug("Container","resizeSelf","Resizing self",{id:this.id,newDimensions:{width:e,height:s},currentDimensions:this.size}),this.layoutProperties&&(this.layoutProperties=Z(m({},this.layoutProperties),{width:e,height:s}),this.setStyle(this.layoutProperties))}propagateResizeToChildren(e,s){this.logger.debug("Container","propagateResizeToChildren","Propagating resize to children",{id:this.id,newDimensions:{width:e,height:s},childCount:this.children.length}),this.children.forEach((i,a)=>{if(i&&typeof i.resize=="function")try{i.resize(e,s),this.logger.debug("Container","propagateResizeToChildren","Child resize called",{id:this.id,childName:i.name||i.id||`child-${a}`,childType:i.constructor.name})}catch(r){this.logger.warn("Container","propagateResizeToChildren","Failed to resize child",{id:this.id,childName:i.name||i.id||`child-${a}`,error:r instanceof Error?r.message:String(r)})}})}resizeAfter(e,s){this.logger.debug("Container","resizeAfter","Post-resize operations",{id:this.id,newDimensions:{width:e,height:s}})}getContainerBounds(){return{x:this.x,y:this.y,width:this.width,height:this.height}}getLayoutInfo(){return{id:this.id,type:this.containerType,childCount:this.children.length}}invalidateLayout(){this.logger.debug("Container","invalidateLayout","Layout invalidated",{id:this.id})}updateLayout(){this.logger.debug("Container","updateLayout","Updating layout",{id:this.id})}destroy(e){this.logger.debug("Container","destroy","Destroying container",{id:this.id}),this.clearChildren(),super.destroy(e)}static createFromConfig(e,s,i){const a=A.getInstance();a.debug("Container","createFromConfig","Creating Container from config",{objectId:e.id,objectName:e.name,hasParent:!!i,parentId:(i==null?void 0:i.name)||"none"});try{const r=new ie(s,e.x||0,e.y||0);if(e.name&&(r.name=e.name),r.id=e.id,s.getGameObjectConfigs){a.debug("Container","createFromConfig","Scene supports getGameObjectConfigs, injecting configs",{objectId:e.id,sceneType:s.constructor.name});const o=s.getGameObjectConfigs(e.id);a.debug("Container","createFromConfig","Received configs from scene",{objectId:e.id,hasResponsive:!!(o!=null&&o.responsive),hasTheme:!!(o!=null&&o.theme),currentBreakpoint:o==null?void 0:o.currentBreakpoint}),r.initializeWithConfigs(o)}else a.warn("Container","createFromConfig","Scene does not support getGameObjectConfigs",{objectId:e.id,sceneType:s.constructor.name});if(e.properties){if(e.properties.backgroundColor&&r.setStyle({backgroundColor:e.properties.backgroundColor,maintainAspectRatio:!1,scaleStrategy:"stretch",alignment:"center"}),e.properties.width||e.properties.height){let o=e.properties.width,c=e.properties.height;o==="fill"&&(o=s.game.config.width),c==="fill"&&(c=s.game.config.height),r.setStyle({width:o,height:c,maintainAspectRatio:!1,scaleStrategy:"stretch",alignment:"center"})}e.properties.interactive!==void 0&&r.setInteractive(e.properties.interactive)}return i?(i.add(r),a.debug("Container","createFromConfig","Container added to parent",{objectId:e.id,parentId:i.name||"unnamed"})):(s.add.existing(r),a.debug("Container","createFromConfig","Container added to scene",{objectId:e.id})),a.info("Container","createFromConfig","Container created successfully from config",{objectId:e.id,objectName:e.name,phaserObjectType:r.constructor.name}),r}catch(r){throw a.error("Container","createFromConfig","Failed to create Container from config",{objectId:e.id,error:r instanceof Error?r.message:String(r)}),r}}}class et extends Q{constructor(){super(["container"]),h.debug("ContainerFactory","constructor","ContainerFactory initialized",{supportedTypes:this.getSupportedTypes()})}createGameObject(t){if(t.type!=="container")return h.error("ContainerFactory","createGameObject","Invalid input type for container factory",{expectedType:"container",actualType:t.type}),null;const e=t.config,s=t.scene;h.debug("ContainerFactory","createGameObject","Creating container game object",{objectId:e.id,objectType:t.type,config:{x:e.x,y:e.y,width:e.width,height:e.height,name:e.name}});try{const i=new ie(s,e.id,e.x||0,e.y||0,t.parent||null);if(h.debug("ContainerFactory","createGameObject","Custom Container wrapper created",{objectId:e.id,containerType:i.constructor.name,position:{x:i.x,y:i.y}}),s.getGameObjectConfigs){h.debug("ContainerFactory","createGameObject","Scene supports getGameObjectConfigs, calling it",{objectId:e.id,sceneType:s.constructor.name});const a=s.getGameObjectConfigs(e.id);h.debug("ContainerFactory","createGameObject","Received configs from scene",{objectId:e.id,configs:a,hasResponsive:!!(a!=null&&a.responsive),hasTheme:!!(a!=null&&a.theme),currentBreakpoint:a==null?void 0:a.currentBreakpoint}),i.initializeWithConfigs(a),h.debug("ContainerFactory","createGameObject","Configurations injected into container",{objectId:e.id,hasResponsive:!!a.responsive,hasTheme:!!a.theme,currentBreakpoint:a.currentBreakpoint})}else h.warn("ContainerFactory","createGameObject","Scene does not support getGameObjectConfigs",{objectId:e.id,sceneType:s.constructor.name});if(this.setCommonProperties(i,t),e.width&&e.width!=="fill"&&(h.debug("ContainerFactory","createGameObject","Setting container size",{objectId:e.id,width:e.width,height:e.height||e.width}),i.setSize(e.width,typeof e.height=="number"?e.height:e.width)),i.name=e.name||e.id,e.interactive!==void 0&&(h.debug("ContainerFactory","createGameObject","Setting container interactivity",{objectId:e.id,interactive:e.interactive}),e.interactive?i.setInteractive():i.disableInteractive()),e.backgroundColor){h.debug("ContainerFactory","createGameObject","Setting container background color",{objectId:e.id,backgroundColor:e.backgroundColor});const a=s.add.rectangle(0,0,typeof e.width=="number"?e.width:100,typeof e.height=="number"?e.height:100,this.parseColor(String(e.backgroundColor)));i.add(a),i.setSize(a.width,a.height),h.debug("ContainerFactory","createGameObject","Container background added",{objectId:e.id,backgroundSize:{width:a.width,height:a.height}})}return h.info("ContainerFactory","createGameObject","Custom Container created successfully",{objectId:e.id,containerType:i.constructor.name,containerName:i.name,hasBackground:!!e.backgroundColor,size:{width:i.width,height:i.height}}),i}catch(i){return h.error("ContainerFactory","createGameObject","Failed to create container: ${config.id}",i),null}}parseColor(t){try{const e=t.startsWith("#")?t.slice(1):t,s=parseInt(e,16);return h.debug("ContainerFactory","parseColor","Parsed color",{originalColor:t,cleanColor:e,hexColor:`0x${e}`,parsedValue:s}),s}catch(e){return h.warn("ContainerFactory","parseColor","Failed to parse color, using default",{color:t,error:e instanceof Error?e.message:String(e)}),8421504}}}class tt extends Q{constructor(){super(["image"]);d(this,"logger",A.getInstance())}createGameObject(e){const s=e.config||{},i=e.scene;try{if(!s.textureKey||!i.textures.exists(s.textureKey))return this.logger.warn("ImageFactory","createGameObject",`Texture key '${s.textureKey}' not found for image: ${s.id}`,null),null;const a=i.add.image(s.x||0,s.y||0,s.textureKey);return this.setCommonProperties(a,s),s.scale&&(typeof s.scale=="number"?a.setScale(s.scale):(s.scale.x!==void 0||s.scale.y!==void 0)&&a.setScale(s.scale.x||1,s.scale.y||1)),s.origin&&a.setOrigin(s.origin.x||.5,s.origin.y||.5),s.interactive&&a.setInteractive(),a}catch(a){return this.logger.error("ImageFactory","createGameObject",`Error creating image '${(s==null?void 0:s.id)||"unknown"}':`,a),null}}}class st extends Q{constructor(){super(["text"]);d(this,"logger",A.getInstance())}createGameObject(e){const s=e.config||{},i=e.scene;try{const a={fontSize:s.fontSize||"32px",fontFamily:s.fontFamily||"Arial",color:s.color||"#ffffff",backgroundColor:s.backgroundColor,stroke:s.stroke,strokeThickness:s.strokeThickness||0,shadow:s.shadow,align:s.align||"left",wordWrap:s.wordWrap||!1,maxLines:s.maxLines},r=i.add.text(s.x||0,s.y||0,s.content||"",a);return this.setCommonProperties(r,s),s.origin&&r.setOrigin(s.origin.x||0,s.origin.y||0),s.interactive&&r.setInteractive(),r}catch(a){return this.logger.error("TextFactory","createGameObject",`Error creating text '${(s==null?void 0:s.id)||"unknown"}':`,a),null}}}class it extends Q{constructor(){super(["button"]);d(this,"logger",A.getInstance())}createGameObject(e){const s=e.config||{},i=e.scene;try{const a=i.add.container(s.x||0,s.y||0);this.setCommonProperties(a,s);const r=i.add.rectangle(0,0,s.width||200,s.height||50,s.backgroundColor||4886754),o=i.add.text(0,0,s.text||"Button",{fontSize:s.fontSize||"18px",color:s.textColor||"#ffffff",fontFamily:s.fontFamily||"Arial"});return o.setOrigin(.5),a.add([r,o]),s.width&&s.width!=="fill"&&a.setSize(s.width,s.height||s.width),a.setInteractive(),s.hoverEffects&&(a.on("pointerover",()=>{s.hoverEffects.scale&&a.setScale(s.hoverEffects.scale),s.hoverEffects.tint&&r.setFillStyle(B.Display.Color.ValueToColor(s.hoverEffects.tint).color)}),a.on("pointerout",()=>{s.hoverEffects.scale&&a.setScale(1),s.hoverEffects.tint&&r.setFillStyle(B.Display.Color.ValueToColor(s.backgroundColor||"#ffffff").color)})),s.onClick&&a.on("pointerdown",s.onClick),a}catch(a){return this.logger.error("ButtonFactory","createGameObject",`Error creating button '${(s==null?void 0:s.id)||"unknown"}':`,a),null}}}class at extends Q{constructor(){super(["rectangle","circle","ellipse","triangle","polygon"]);d(this,"logger",A.getInstance());this.logger.debug("ShapeFactory","super","ShapeFactory initialized",{supportedTypes:this.getSupportedTypes()})}createGameObject(e){const s=e.config||{},i=e.scene;this.logger.debug("ShapeFactory","createGameObject","Creating shape game object",{objectId:s.id,objectType:s.type,config:{x:s.x,y:s.y,width:s.width,height:s.height,fillColor:s.fillColor,name:s.name}});try{let a=null;switch(s.type){case"rectangle":a=this.createRectangle(i,s);break;case"circle":a=this.createCircle(i,s);break;case"ellipse":a=this.createEllipse(i,s);break;case"triangle":a=this.createTriangle(i,s);break;case"polygon":a=this.createPolygon(i,s);break;default:return this.logger.warn("ShapeFactory","createGameObject","Unknown shape type: ${config.type}",{objectId:s.id,supportedTypes:this.getSupportedTypes()}),null}return a&&(this.setCommonProperties(a,s),a.name=s.name||s.id,this.logger.info("ShapeFactory","createGameObject","Shape created successfully",{objectId:s.id,shapeType:s.type,phaserObjectType:a.constructor.name,shapeName:a.name})),a}catch(a){return this.logger.error("ShapeFactory","createGameObject","Error creating shape: ${config.id}",{error:a instanceof Error?a.message:String(a),objectId:s.id,objectType:s.type}),null}}createRectangle(e,s){this.logger.debug("ShapeFactory","createRectangle","Creating rectangle shape",{objectId:s.id,dimensions:{width:s.width,height:s.height},fillColor:s.fillColor});const i=e.add.rectangle(s.x||0,s.y||0,s.width||100,s.height||100,this.parseColor(s.fillColor||16777215));return i.setOrigin(0,0),s.width&&s.width!=="fill"&&i.setSize(s.width,s.height||s.width),i}createCircle(e,s){this.logger.debug("ShapeFactory","createCircle","Creating circle shape",{objectId:s.id,radius:s.radius||s.width/2,fillColor:s.fillColor});const i=s.radius||(s.width||100)/2,a=e.add.circle(s.x||0,s.y||0,i,this.parseColor(s.fillColor||16777215));return a.setOrigin(.5,.5),a}createEllipse(e,s){this.logger.debug("ShapeFactory","createEllipse","Creating ellipse shape",{objectId:s.id,dimensions:{width:s.width,height:s.height},fillColor:s.fillColor});const i=e.add.ellipse(s.x||0,s.y||0,s.width||100,s.height||100,this.parseColor(s.fillColor||16777215));return i.setOrigin(.5,.5),i}createTriangle(e,s){this.logger.debug("ShapeFactory","createTriangle","Creating triangle shape",{objectId:s.id,dimensions:{width:s.width,height:s.height},fillColor:s.fillColor});const i=s.width||100,a=s.height||100,r=e.add.triangle(s.x||0,s.y||0,0,-a/2,-i/2,a/2,i/2,a/2,this.parseColor(s.fillColor||16777215));return r.setOrigin(.5,.5),r}createPolygon(e,s){this.logger.debug("ShapeFactory","createPolygon","Creating polygon shape",{objectId:s.id,points:s.points,fillColor:s.fillColor});const i=s.points||this.createHexagonPoints(s.width||100,s.height||100),a=e.add.polygon(s.x||0,s.y||0,i,this.parseColor(s.fillColor||16777215));return a.setOrigin(.5,.5),a}createHexagonPoints(e,s){const r=e/2,o=s/2,c=[];for(let f=0;f<6;f++){const g=f*Math.PI/3,u=0+r*Math.cos(g),p=0+o*Math.sin(g);c.push(u,p)}return c}parseColor(e){if(typeof e=="number")return e;if(typeof e=="string"){if(e.startsWith("#"))return parseInt(e.slice(1),16);if(e.startsWith("0x"))return parseInt(e,16);const s=e.match(/^([0-9a-fA-F]{6})$/i);if(s)return parseInt(s[1],16)}return this.logger.warn("ShapeFactory","parseColor","Failed to parse color, using default",{color:e,defaultColor:16777215}),16777215}}const V=class V{constructor(){d(this,"factories",new Map);h.debug("GameObjectFactoryManager","unknown","constructor","Initializing GameObjectFactoryManager"),this.registerDefaultFactories()}static getInstance(){return V.instance||(V.instance=new V),V.instance}registerDefaultFactories(){h.debug("GameObjectFactoryManager","registerDefaultFactories","Registering default factories");try{const t=new et;this.registerFactory("container",t),h.debug("GameObjectFactoryManager","registerDefaultFactories","Container factory registered",{supportedTypes:t.getSupportedTypes()});const e=new tt;this.registerFactory("image",e),h.debug("GameObjectFactoryManager","registerDefaultFactories","Image factory registered",{supportedTypes:e.getSupportedTypes()});const s=new st;this.registerFactory("text",s),h.debug("GameObjectFactoryManager","registerDefaultFactories","Text factory registered",{supportedTypes:s.getSupportedTypes()});const i=new it;this.registerFactory("button",i),h.debug("GameObjectFactoryManager","registerDefaultFactories","Button factory registered",{supportedTypes:i.getSupportedTypes()});const a=new at;this.registerFactory("shape",a),h.debug("GameObjectFactoryManager","registerDefaultFactories","Shape factory registered",{supportedTypes:a.getSupportedTypes()}),h.info("GameObjectFactoryManager","registerDefaultFactories","All default factories registered successfully",{totalFactories:this.factories.size,factoryTypes:Array.from(this.factories.keys())})}catch(t){throw h.error("GameObjectFactoryManager","registerDefaultFactories","Error registering default factories",t),t}}registerFactory(t,e){h.debug("GameObjectFactoryManager","registerFactory","Registering factory",{objectType:t,factoryType:e.constructor.name,supportedTypes:e.getSupportedTypes()}),this.factories.set(t,e),h.debug("GameObjectFactoryManager","registerFactory","Factory registered successfully",{objectType:t,totalFactories:this.factories.size})}createGameObject(t){var e;h.debug("GameObjectFactoryManager","createGameObject","Creating game object",{objectId:t.config.id,objectType:t.type,hasConfig:!!t.config,configKeys:t.config?Object.keys(t.config):[]});try{if(!t.config||!t.type)return h.warn("GameObjectFactoryManager","createGameObject","Invalid input provided",{hasConfig:!!t.config,inputType:t.type,input:t}),null;const s=this.getFactoryForType(t.type);if(!s)return h.warn("GameObjectFactoryManager","createGameObject","No factory found for object type",{objectType:t.type,availableFactories:Array.from(this.factories.keys()),objectId:t.config.id}),null;if(h.debug("GameObjectFactoryManager","createGameObject","Factory found, creating game object",{objectId:t.config.id,objectType:t.type,factoryType:s.constructor.name,canCreate:s.canCreate(t.type)}),!s.canCreate(t.type))return h.warn("GameObjectFactoryManager","createGameObject","Factory cannot create this object type",{objectType:t.type,factoryType:s.constructor.name,supportedTypes:s.getSupportedTypes(),objectId:t.config.id}),null;const i=s.createGameObject(t);return i?h.debug("GameObjectFactoryManager","createGameObject","Game object created successfully",{objectId:t.config.id,objectType:t.type,phaserObjectType:i.constructor.name,gameObjectName:i.name}):h.error("GameObjectFactoryManager","createGameObject","Factory failed to create game object",{objectId:t.config.id,objectType:t.type,factoryType:s.constructor.name}),i}catch(s){return h.error("GameObjectFactoryManager","createGameObject",`Error creating game object: ${(e=t.config)==null?void 0:e.id}`,s),null}}getFactoryForType(t){return this.factories.get(t)}createGameObjectWithStaticFactory(t,e,s){return l(this,null,function*(){var i,a,r,o;h.debug("GameObjectFactoryManager","createGameObjectWithStaticFactory","Creating game object with static factory",{objectId:t.id,className:(i=t.factory)==null?void 0:i.className,createMethod:(a=t.factory)==null?void 0:a.createMethod});try{if(!((r=t.factory)!=null&&r.className))return h.warn("GameObjectFactoryManager","createGameObjectWithStaticFactory","No factory configuration provided",{objectId:t.id,hasFactory:!!t.factory,factoryConfig:t.factory}),null;const{className:c,createMethod:f="createFromConfig"}=t.factory;let g;switch(c){case"BackgroundContainer":h.debug("GameObjectFactoryManager","unknown","createGameObjectWithStaticFactory","Loading BackgroundContainer class");try{g=(yield Se(()=>Promise.resolve().then(()=>ft),void 0)).BackgroundContainer,h.debug("GameObjectFactoryManager","unknown","createGameObjectWithStaticFactory","BackgroundContainer class loaded successfully")}catch(u){return h.error("GameObjectFactoryManager","createGameObjectWithStaticFactory","Failed to import BackgroundContainer module",{objectId:t.id,error:u instanceof Error?u.message:String(u)}),null}break;case"Rectangle":h.debug("GameObjectFactoryManager","unknown","createGameObjectWithStaticFactory","Loading Rectangle class");try{g=(yield Se(()=>Promise.resolve().then(()=>mt),void 0)).Rectangle,h.debug("GameObjectFactoryManager","unknown","createGameObjectWithStaticFactory","Rectangle class loaded successfully")}catch(u){return h.error("GameObjectFactoryManager","createGameObjectWithStaticFactory","Failed to import Rectangle module",{objectId:t.id,error:u instanceof Error?u.message:String(u)}),null}break;default:return h.warn("GameObjectFactoryManager","createGameObjectWithStaticFactory",`Unknown factory class: ${c}`,{objectId:t.id,availableClasses:["BackgroundContainer","Rectangle"]}),null}if(typeof g[f]=="function"){h.debug("GameObjectFactoryManager","createGameObjectWithStaticFactory","Calling static factory method",{objectId:t.id,className:c,createMethod:f});try{const u=g[f](t,e,s);return h.debug("GameObjectFactoryManager","createGameObjectWithStaticFactory","Static factory method executed successfully",{objectId:t.id,hasResult:!!u,resultType:u==null?void 0:u.constructor.name}),u}catch(u){return h.error("GameObjectFactoryManager","createGameObjectWithStaticFactory","Static factory method execution failed",{objectId:t.id,className:c,createMethod:f,error:u instanceof Error?u.message:String(u)}),null}}else return h.warn("GameObjectFactoryManager","createGameObjectWithStaticFactory",`Factory method '${f}' not found in ${c}`,{objectId:t.id,availableMethods:Object.getOwnPropertyNames(g).filter(u=>typeof g[u]=="function")}),null}catch(c){return h.error("GameObjectFactoryManager","createGameObjectWithStaticFactory",`Critical error using static factory for ${t.id}:`,{error:c instanceof Error?c.message:String(c),objectId:t.id,className:(o=t.factory)==null?void 0:o.className}),null}})}hasFactory(t){const e=this.factories.has(t);return h.debug("GameObjectFactoryManager","hasFactory","Checking if factory exists",{objectType:t,hasFactory:e}),e}getRegisteredTypes(){const t=Array.from(this.factories.keys());return h.debug("GameObjectFactoryManager","getRegisteredTypes","Getting registered factory types",{types:t,count:t.length}),t}getFactory(t){const e=this.factories.get(t);return h.debug("GameObjectFactoryManager","getFactory","Getting factory",{objectType:t,hasFactory:!!e,factoryType:e==null?void 0:e.constructor.name}),e}getStats(){const t={totalFactories:this.factories.size,registeredTypes:Array.from(this.factories.keys()),factoryDetails:Array.from(this.factories.entries()).map(([e,s])=>({type:e,factoryClass:s.constructor.name,supportedTypes:s.getSupportedTypes()}))};return h.debug("GameObjectFactoryManager","getStats","Getting factory statistics",t),t}};d(V,"instance");let ge=V;var I=(n=>(n.PIXEL="pixel",n.PERCENTAGE="percentage",n.PARENT_WIDTH="parent-width",n.PARENT_HEIGHT="parent-height",n.PARENT_MIN="parent-min",n.PARENT_MAX="parent-max",n.SCENE_WIDTH="scene-width",n.SCENE_HEIGHT="scene-height",n.SCENE_MIN="scene-min",n.SCENE_MAX="scene-max",n.VIEWPORT_WIDTH="viewport-width",n.VIEWPORT_HEIGHT="viewport-height",n))(I||{}),ue=(n=>(n.STATIC="static",n.RELATIVE="relative",n.ABSOLUTE="absolute",n.FIXED="fixed",n.STICKY="sticky",n))(ue||{}),Be=(n=>(n.VISIBLE="visible",n.HIDDEN="hidden",n.SCROLL="scroll",n.AUTO="auto",n))(Be||{}),H=(n=>(n.LEFT="left",n.CENTER="center",n.RIGHT="right",n.JUSTIFY="justify",n))(H||{}),O=(n=>(n.LIGHT="light",n.DARK="dark",n.AUTO="auto",n.CUSTOM="custom",n))(O||{});m({},O);var Fe=(n=>(n.DEFAULT="default",n.PRIMARY="primary",n.SECONDARY="secondary",n.SUCCESS="success",n.WARNING="warning",n.ERROR="error",n.INFO="info",n))(Fe||{}),j=(n=>(n.BLOCK="block",n.INLINE="inline",n.INLINE_BLOCK="inline-block",n.FLEX="flex",n.GRID="grid",n.NONE="none",n))(j||{}),Oe=(n=>(n.CLIP="clip",n.ELLIPSIS="ellipsis",n.FADE="fade",n))(Oe||{}),Ee=(n=>(n.NORMAL="normal",n.NOWRAP="nowrap",n.PRE="pre",n.PRE_WRAP="pre-wrap",n.PRE_LINE="pre-line",n))(Ee||{}),U=(n=>(n.SCENE="scene",n.GAME_OBJECT="gameObject",n.UI="ui",n.CONTAINER="container",n))(U||{});class rt{constructor(){d(this,"themesMap",new Map);d(this,"activeThemeInstance",null);d(this,"currentThemeTypeInstance",O.CUSTOM);d(this,"isInitializedInstance",!1);d(this,"listenersSet",new Set);d(this,"themeCacheMap",new Map)}get themes(){return this.themesMap}get activeTheme(){return this.activeThemeInstance}get currentThemeType(){return this.currentThemeTypeInstance}get isInitialized(){return this.isInitializedInstance}get listeners(){return this.listenersSet}get themeCache(){return this.themeCacheMap}initialize(t){return l(this,null,function*(){h.info("ThemeManager","initialize","Initializing theme manager",{defaultTheme:t});try{this.isInitializedInstance=!0,t&&this.themesMap.has(t)&&(yield this.activateTheme(t)),h.info("ThemeManager","initialize","Theme manager initialized successfully")}catch(e){throw h.error("ThemeManager","initialize","Failed to initialize theme manager",{error:e}),e}})}registerTheme(t){h.info("ThemeManager","registerTheme","Registering theme",{themeId:t.id});try{this.validateTheme(t),this.themesMap.set(t.id,t),this.cacheThemeClasses(t),h.info("ThemeManager","registerTheme","Theme registered successfully",{themeId:t.id})}catch(e){throw h.error("ThemeManager","registerTheme","Failed to register theme",{error:e,themeId:t.id}),e}}unregisterTheme(t){var e;h.info("ThemeManager","unregisterTheme","Unregistering theme",{themeId:t});try{return((e=this.activeThemeInstance)==null?void 0:e.id)===t?(h.warn("ThemeManager","unregisterTheme","Cannot unregister active theme",{themeId:t}),!1):this.themesMap.has(t)?(this.themesMap.delete(t),this.clearThemeCache(t),h.info("ThemeManager","unregisterTheme","Theme unregistered successfully",{themeId:t}),!0):(h.warn("ThemeManager","unregisterTheme","Theme not found",{themeId:t}),!1)}catch(s){return h.error("ThemeManager","unregisterTheme","Failed to unregister theme",{error:s,themeId:t}),!1}}getTheme(t){return this.themesMap.get(t)}getThemeByName(t){for(const e of this.themesMap.values())if(e.name===t)return e}getThemes(t){const e=Array.from(this.themesMap.values());return t?e.filter(t):e}getThemesByType(t){return this.getThemes(e=>e.type===t)}getThemesByVariant(t){return this.getThemes(e=>e.variant===t)}hasTheme(t){return this.themesMap.has(t)}activateTheme(t){return l(this,null,function*(){h.info("ThemeManager","activateTheme","Activating theme",{themeId:t});try{const e=this.themesMap.get(t);if(!e)throw new Error(`Theme not found: ${t}`);this.activeThemeInstance&&(yield this.deactivateTheme(this.activeThemeInstance.id)),this.activeThemeInstance=e,this.currentThemeTypeInstance=e.type,yield this.applyThemeToDOM(e),this.notifyThemeActivated(e),h.info("ThemeManager","activateTheme","Theme activated successfully",{themeId:t})}catch(e){throw h.error("ThemeManager","activateTheme","Failed to activate theme",{error:e,themeId:t}),e}})}deactivateTheme(t){return l(this,null,function*(){var e;h.info("ThemeManager","deactivateTheme","Deactivating theme",{themeId:t});try{((e=this.activeThemeInstance)==null?void 0:e.id)===t&&(yield this.removeThemeFromDOM(this.activeThemeInstance),this.notifyThemeDeactivated(this.activeThemeInstance),this.activeThemeInstance=null),h.info("ThemeManager","deactivateTheme","Theme deactivated successfully",{themeId:t})}catch(s){throw h.error("ThemeManager","deactivateTheme","Failed to deactivate theme",{error:s,themeId:t}),s}})}activateThemeByName(t){return l(this,null,function*(){const e=this.getThemeByName(t);if(!e)throw new Error(`Theme not found with name: ${t}`);yield this.activateTheme(e.id)})}getActiveTheme(){return this.activeThemeInstance}isThemeActive(t){var e;return((e=this.activeThemeInstance)==null?void 0:e.id)===t}toggleThemeMode(){return l(this,null,function*(){this.currentThemeTypeInstance===O.LIGHT?yield this.switchToDarkTheme():yield this.switchToLightTheme()})}switchToLightTheme(){return l(this,null,function*(){const t=this.getThemesByType(O.LIGHT);t.length>0&&(yield this.activateTheme(t[0].id))})}switchToDarkTheme(){return l(this,null,function*(){const t=this.getThemesByType(O.DARK);t.length>0&&(yield this.activateTheme(t[0].id))})}getThemeClass(t){var e;if((e=this.activeThemeInstance)!=null&&e.themeClasses)return this.activeThemeInstance.themeClasses[t]}getColor(t){var i;if(!((i=this.activeThemeInstance)!=null&&i.colors))return"#000000";const e=t.split(".");let s=this.activeThemeInstance.colors;for(const a of e)if(s&&typeof s=="object"&&a in s)s=s[a];else return"#000000";return typeof s=="string"?s:"#000000"}getSpacing(t){var s,i;if(!((i=(s=this.activeThemeInstance)==null?void 0:s.spacing)!=null&&i.scale))return 0;const e=this.activeThemeInstance.spacing.scale[t];return typeof e=="number"?e:0}getFontSize(t){var s,i;if(!((i=(s=this.activeThemeInstance)==null?void 0:s.typography)!=null&&i.fontSize))return 16;const e=this.activeThemeInstance.typography.fontSize[t];return typeof e=="number"?e:16}getBorderRadius(t){var s;if(!((s=this.activeThemeInstance)!=null&&s.borderRadius))return 0;const e=this.activeThemeInstance.borderRadius[t];return typeof e=="number"?e:0}getShadow(t){var s;if(!((s=this.activeThemeInstance)!=null&&s.shadows))return"none";const e=this.activeThemeInstance.shadows[t];return typeof e=="string"?e:"none"}getAnimationDuration(t){var s,i;if(!((i=(s=this.activeThemeInstance)==null?void 0:s.animation)!=null&&i.duration))return 300;const e=this.activeThemeInstance.animation.duration[t];return typeof e=="number"?e:300}supportsBreakpoint(t){var e;return(e=this.activeThemeInstance)!=null&&e.breakpoints?t in this.activeThemeInstance.breakpoints:!1}applyThemeClass(t,e){if(!t||typeof t!="object"||!("style"in t)){h.warn("ThemeManager","applyThemeClass","Invalid element provided",{className:e});return}const s=this.getThemeClass(e);if(!s){h.warn("ThemeManager","applyThemeClass","Theme class not found",{className:e});return}this.applyStylesToElement(t,s)}removeThemeClass(t,e){if(!t||typeof t!="object"||!("style"in t)){h.warn("ThemeManager","removeThemeClass","Invalid element provided",{className:e});return}if(!this.getThemeClass(e)){h.warn("ThemeManager","removeThemeClass","Theme class not found",{className:e});return}const i=t;i.style.cssText=""}addListener(t){this.listenersSet.add(t)}removeListener(t){return this.listenersSet.delete(t)}clearListeners(){this.listenersSet.clear()}getStatistics(){return{totalThemes:this.themesMap.size,activeThemes:this.activeThemeInstance?1:0,inactiveThemes:this.themesMap.size-(this.activeThemeInstance?1:0),themeSwitches:0,classApplications:0,averageSwitchTime:0,lastSwitchTime:0,memoryUsage:0,cacheHitRate:0,performance:{totalSwitchTime:0,switchesPerSecond:0,cacheEfficiency:0},themeTypes:{light:this.getThemesByType(O.LIGHT).length,dark:this.getThemesByType(O.DARK).length,auto:this.getThemesByType(O.AUTO).length,custom:this.getThemesByType(O.CUSTOM).length},themeVariants:{default:0,primary:0,secondary:0,success:0,warning:0,error:0,info:0}}}exportTheme(t){const e=this.getTheme(t);if(!e)throw new Error(`Theme not found: ${t}`);return JSON.stringify({metadata:{version:"1.0.0",exportedAt:new Date,exportedBy:"ThemeManager"},theme:e},null,2)}importTheme(t){try{const e=JSON.parse(t);return this.registerTheme(e.theme),e.theme}catch(e){throw new Error(`Failed to import theme: ${e}`)}}reset(){this.themesMap.clear(),this.activeThemeInstance=null,this.currentThemeTypeInstance=O.CUSTOM,this.isInitializedInstance=!1,this.listenersSet.clear(),this.themeCacheMap.clear()}destroy(){this.reset()}validateTheme(t){if(!t.id||!t.name)throw new Error("Theme must have id and name");if(!t.colors)throw new Error("Theme must have colors defined");if(!t.typography)throw new Error("Theme must have typography defined")}cacheThemeClasses(t){t.themeClasses&&Object.entries(t.themeClasses).forEach(([e,s])=>{this.themeCacheMap.set(`${t.id}:${e}`,s)})}clearThemeCache(t){const e=[];this.themeCacheMap.forEach((s,i)=>{i.startsWith(`${t}:`)&&e.push(i)}),e.forEach(s=>this.themeCacheMap.delete(s))}applyThemeToDOM(t){return l(this,null,function*(){try{this.injectCSSVariables(t),t.themeClasses&&this.applyThemeClasses(t),h.info("ThemeManager","applyThemeToDOM","Theme applied to DOM",{themeId:t.id})}catch(e){throw h.error("ThemeManager","applyThemeToDOM","Failed to apply theme to DOM",{error:e,themeId:t.id}),e}})}removeThemeFromDOM(t){return l(this,null,function*(){try{this.removeThemeClasses(t),h.info("ThemeManager","removeThemeFromDOM","Theme removed from DOM",{themeId:t.id})}catch(e){throw h.error("ThemeManager","removeThemeFromDOM","Failed to remove theme from DOM",{error:e,themeId:t.id}),e}})}injectCSSVariables(t){var s,i;const e=document.documentElement;t.colors&&this.injectColorVariables(e,t.colors,"--theme-color"),(s=t.spacing)!=null&&s.scale&&Object.entries(t.spacing.scale).forEach(([a,r])=>{e.style.setProperty(`--theme-spacing-${a}`,`${r}px`)}),(i=t.typography)!=null&&i.fontSize&&Object.entries(t.typography.fontSize).forEach(([a,r])=>{e.style.setProperty(`--theme-font-size-${a}`,`${r}px`)})}injectColorVariables(t,e,s){Object.entries(e).forEach(([i,a])=>{typeof a=="string"?t.style.setProperty(`${s}-${i}`,a):typeof a=="object"&&a!==null&&this.injectColorVariables(t,a,`${s}-${i}`)})}applyThemeClasses(t){const e=document.body;e.classList.add(`theme-${t.id}`),t.themeClasses&&Object.keys(t.themeClasses).forEach(s=>{const i=s.replace(".","");e.classList.add(i)})}removeThemeClasses(t){const e=document.body;e.classList.remove(`theme-${t.id}`),t.themeClasses&&Object.keys(t.themeClasses).forEach(s=>{const i=s.replace(".","");e.classList.remove(i)})}notifyThemeActivated(t){this.listenersSet.forEach(e=>{var s;try{(s=e.onThemeActivated)==null||s.call(e,t,this.activeThemeInstance)}catch(i){h.error("ThemeManager","notifyThemeActivated","Error in theme listener",{error:i,themeId:t.id})}})}notifyThemeDeactivated(t){this.listenersSet.forEach(e=>{var s;try{(s=e.onThemeDeactivated)==null||s.call(e,t,null)}catch(i){h.error("ThemeManager","notifyThemeDeactivated","Error in theme listener",{error:i,themeId:t.id})}})}applyStylesToElement(t,e){e.backgroundColor&&(t.style.backgroundColor=e.backgroundColor),e.color&&(t.style.color=e.color),e.padding&&(t.style.padding=`${e.padding}px`),e.margin&&(t.style.margin=`${e.margin}px`),e.borderRadius&&(t.style.borderRadius=`${e.borderRadius}px`),e.borderRadiusValue&&(t.style.borderRadius=`${e.borderRadiusValue}px`),e.fontSize&&(t.style.fontSize=`${e.fontSize}px`),e.fontWeight&&(t.style.fontWeight=e.fontWeight.toString()),e.textAlign&&(t.style.textAlign=e.textAlign),e.display&&(t.style.display=e.display),e.flexDirection&&(t.style.flexDirection=e.flexDirection),e.alignItems&&(t.style.alignItems=e.alignItems),e.justifyContent&&(t.style.justifyContent=e.justifyContent),e.cursor&&(t.style.cursor=e.cursor),e.boxSizing&&(t.style.boxSizing=e.boxSizing),e.position&&(t.style.position=e.position),e.width&&typeof e.width=="object"&&(t.style.width=`${e.width.value}${e.width.unit}`),e.height&&typeof e.height=="object"&&(t.style.height=`${e.height.value}${e.height.unit}`),e.boxShadow&&(t.style.boxShadow=e.boxShadow),e.transition&&(t.style.transition=e.transition),e.cssAnimation&&(t.style.animation=e.cssAnimation)}}class nt{constructor(t){d(this,"logger",A.getInstance());d(this,"themeManager");d(this,"activationHistory",new Map);d(this,"activeThemes",new Map);d(this,"appliedClasses",new Map);this.themeManager=t||new rt,this.logger.info("ThemeActivator","constructor","Theme activator initialized")}activateThemeForScene(t,e,s){return l(this,null,function*(){const i=performance.now(),a={success:!1,themeId:e,appliedClasses:[],errors:[],duration:0};try{this.logger.info("ThemeActivator","activateThemeForScene","Activating theme for scene",{sceneKey:t,themeId:e});const r=this.getTheme(e);if(!r)return a.errors.push("Theme not found"),a;const o=m({sceneKey:t,elementType:U.SCENE,priority:1},s);return yield this.applyThemeToScene(r,o),yield this.themeManager.activateTheme(e),this.activeThemes.set(t,r),a.success=!0,a.sceneId=t,a.appliedClasses=[],a.duration=performance.now()-i,this.activationHistory.set(`${t}:${e}`,a),this.logger.info("ThemeActivator","activateThemeForScene","Theme activated successfully",{sceneKey:t,themeId:e,duration:a.duration,appliedClasses:a.appliedClasses.length}),a}catch(r){return a.errors.push("Theme manager error"),a.duration=performance.now()-i,this.logger.error("ThemeActivator","activateThemeForScene","Theme activation failed",{error:r,sceneKey:t,themeId:e}),a}})}applyThemeToGameObject(t,e,s){return l(this,null,function*(){var r;const i=performance.now(),a={success:!1,themeId:e,appliedClasses:[],errors:[],duration:0};try{this.logger.debug("ThemeActivator","applyThemeToGameObject","Applying theme to game object",{gameObjectType:t.constructor.name,themeId:e});const o=this.getTheme(e);if(!o)return a.errors.push(`Theme not found: ${e}`),a;const c=m({sceneKey:((r=t.scene)==null?void 0:r.scene.key)||"unknown",gameObjectId:t.name||t.constructor.name,elementType:U.GAME_OBJECT,priority:2},s);return yield this.applyThemeToGameObjectInternal(t,o,c),a.success=!0,a.appliedClasses=[],a.duration=performance.now()-i,this.logger.debug("ThemeActivator","applyThemeToGameObject","Theme applied to game object",{gameObjectType:t.constructor.name,themeId:e,duration:a.duration}),a}catch(o){return a.errors.push(`Application failed: ${o}`),a.duration=performance.now()-i,this.logger.error("ThemeActivator","applyThemeToGameObject","Theme application failed",{error:o,gameObjectType:t.constructor.name,themeId:e}),a}})}switchThemeForScene(t,e,s){return l(this,null,function*(){try{this.logger.info("ThemeActivator","switchThemeForScene","Switching theme for scene",{sceneKey:t,newThemeId:e}),yield this.deactivateThemeForScene(t);const i=yield this.activateThemeForScene(t,e,s);return this.logger.info("ThemeActivator","switchThemeForScene","Theme switched successfully",{sceneKey:t,newThemeId:e,success:i.success}),i}catch(i){throw this.logger.error("ThemeActivator","switchThemeForScene","Theme switch failed",{error:i,sceneKey:t,newThemeId:e}),i}})}deactivateThemeForScene(t){return l(this,null,function*(){try{this.logger.info("ThemeActivator","deactivateThemeForScene","Deactivating theme for scene",{sceneKey:t}),this.removeAppliedClasses(t),this.activeThemes.delete(t),this.logger.info("ThemeActivator","deactivateThemeForScene","Theme deactivated successfully",{sceneKey:t})}catch(e){throw this.logger.error("ThemeActivator","deactivateThemeForScene","Theme deactivation failed",{error:e,sceneKey:t}),e}})}getActiveThemeForScene(t){const e=this.activeThemes.get(t)||this.themeManager.getActiveTheme();return this.logger.debug("ThemeActivator","getActiveThemeForScene","Getting active theme for scene",{sceneKey:t,hasActiveTheme:!!e}),e||null}getAllActiveThemes(){return this.logger.debug("ThemeActivator","getAllActiveThemes","Getting all active themes",{activeThemeCount:this.activeThemes.size}),new Map(this.activeThemes)}isThemeActiveForScene(t,e){const s=this.activeThemes.get(t)||this.themeManager.getActiveTheme(),i=(s==null?void 0:s.id)===e;return this.logger.debug("ThemeActivator","isThemeActiveForScene","Checking if theme is active for scene",{sceneKey:t,themeId:e,isActive:i}),i}getAppliedClasses(t){const e=this.appliedClasses.get(t);return e?Array.from(e):[]}getActivationHistory(){return this.logger.debug("ThemeActivator","getActivationHistory","Getting activation history",{historySize:this.activationHistory.size}),new Map(this.activationHistory)}getAvailableThemesForScene(t){try{const s=this.themeManager.getThemes().filter(i=>this.isThemeCompatibleWithScene(i,t));return this.logger.debug("ThemeActivator","getAvailableThemesForScene","Getting available themes for scene",{sceneKey:t,availableThemeCount:s.length}),s}catch(e){return this.logger.error("ThemeActivator","getAvailableThemesForScene","Failed to get available themes for scene",{error:e,sceneKey:t}),[]}}getTheme(t){const e=this.themeManager.getTheme(t);return e||null}isThemeCompatibleWithScene(t,e){return!!(t&&t.id&&t.name)}applyThemeToScene(t,e){return l(this,null,function*(){try{t.themeClasses&&(yield this.applyThemeClasses(t.themeClasses,e)),yield this.applyThemeProperties(t,e),this.logger.debug("ThemeActivator","applyThemeToScene","Theme applied to scene",{sceneKey:e.sceneKey,themeId:t.id})}catch(s){throw this.logger.error("ThemeActivator","applyThemeToScene","Failed to apply theme to scene",{error:s,sceneKey:e.sceneKey,themeId:t.id}),s}})}applyThemeToGameObjectInternal(t,e,s){return l(this,null,function*(){try{e.themeClasses&&(yield this.applyThemeClassesToGameObject(t,e.themeClasses,s)),yield this.applyThemePropertiesToGameObject(t,e,s),this.logger.debug("ThemeActivator","applyThemeToGameObjectInternal","Theme applied to game object",{gameObjectType:t.constructor.name,themeId:e.id})}catch(i){throw this.logger.error("ThemeActivator","applyThemeToGameObjectInternal","Failed to apply theme to game object",{error:i,gameObjectType:t.constructor.name,themeId:e.id}),i}})}applyThemeClasses(t,e){return l(this,null,function*(){for(const[s,i]of Object.entries(t))try{yield this.applyThemeClass(s,i,e),this.trackAppliedClass(e.sceneKey,s)}catch(a){this.logger.warn("ThemeActivator","applyThemeClasses","Failed to apply theme class",{error:a,className:s,sceneKey:e.sceneKey})}})}applyThemeClassesToGameObject(t,e,s){return l(this,null,function*(){for(const[i,a]of Object.entries(e))try{yield this.applyThemeClassToGameObject(t,i,a,s),this.trackAppliedClass(s.sceneKey,i)}catch(r){this.logger.warn("ThemeActivator","applyThemeClassesToGameObject","Failed to apply theme class to game object",{error:r,className:i,gameObjectType:t.constructor.name})}})}applyThemeClass(t,e,s){return l(this,null,function*(){this.logger.debug("ThemeActivator","applyThemeClass","Applying theme class to scene",{className:t,sceneKey:s.sceneKey})})}applyThemeClassToGameObject(t,e,s,i){return l(this,null,function*(){this.logger.debug("ThemeActivator","applyThemeClassToGameObject","Applying theme class to game object",{className:e,gameObjectType:t.constructor.name})})}applyThemeProperties(t,e){return l(this,null,function*(){this.logger.debug("ThemeActivator","applyThemeProperties","Applying theme properties to scene",{sceneKey:e.sceneKey,themeId:t.id})})}applyThemePropertiesToGameObject(t,e,s){return l(this,null,function*(){this.logger.debug("ThemeActivator","applyThemePropertiesToGameObject","Applying theme properties to game object",{gameObjectType:t.constructor.name,themeId:e.id})})}trackAppliedClass(t,e){this.appliedClasses.has(t)||this.appliedClasses.set(t,new Set),this.appliedClasses.get(t).add(e)}removeAppliedClasses(t){this.appliedClasses.delete(t)}reset(){this.activationHistory.clear(),this.activeThemes.clear(),this.appliedClasses.clear(),this.logger.info("ThemeActivator","reset","Theme activator reset")}destroy(){this.reset(),this.logger.info("ThemeActivator","destroy","Theme activator destroyed")}}class ot extends R.Scene{constructor(e){super({key:e});d(this,"configManager");d(this,"sceneConfigs",{});d(this,"gameObjects",new Map);d(this,"factoryManager");d(this,"logger",A.getInstance());d(this,"responsiveConfigLoader");d(this,"themeActivator");d(this,"cachedResponsiveConfigs",new Map);d(this,"currentBreakpoint","default");d(this,"lastResizeWidth",0);this.configManager=he.getInstance(),this.factoryManager=ge.getInstance(),this.responsiveConfigLoader=ee.getInstance(),this.themeActivator=new nt,this.logger.trace("BaseScene","super","BaseScene constructor called",{sceneKey:e,timestamp:Date.now()})}preload(){this.logger.trace("BaseScene","preload","Scene preload() method started",{sceneKey:this.scene.key,timestamp:Date.now()});try{if(this.sceneConfigs.asset&&this.sceneConfigs.asset.backgrounds){if(this.logger.trace("BaseScene","preload","Loading background images",{backgroundKeys:Object.keys(this.sceneConfigs.asset.backgrounds)}),this.sceneConfigs.asset.backgrounds.desktop){const e=this.sceneConfigs.asset.backgrounds.desktop,s=this.sceneConfigs.asset.basePath+e.path;this.logger.trace("BaseScene","preload","Loading desktop background",{key:e.key,path:s}),this.load.image(e.key,s)}if(this.sceneConfigs.asset.backgrounds.mobile){const e=this.sceneConfigs.asset.backgrounds.mobile,s=this.sceneConfigs.asset.basePath+e.path;this.logger.trace("BaseScene","preload","Loading mobile background",{key:e.key,path:s}),this.load.image(e.key,s)}if(this.sceneConfigs.asset.backgrounds.mobileOrigin){const e=this.sceneConfigs.asset.backgrounds.mobileOrigin,s=this.sceneConfigs.asset.basePath+e.path;this.logger.trace("BaseScene","preload","Loading mobile origin background",{key:e.key,path:s}),this.load.image(e.key,s)}this.logger.info("BaseScene","preload","Background images loaded successfully")}else this.logger.warn("BaseScene","preload","preload","No asset configuration found for background images")}catch(e){throw this.logger.error("BaseScene","preload","Error in scene preload",e),e}}waitForAssetsToLoad(){return l(this,null,function*(){this.logger.debug("BaseScene","waitForAssetsToLoad","waitForAssetsToLoad","Waiting for assets to load");try{this.load.isLoading()||this.load.start(),yield new Promise((e,s)=>{const i=setTimeout(()=>{s(new Error("Asset loading timeout"))},1e4);this.load.once("complete",()=>{clearTimeout(i),this.logger.info("BaseScene","clearTimeout","clearTimeout","All assets loaded successfully"),e()}),this.load.once("loaderror",a=>{clearTimeout(i),this.logger.warn("BaseScene","clearTimeout","Asset load error",{file:a}),e()})})}catch(e){this.logger.warn("BaseScene","resolve","Asset loading error or timeout, continuing anyway",e)}})}create(){return l(this,null,function*(){this.logger.trace("BaseScene","create","Scene create() method started",{sceneKey:this.scene.key,gameWidth:this.game.config.width,gameHeight:this.game.config.height,timestamp:Date.now()});try{this.registerSceneConfigs(),this.loadSceneConfigs(),this.preload(),yield this.waitForAssetsToLoad(),this.logger.info("BaseScene","create","Scene created",{sceneKey:this.scene.key,gameWidth:this.game.config.width,gameHeight:this.game.config.height,timestamp:Date.now()}),yield this.initializeSceneFromConfig(),this.setupResponsiveBehavior(),this.logger.info("BaseScene","create","Scene setup completed",{gameSize:{width:Number(this.game.config.width),height:Number(this.game.config.height)},scaleMode:this.game.scale.scaleMode,gameObjectCount:this.gameObjects.size}),yield this.logger.flushLogs()}catch(e){throw this.logger.error("BaseScene","create","Critical error in scene creation",e),yield this.logger.flushLogs(),e}})}loadSceneConfigs(){this.logger.trace("BaseScene","loadSceneConfigs","Starting to load scene configurations");try{const e=this.getSceneName();this.sceneConfigs=this.configManager.loadSceneConfigs(e),this.logger.trace("BaseScene","loadSceneConfigs","Scene configurations loaded",{sceneName:e,sceneConfigs:this.sceneConfigs,configKeys:Object.keys(this.sceneConfigs)}),this.sceneConfigs.logging?this.logger.info("BaseScene","loadSceneConfigs","All scene configurations loaded successfully"):this.logger.warn("BaseScene","loadSceneConfigs","Failed to load some scene configurations")}catch(e){throw this.logger.error("BaseScene","loadSceneConfigs","Error loading scene configurations",e),e}}initializeSceneFromConfig(){return l(this,null,function*(){var e,s,i;this.logger.trace("BaseScene","initializeSceneFromConfig","Starting scene initialization from config");try{if(!this.sceneConfigs.scene){this.logger.warn("BaseScene","initializeSceneFromConfig","No scene configuration available",{availableConfigs:Object.keys(this.sceneConfigs)});return}const a=this.sceneConfigs.scene;if(this.logger.trace("BaseScene","initializeSceneFromConfig","Scene config found",{sceneName:a.sceneName,gameObjectCount:((e=a.gameObjects)==null?void 0:e.length)||0,backgroundColor:a.backgroundColor}),this.sceneConfigs.responsive){const r=this.getSceneName();this.responsiveConfigLoader.registerConfig(r,this.sceneConfigs.responsive),this.logger.info("BaseScene","initializeSceneFromConfig","Responsive config registered",{sceneName:r,configKeys:Object.keys(this.sceneConfigs.responsive),hasDefault:!!this.sceneConfigs.responsive.default,defaultObjectCount:((s=this.sceneConfigs.responsive.default)==null?void 0:s.length)||0}),this.cacheResponsiveConfigs()}else throw this.logger.error("BaseScene","initializeSceneFromConfig","initializeSceneFromConfig","No responsive configuration found - scene cannot function properly"),new Error("Responsive configuration is required for scene functionality");this.sceneConfigs.theme?this.logger.info("BaseScene","initializeSceneFromConfig","Theme loaded",{themeName:this.sceneConfigs.theme.name,hasThemeClasses:!!this.sceneConfigs.theme.themeClasses}):this.logger.warn("BaseScene","initializeSceneFromConfig","initializeSceneFromConfig","No theme configuration found - using default styling"),a.backgroundColor&&(this.logger.debug("BaseScene","initializeSceneFromConfig","Setting scene background color",{backgroundColor:a.backgroundColor}),this.cameras.main.setBackgroundColor(a.backgroundColor)),a.gameObjects&&a.gameObjects.length>0?(this.logger.debug("BaseScene","initializeSceneFromConfig","Creating game objects from config",{gameObjectCount:a.gameObjects.length,gameObjectIds:a.gameObjects.map(r=>r.id)}),yield this.createGameObjectsFromConfig(a.gameObjects)):this.logger.warn("BaseScene","initializeSceneFromConfig","No game objects found in scene config"),this.logger.debug("BaseScene","initializeSceneFromConfig","Triggering initial resize for all game objects",{gameObjectCount:this.gameObjects.size,gameObjectIds:Array.from(this.gameObjects.keys())}),yield this.triggerInitialResize(),this.logger.info("BaseScene","initializeSceneFromConfig","Scene initialized from configuration",{sceneName:a.sceneName,gameObjectCount:((i=a.gameObjects)==null?void 0:i.length)||0,backgroundColor:a.backgroundColor,createdGameObjects:this.gameObjects.size})}catch(a){throw this.logger.error("BaseScene","initializeSceneFromConfig","Error initializing scene from config",a),a}})}createGameObjectsFromConfig(e,s){return l(this,null,function*(){var o,c,f;this.logger.debug("BaseScene","createGameObjectsFromConfig","Creating game objects recursively",{gameObjectCount:e.length,parentId:(s==null?void 0:s.name)||"root",gameObjectIds:e.map(g=>g.id)});let i=0,a=0;const r=[];for(const g of e)try{this.logger.debug("BaseScene","createGameObjectsFromConfig","Starting creation of game object",{objectId:g.id,objectType:g.type,objectName:g.name,hasFactory:!!g.factory,factoryClassName:(o=g.factory)==null?void 0:o.className,factoryCreateMethod:(c=g.factory)==null?void 0:c.createMethod,parentId:(s==null?void 0:s.name)||"root"});const u=yield this.createGameObjectFromConfig(g,s);if(u){if(i++,this.logger.debug("BaseScene","createGameObjectsFromConfig","Game object created successfully",{objectId:g.id,objectType:g.type,phaserObjectType:u.constructor.name,gameObjectName:u.name}),this.gameObjects.set(g.id,u),this.logger.debug("BaseScene","createGameObjectsFromConfig","Game object stored in scene map",{objectId:g.id,totalGameObjects:this.gameObjects.size}),g.children&&g.children.length>0)if(u instanceof R.GameObjects.Container||u.phaserObject instanceof R.GameObjects.Container){const p=u instanceof R.GameObjects.Container?u:u.phaserObject;r.push({config:g,gameObject:u,phaserContainer:p}),this.logger.debug("BaseScene","createGameObjectsFromConfig","Container stored for later child creation",{objectId:g.id,containerType:u.constructor.name,phaserContainerType:p.constructor.name,childCount:g.children.length})}else this.logger.warn("BaseScene","createGameObjectsFromConfig","Cannot add children to non-container object: ${objConfig.id}",{objectType:g.type,phaserObjectType:u.constructor.name})}else a++,this.logger.error("BaseScene","createGameObjectsFromConfig","Failed to create game object - createGameObjectFromConfig returned null",{objectId:g.id,objectType:g.type,objectName:g.name,hasFactory:!!g.factory,factoryClassName:(f=g.factory)==null?void 0:f.className})}catch(u){a++,this.logger.error("BaseScene","createGameObjectsFromConfig","Exception during game object creation: ${objConfig.id}",{error:u instanceof Error?u.message:String(u),stack:u instanceof Error?u.stack:void 0,objectId:g.id,objectType:g.type})}for(const{config:g,phaserContainer:u}of r)try{this.logger.debug("BaseScene","createGameObjectsFromConfig","Creating children for container",{objectId:g.id,childCount:g.children.length,childIds:g.children.map(p=>p.id)}),yield this.createGameObjectsFromConfig(g.children,u)}catch(p){this.logger.error("BaseScene","createGameObjectsFromConfig","Exception during child creation for container: ${objConfig.id}",{error:p instanceof Error?p.message:String(p),stack:p instanceof Error?p.stack:void 0,objectId:g.id,objectType:g.type})}this.logger.info("BaseScene","createGameObjectsFromConfig","Game objects creation batch completed",{totalRequested:e.length,successCount:i,failureCount:a,finalGameObjectCount:this.gameObjects.size,parentId:(s==null?void 0:s.name)||"root"})})}triggerInitialResize(){return l(this,null,function*(){this.logger.debug("BaseScene","triggerInitialResize","Starting initial resize for all game objects",{gameObjectCount:this.gameObjects.size,gameObjectIds:Array.from(this.gameObjects.keys())});try{const e=this.game.config.width,s=this.game.config.height;this.logger.debug("BaseScene","triggerInitialResize","Game dimensions for initial resize",{gameWidth:e,gameHeight:s,gameObjectCount:this.gameObjects.size});for(const[i,a]of this.gameObjects)try{a.resize&&typeof a.resize=="function"?(this.logger.debug("BaseScene","triggerInitialResize","Triggering resize for wrapper object",{objectId:i,objectType:a.constructor.name,hasResizeMethod:!0,hasResponsiveResizeMethod:!1}),a.resize(e,s)):a.handleResponsiveResize&&typeof a.handleResponsiveResize=="function"?(this.logger.debug("BaseScene","triggerInitialResize","Triggering responsive resize for shape object",{objectId:i,objectType:a.constructor.name,hasResponsiveResizeMethod:!0}),a.handleResponsiveResize(e,s)):a instanceof R.GameObjects.Container?this.logger.debug("BaseScene","triggerInitialResize","Skipping resize for Phaser container (no wrapper)",{objectId:i,objectType:a.constructor.name,hasResizeMethod:!1}):this.logger.debug("BaseScene","triggerInitialResize","Skipping resize for non-container object",{objectId:i,objectType:a.constructor.name,hasResizeMethod:!1,hasResponsiveResizeMethod:!1})}catch(r){this.logger.error("BaseScene","triggerInitialResize","Error during initial resize for object: ${objectId}",{error:r instanceof Error?r.message:String(r),objectId:i,objectType:a.constructor.name})}this.logger.info("BaseScene","triggerInitialResize","Initial resize completed for all game objects",{gameObjectCount:this.gameObjects.size,gameWidth:e,gameHeight:s})}catch(e){this.logger.error("BaseScene","triggerInitialResize","Error during initial resize process",{error:e instanceof Error?e.message:String(e),gameObjectCount:this.gameObjects.size})}})}createGameObjectFromConfig(e,s){return l(this,null,function*(){var i,a,r;this.logger.debug("BaseScene","createGameObjectFromConfig","Creating game object from config",{objectId:e.id,objectType:e.type,hasFactory:!!e.factory,factoryClassName:(i=e.factory)==null?void 0:i.className,parentId:(s==null?void 0:s.name)||"root"});try{let o=null;if(e.factory&&e.factory.className)this.logger.debug("BaseScene","createGameObjectFromConfig","Using static factory method",{objectId:e.id,className:e.factory.className,createMethod:e.factory.createMethod}),o=yield this.createGameObjectUsingStaticFactory(e,s),this.logger.debug("BaseScene","createGameObjectFromConfig","Static factory method completed",{objectId:e.id,hasResult:!!o,resultType:o==null?void 0:o.constructor.name,result:o});else{this.logger.debug("BaseScene","createGameObjectFromConfig","Using factory manager fallback",{objectId:e.id,objectType:e.type});const c={id:e.id||"unknown",type:e.type||"container",scene:this,config:e};o=this.factoryManager.createGameObject(c),this.logger.debug("BaseScene","createGameObjectFromConfig","Factory manager fallback completed",{objectId:e.id,hasResult:!!o,resultType:o==null?void 0:o.constructor.name,result:o})}return o?(this.logger.debug("BaseScene","createGameObjectFromConfig","Game object created successfully, setting properties",{objectId:e.id,phaserObjectType:o.constructor.name,gameObjectName:o.name}),this.setGameObjectProperties(o,e),s&&s instanceof R.GameObjects.Container?(this.logger.debug("BaseScene","createGameObjectFromConfig","Adding game object to parent container",{objectId:e.id,parentId:s.name,objectType:o.constructor.name,isWrapperObject:!!o.phaserObject}),s.addChild&&typeof s.addChild=="function"?s.addChild(o):s.add(o)):(this.logger.debug("BaseScene","createGameObjectFromConfig","Adding game object to scene",{objectId:e.id}),this.add.existing(o)),this.logger.info("BaseScene","createGameObjectFromConfig","Game object fully created and added to scene",{objectId:e.id,phaserObjectType:o.constructor.name,gameObjectName:o.name,addedToScene:!0})):this.logger.error("BaseScene","createGameObjectFromConfig","Factory failed to create game object - returning null",{objectId:e.id,objectType:e.type,hasFactory:!!e.factory,factoryClassName:(a=e.factory)==null?void 0:a.className,factoryCreateMethod:(r=e.factory)==null?void 0:r.createMethod}),o}catch(o){return this.logger.error("BaseScene","createGameObjectFromConfig","Critical error creating game object from config: ${objConfig.id}",{error:o instanceof Error?o.message:String(o),stack:o instanceof Error?o.stack:void 0,objectId:e.id,objectType:e.type,factory:e.factory}),null}})}createGameObjectUsingStaticFactory(e,s){return l(this,null,function*(){var i,a;this.logger.debug("BaseScene","createGameObjectUsingStaticFactory","Using static factory method",{objectId:e.id,className:e.factory.className,createMethod:e.factory.createMethod});try{const{className:r,createMethod:o="createFromConfig"}=e.factory;this.logger.debug("BaseScene","createGameObjectUsingStaticFactory","Factory configuration parsed",{objectId:e.id,className:r,createMethod:o});const c=yield this.factoryManager.createGameObjectWithStaticFactory(e,this,s);return this.logger.debug("BaseScene","createGameObjectUsingStaticFactory","Static factory method completed",{objectId:e.id,hasResult:!!c,resultType:c==null?void 0:c.constructor.name,result:c?{name:c.name,type:c.constructor.name,visible:c.visible,active:c.active}:null}),c}catch(r){return this.logger.error("BaseScene","active","Critical error using static factory for ${objConfig.id}:",{error:r instanceof Error?r.message:String(r),stack:r instanceof Error?r.stack:void 0,objectId:e.id,className:(i=e.factory)==null?void 0:i.className,createMethod:(a=e.factory)==null?void 0:a.createMethod}),null}})}setGameObjectProperties(e,s){if(this.logger.debug("BaseScene","setGameObjectProperties","Setting game object properties",{objectId:s.id,hasSetPosition:"setPosition"in e,hasSetSize:"setSize"in e,config:{x:s.x,y:s.y,width:s.width,height:s.height,name:s.name}}),s.x!==void 0&&"setPosition"in e){let i=s.x,a=s.y||0;if(typeof a=="string"&&a==="fill"){const r=this.getParentContainer(e);r?(a=r.height,this.logger.debug("BaseScene","setGameObjectProperties","Resolved fill y position from parent",{objectId:s.id,parentHeight:r.height,resolvedY:a})):(a=this.game.config.height,this.logger.debug("BaseScene","setGameObjectProperties","Using scene height for fill y position",{objectId:s.id,sceneHeight:a}))}this.logger.debug("BaseScene","setGameObjectProperties","Setting position",{objectId:s.id,x:i,y:a}),e.setPosition(i,a)}s.width&&s.width!=="fill"&&"setSize"in e&&(this.logger.debug("BaseScene","setGameObjectProperties","Setting size",{objectId:s.id,width:s.width,height:s.height||s.width}),e.setSize(s.width,s.height||s.width)),e.name=s.name||s.id,this.logger.debug("BaseScene","setGameObjectProperties","Set game object name",{objectId:s.id,name:e.name}),s.zOrder!==void 0&&"setDepth"in e&&(this.logger.debug("BaseScene","setGameObjectProperties","Setting z-order",{objectId:s.id,zOrder:s.zOrder}),e.setDepth(s.zOrder))}setupResponsiveBehavior(){this.logger.debug("BaseScene","setupResponsiveBehavior","setupResponsiveBehavior","Setting up responsive behavior");const e=()=>{this.handleResize()};window.addEventListener("resize",e),this.scale.on("resize",e),this.sceneConfigs.responsive?this.logger.info("BaseScene","setupResponsiveBehavior","Responsive behavior setup completed with config",{scaleMode:this.game.scale.scaleMode,responsiveConfig:this.sceneConfigs.responsive}):this.logger.info("BaseScene","setupResponsiveBehavior","Responsive behavior setup completed (no config)",{scaleMode:this.game.scale.scaleMode})}handleResize(){try{const e=window.innerWidth,s=window.innerHeight;this.logger.debug("BaseScene","handleResize","Screen resize detected",{newDimensions:{width:e,height:s},gameObjectCount:this.gameObjects.size});const i=this.findRootContainer();i?(this.logger.debug("BaseScene","handleResize","Found root container, triggering resize",{rootContainerId:i.name||"unnamed",rootContainerType:i.constructor.name}),typeof i.resize=="function"?i.resize(e,s):this.logger.warn("BaseScene","handleResize","Root container does not have resize method",{rootContainerId:i.name||"unnamed",rootContainerType:i.constructor.name})):this.logger.warn("BaseScene","handleResize","handleResize","No root container found for resize propagation"),this.logger.info("BaseScene","handleResize","Screen resized",{newDimensions:{width:e,height:s},timestamp:Date.now()})}catch(e){this.logger.error("BaseScene","handleResize","Error handling resize",e)}}update(e,s){e%1e3<s&&this.logger.trace("BaseScene","update","Scene update",{time:e,delta:s,fps:Math.round(1e3/s),gameObjectCount:this.gameObjects.size})}shutdown(){return l(this,null,function*(){this.logger.debug("BaseScene","shutdown","Scene shutdown started",{gameObjectCount:this.gameObjects.size}),this.gameObjects.clear(),this.logger.info("BaseScene","shutdown","Scene shutdown",{timestamp:Date.now()}),yield this.logger.flushLogs()})}getGameObject(e){return this.gameObjects.get(e)}getAllGameObjects(){return this.gameObjects}hasGameObject(e){return this.gameObjects.has(e)}findRootContainer(){if(this.sceneConfigs.scene&&this.sceneConfigs.scene.gameObjects&&this.sceneConfigs.scene.gameObjects.length>0){const e=this.sceneConfigs.scene.gameObjects[0].id,s=this.gameObjects.get(e);if(s&&s instanceof R.GameObjects.Container)return this.logger.debug("BaseScene","findRootContainer","Found root container from scene config",{rootContainerId:s.name||e,rootContainerType:s.constructor.name}),s}for(const e of this.gameObjects.values())if(e instanceof R.GameObjects.Container&&!e.parent)return this.logger.debug("BaseScene","findRootContainer","Found root container by parent check",{rootContainerId:e.name||"unnamed",rootContainerType:e.constructor.name}),e;return this.logger.warn("BaseScene","findRootContainer","findRootContainer","No root container found"),null}getParentContainer(e){if(e.parent)return e.parent;for(const[s,i]of this.gameObjects)if(i instanceof R.GameObjects.Container&&(i.list||[]).includes(e))return i;return null}cacheResponsiveConfigs(){var e;this.logger.trace("BaseScene","cacheResponsiveConfigs","cacheResponsiveConfigs","Caching responsive configurations for performance");try{if(!this.sceneConfigs.responsive){this.logger.warn("BaseScene","cacheResponsiveConfigs","cacheResponsiveConfigs","No responsive config to cache");return}const s=this.sceneConfigs.responsive;s.default&&s.default.forEach(i=>{this.cachedResponsiveConfigs.set(`default-${i.id}`,i)}),Object.entries(s.responsiveSettings).forEach(([i,a])=>{a.forEach(r=>{this.cachedResponsiveConfigs.set(`${i}-${r.id}`,r)})}),this.logger.info("BaseScene","cacheResponsiveConfigs","Responsive configurations cached successfully",{totalCached:this.cachedResponsiveConfigs.size,breakpoints:Object.keys(s.responsiveSettings),defaultCount:((e=s.default)==null?void 0:e.length)||0})}catch(s){this.logger.error("BaseScene","cacheResponsiveConfigs","Error caching responsive configurations",s)}}getCachedResponsiveConfig(e,s="default"){const i=`${s}-${e}`;return this.cachedResponsiveConfigs.get(i)}getCurrentBreakpoint(e){return e<576?"xs":e<768?"sm":e<992?"md":e<1200?"lg":"xl"}getGameObjectConfigs(e){const s=this.game.config.width,i=this.getCurrentBreakpoint(s);return{responsive:this.sceneConfigs.responsive,theme:this.sceneConfigs.theme,currentBreakpoint:i}}activateTheme(e){return l(this,null,function*(){try{this.logger.info("BaseScene","activateTheme","Activating theme for scene",{sceneKey:this.scene.key,themeId:e});const s=yield this.themeActivator.activateThemeForScene(this.scene.key,e,{sceneKey:this.scene.key,elementType:U.SCENE,priority:1});s.success?this.logger.info("BaseScene","activateTheme","Theme activated successfully",{sceneKey:this.scene.key,themeId:e,appliedClasses:s.appliedClasses.length,duration:s.duration}):this.logger.error("BaseScene","activateTheme","Theme activation failed",{sceneKey:this.scene.key,themeId:e,errors:s.errors})}catch(s){throw this.logger.error("BaseScene","activateTheme","Theme activation error",{error:s,sceneKey:this.scene.key,themeId:e}),s}})}applyThemeToGameObject(e,s){return l(this,null,function*(){try{this.logger.debug("BaseScene","applyThemeToGameObject","Applying theme to game object",{sceneKey:this.scene.key,gameObjectType:e.constructor.name,themeId:s});const i=yield this.themeActivator.applyThemeToGameObject(e,s,{sceneKey:this.scene.key,gameObjectId:e.name||e.constructor.name,elementType:U.GAME_OBJECT,priority:2});i.success?this.logger.debug("BaseScene","applyThemeToGameObject","Theme applied to game object",{sceneKey:this.scene.key,gameObjectType:e.constructor.name,themeId:s,duration:i.duration}):this.logger.warn("BaseScene","applyThemeToGameObject","Theme application failed",{sceneKey:this.scene.key,gameObjectType:e.constructor.name,themeId:s,errors:i.errors})}catch(i){throw this.logger.error("BaseScene","applyThemeToGameObject","Theme application error",{error:i,sceneKey:this.scene.key,gameObjectType:e.constructor.name,themeId:s}),i}})}switchTheme(e){return l(this,null,function*(){try{this.logger.info("BaseScene","switchTheme","Switching theme for scene",{sceneKey:this.scene.key,newThemeId:e});const s=yield this.themeActivator.switchThemeForScene(this.scene.key,e,{sceneKey:this.scene.key,elementType:U.SCENE,priority:1});s.success?this.logger.info("BaseScene","switchTheme","Theme switched successfully",{sceneKey:this.scene.key,newThemeId:e,appliedClasses:s.appliedClasses.length,duration:s.duration}):this.logger.error("BaseScene","switchTheme","Theme switch failed",{sceneKey:this.scene.key,newThemeId:e,errors:s.errors})}catch(s){throw this.logger.error("BaseScene","switchTheme","Theme switch error",{error:s,sceneKey:this.scene.key,newThemeId:e}),s}})}getActiveTheme(){return this.themeActivator.getActiveThemeForScene(this.scene.key)}getAvailableThemes(){return this.themeActivator.getAvailableThemesForScene(this.scene.key)}isThemeActive(e){return this.themeActivator.isThemeActiveForScene(this.scene.key,e)}getAppliedThemeClasses(){return this.themeActivator.getAppliedClasses(this.scene.key)}}const dt={sceneId:"levis-2025-r3-wheel-scene-1",basePath:"/public/assets/levis2025r3wheel",assets:[{key:"levis2025r3wheel-desktop-bg",path:"/background/desktop_16x9.png",type:b.IMAGE,priority:y.CRITICAL,preload:!0,cache:!0,metadata:{responsive:"desktop",aspectRatio:"16:9",category:"background",description:"Desktop background image for Levis 2025 R3 Wheel"}},{key:"levis2025r3wheel-mobile-bg",path:"/background/mobile_16x9.png",type:b.IMAGE,priority:y.CRITICAL,preload:!0,cache:!0,metadata:{responsive:"mobile",aspectRatio:"16:9",category:"background",description:"Mobile background image for Levis 2025 R3 Wheel"}},{key:"levis2025r3wheel-mobile-origin-bg",path:"/background/mobile_origin.png",type:b.IMAGE,priority:y.LOW,preload:!1,cache:!0,metadata:{responsive:"mobile",aspectRatio:"original",category:"background",loadOnDemand:!0,description:"Original mobile background image (load on demand)"}},{key:"fortune-wheel-base",path:"/wheel/fortune_wheel_base.png",type:b.IMAGE,priority:y.CRITICAL,preload:!0,cache:!0,metadata:{category:"wheel",description:"Base wheel texture with segments",dimensions:{width:800,height:800},centerPoint:{x:400,y:400}}},{key:"fortune-wheel-pointer",path:"/wheel/wheel_pointer.png",type:b.IMAGE,priority:y.CRITICAL,preload:!0,cache:!0,metadata:{category:"wheel",description:"Wheel pointer/arrow indicator",dimensions:{width:100,height:150},anchorPoint:{x:.5,y:.9}}},{key:"fortune-wheel-center",path:"/wheel/wheel_center.png",type:b.IMAGE,priority:y.HIGH,preload:!0,cache:!0,metadata:{category:"wheel",description:"Center hub of the fortune wheel",dimensions:{width:120,height:120},centerPoint:{x:60,y:60}}},{key:"fortune-wheel-glow",path:"/wheel/wheel_glow_effect.png",type:b.IMAGE,priority:y.NORMAL,preload:!0,cache:!0,metadata:{category:"wheel",description:"Glow effect for wheel when spinning",dimensions:{width:900,height:900},blendMode:"add"}},{key:"spin-button",path:"/ui/spin_button.png",type:b.IMAGE,priority:y.HIGH,preload:!0,cache:!0,metadata:{category:"ui",description:"Main spin button",states:["normal","hover","pressed","disabled"]}},{key:"prize-popup-bg",path:"/ui/prize_popup_background.png",type:b.IMAGE,priority:y.HIGH,preload:!0,cache:!0,metadata:{category:"ui",description:"Background for prize popup modal",dimensions:{width:400,height:300}}},{key:"close-button",path:"/ui/close_button.png",type:b.IMAGE,priority:y.NORMAL,preload:!0,cache:!0,metadata:{category:"ui",description:"Close button for popups",states:["normal","hover"]}},{key:"wheel-spin-sfx",path:"/audio/wheel_spin.mp3",type:b.AUDIO,priority:y.HIGH,preload:!0,cache:!0,metadata:{category:"audio",description:"Wheel spinning sound effect",duration:3.5,loop:!0,volume:.7,audioType:"sfx"}},{key:"wheel-tick-sfx",path:"/audio/wheel_tick.mp3",type:b.AUDIO,priority:y.HIGH,preload:!0,cache:!0,metadata:{category:"audio",description:"Tick sound when pointer hits wheel segments",duration:.1,loop:!1,volume:.5,audioType:"sfx",triggerEvent:"segment-hit"}},{key:"wheel-stop-sfx",path:"/audio/wheel_stop.mp3",type:b.AUDIO,priority:y.HIGH,preload:!0,cache:!0,metadata:{category:"audio",description:"Sound when wheel stops spinning",duration:.8,loop:!1,volume:.6,audioType:"sfx",triggerEvent:"wheel-stop"}},{key:"prize-popup-sfx",path:"/audio/prize_popup.mp3",type:b.AUDIO,priority:y.HIGH,preload:!0,cache:!0,metadata:{category:"audio",description:"Sound when prize popup appears",duration:1.2,loop:!1,volume:.8,audioType:"sfx",triggerEvent:"prize-popup"}},{key:"big-win-sfx",path:"/audio/big_win.mp3",type:b.AUDIO,priority:y.HIGH,preload:!0,cache:!0,metadata:{category:"audio",description:"Sound for big prize wins",duration:2.5,loop:!1,volume:.9,audioType:"sfx",triggerEvent:"big-win",prizeThreshold:1e3}},{key:"small-win-sfx",path:"/audio/small_win.mp3",type:b.AUDIO,priority:y.HIGH,preload:!0,cache:!0,metadata:{category:"audio",description:"Sound for small prize wins",duration:1,loop:!1,volume:.7,audioType:"sfx",triggerEvent:"small-win",prizeThreshold:100}},{key:"button-click-sfx",path:"/audio/button_click.mp3",type:b.AUDIO,priority:y.NORMAL,preload:!0,cache:!0,metadata:{category:"audio",description:"Button click sound effect",duration:.3,loop:!1,volume:.6,audioType:"sfx",triggerEvent:"button-click"}},{key:"button-hover-sfx",path:"/audio/button_hover.mp3",type:b.AUDIO,priority:y.LOW,preload:!1,cache:!0,metadata:{category:"audio",description:"Button hover sound effect",duration:.2,loop:!1,volume:.4,audioType:"sfx",triggerEvent:"button-hover",loadOnDemand:!0}},{key:"background-music",path:"/audio/background_music.mp3",type:b.AUDIO,priority:y.LOW,preload:!1,cache:!0,metadata:{category:"audio",description:"Background music for the game",duration:120,loop:!0,volume:.3,audioType:"music",loadOnDemand:!0}}],bundles:[{bundleId:"background-bundle",bundleName:"Background Assets Bundle",bundleType:L.SCENE,priority:y.CRITICAL,preload:!0,cache:!0,assetKeys:["levis2025r3wheel-desktop-bg","levis2025r3wheel-mobile-bg","levis2025r3wheel-mobile-origin-bg"],metadata:{category:"background",responsive:!0,description:"Bundle containing all background assets for responsive loading"}},{bundleId:"wheel-bundle",bundleName:"Wheel Assets Bundle",bundleType:L.SCENE,priority:y.CRITICAL,preload:!0,cache:!0,assetKeys:["fortune-wheel-base","fortune-wheel-pointer","fortune-wheel-center","fortune-wheel-glow"],metadata:{category:"wheel",description:"Bundle containing all wheel-related visual assets"}},{bundleId:"ui-bundle",bundleName:"UI Assets Bundle",bundleType:L.SCENE,priority:y.HIGH,preload:!0,cache:!0,assetKeys:["spin-button","prize-popup-bg","close-button"],metadata:{category:"ui",description:"Bundle containing all UI elements"}},{bundleId:"audio-sfx-bundle",bundleName:"Sound Effects Bundle",bundleType:L.SCENE,priority:y.HIGH,preload:!0,cache:!0,assetKeys:["wheel-spin-sfx","wheel-tick-sfx","wheel-stop-sfx","prize-popup-sfx","big-win-sfx","small-win-sfx","button-click-sfx","button-hover-sfx"],metadata:{category:"audio",audioType:"sfx",description:"Bundle containing all sound effects"}},{bundleId:"audio-music-bundle",bundleName:"Background Music Bundle",bundleType:L.SCENE,priority:y.LOW,preload:!1,cache:!0,assetKeys:["background-music"],metadata:{category:"audio",audioType:"music",description:"Bundle containing background music (load on demand)",loadOnDemand:!0}}],loading:{preload:!0,priority:[y.CRITICAL,y.HIGH,y.NORMAL,y.LOW,y.BACKGROUND],strategy:ke.PRIORITY_BASED},validation:{required:["levis2025r3wheel-desktop-bg","levis2025r3wheel-mobile-bg","fortune-wheel-base","fortune-wheel-pointer","fortune-wheel-center","spin-button","wheel-spin-sfx","wheel-tick-sfx","wheel-stop-sfx"],optional:["levis2025r3wheel-mobile-origin-bg","fortune-wheel-glow","prize-popup-bg","close-button","prize-popup-sfx","big-win-sfx","small-win-sfx","button-click-sfx","button-hover-sfx","background-music"],fallbacks:{"levis2025r3wheel-desktop-bg":"levis2025r3wheel-mobile-bg","levis2025r3wheel-mobile-bg":"levis2025r3wheel-desktop-bg","fortune-wheel-glow":"fortune-wheel-base","prize-popup-bg":"spin-button","big-win-sfx":"small-win-sfx","small-win-sfx":"prize-popup-sfx","button-hover-sfx":"button-click-sfx"}},responsive:{breakpoints:{desktop:{assets:["levis2025r3wheel-desktop-bg","fortune-wheel-base","fortune-wheel-pointer","fortune-wheel-center","fortune-wheel-glow","spin-button","prize-popup-bg","close-button"],bundles:["background-bundle","wheel-bundle","ui-bundle","audio-sfx-bundle"]},mobile:{assets:["levis2025r3wheel-mobile-bg","levis2025r3wheel-mobile-origin-bg","fortune-wheel-base","fortune-wheel-pointer","fortune-wheel-center","fortune-wheel-glow","spin-button","prize-popup-bg","close-button"],bundles:["background-bundle","wheel-bundle","ui-bundle","audio-sfx-bundle"]},tablet:{assets:["levis2025r3wheel-desktop-bg","fortune-wheel-base","fortune-wheel-pointer","fortune-wheel-center","fortune-wheel-glow","spin-button","prize-popup-bg","close-button"],bundles:["background-bundle","wheel-bundle","ui-bundle","audio-sfx-bundle"]}},defaultBreakpoint:"desktop"},metadata:{gameTitle:"Levis 2025 R3 Wheel",sceneName:"Scene 1",version:"1.0.0",createdDate:new Date().toISOString(),lastModified:new Date().toISOString(),description:"Complete fortune wheel game scene with wheel textures, sound effects, and UI elements",tags:["levis","r3-wheel","scene-1","responsive","background","wheel","audio","ui","fortune-wheel","sound-effects"],estimatedLoadTime:5e3,responsiveSupport:!0,preloadStrategy:"critical-first",author:"Game Development Team",license:"Proprietary",assetCount:{total:20,images:11,audio:9,bundles:5},features:["Responsive background loading","Wheel texture management","Sound effect system","UI element management","Priority-based loading","Fallback system","Bundle optimization"]}},Re={default:[{id:"root-container",breakpointCondition:{minWidth:0,maxWidth:void 0},layoutProperties:{maintainAspectRatio:!1,scaleStrategy:"stretch",alignment:"center",positionX:0,positionY:0,width:"fill",height:"fill",zOrder:0,backgroundColor:"#1a1a2e",interactive:!1,classes:["container-autumn","root-container"]}},{id:"background-container",breakpointCondition:{minWidth:0,maxWidth:void 0},layoutProperties:{maintainAspectRatio:!1,scaleStrategy:"stretch",alignment:"center",positionX:0,positionY:0,width:"auto",height:"auto",zOrder:-100,backgroundColor:"#ffffff",backgroundImage:"levis2025r3wheel-desktop-bg",classes:["background-autumn"]}},{id:"footer-container",breakpointCondition:{minWidth:0,maxWidth:void 0},layoutProperties:{maintainAspectRatio:!1,scaleStrategy:"stretch",alignment:"bottom-left",positionX:0,positionY:"bottom",width:"auto",height:80,zOrder:30,backgroundColor:"#ffffff",interactive:!1,classes:["footer-autumn"]}},{id:"footer-rectangle",breakpointCondition:{minWidth:0,maxWidth:void 0},layoutProperties:{maintainAspectRatio:!1,scaleStrategy:"stretch",alignment:"bottom-left",positionX:0,positionY:0,width:"auto",height:"auto",zOrder:40,backgroundColor:"#ffffff",interactive:!1,classes:["footer-autumn"]}}],responsiveSettings:{xs:[{id:"root-container",breakpointCondition:{minWidth:0,maxWidth:575},layoutProperties:{maintainAspectRatio:!1,scaleStrategy:"stretch",alignment:"center",positionX:0,positionY:0,width:"fill",height:"fill",zOrder:0,backgroundColor:"#2a2a3e",interactive:!1,classes:["container-autumn","root-container","mobile-root"]}},{id:"background-container",breakpointCondition:{minWidth:0,maxWidth:575},layoutProperties:{maintainAspectRatio:!1,scaleStrategy:"stretch",alignment:"center",backgroundImage:"levis2025r3wheel-mobile-bg",classes:["background-autumn","mobile-background"]}},{id:"footer-container",breakpointCondition:{minWidth:0,maxWidth:575},layoutProperties:{maintainAspectRatio:!1,scaleStrategy:"stretch",alignment:"bottom-left",height:60,padding:10,classes:["footer-autumn","mobile-footer"]}},{id:"footer-rectangle",breakpointCondition:{minWidth:0,maxWidth:575},layoutProperties:{maintainAspectRatio:!1,scaleStrategy:"stretch",alignment:"bottom-left",height:60,padding:10,classes:["footer-autumn","mobile-footer"]}}],sm:[{id:"root-container",breakpointCondition:{minWidth:576,maxWidth:767},layoutProperties:{maintainAspectRatio:!1,scaleStrategy:"stretch",alignment:"center",positionX:0,positionY:0,width:"fill",height:"fill",zOrder:0,backgroundColor:"#3a3a4e",interactive:!1,classes:["container-autumn","root-container","small-root"]}},{id:"background-container",breakpointCondition:{minWidth:576,maxWidth:767},layoutProperties:{maintainAspectRatio:!1,scaleStrategy:"stretch",alignment:"center",backgroundImage:"levis2025r3wheel-mobile-bg",classes:["background-autumn","mobile-background"]}},{id:"footer-container",breakpointCondition:{minWidth:576,maxWidth:767},layoutProperties:{maintainAspectRatio:!1,scaleStrategy:"stretch",alignment:"bottom-left",height:65,padding:12,classes:["footer-autumn","mobile-footer"]}},{id:"footer-rectangle",breakpointCondition:{minWidth:576,maxWidth:767},layoutProperties:{maintainAspectRatio:!1,scaleStrategy:"stretch",alignment:"bottom-left",height:65,padding:12,classes:["footer-autumn","mobile-footer"]}}],md:[{id:"root-container",breakpointCondition:{minWidth:768,maxWidth:991},layoutProperties:{maintainAspectRatio:!1,scaleStrategy:"stretch",alignment:"center",positionX:0,positionY:0,width:"fill",height:"fill",zOrder:0,backgroundColor:"#4a4a5e",interactive:!1,classes:["container-autumn","root-container","tablet-root"]}},{id:"background-container",breakpointCondition:{minWidth:768,maxWidth:991},layoutProperties:{maintainAspectRatio:!0,scaleStrategy:"fit",alignment:"center",backgroundImage:"levis2025r3wheel-mobile-bg",classes:["background-autumn","tablet-background"]}},{id:"footer-container",breakpointCondition:{minWidth:768,maxWidth:991},layoutProperties:{maintainAspectRatio:!1,scaleStrategy:"stretch",alignment:"bottom-left",height:70,padding:15,classes:["footer-autumn","tablet-footer"]}},{id:"footer-rectangle",breakpointCondition:{minWidth:768,maxWidth:991},layoutProperties:{maintainAspectRatio:!1,scaleStrategy:"stretch",alignment:"bottom-left",height:70,padding:15,classes:["footer-autumn","tablet-footer"]}}],lg:[{id:"root-container",breakpointCondition:{minWidth:992,maxWidth:1199},layoutProperties:{maintainAspectRatio:!1,scaleStrategy:"stretch",alignment:"center",positionX:0,positionY:0,width:"fill",height:"fill",zOrder:0,backgroundColor:"#5a5a6e",interactive:!1,classes:["container-autumn","root-container","large-root"]}},{id:"background-container",breakpointCondition:{minWidth:992,maxWidth:1199},layoutProperties:{maintainAspectRatio:!0,scaleStrategy:"fit",alignment:"center",backgroundImage:"levis2025r3wheel-desktop-bg"}},{id:"footer-container",breakpointCondition:{minWidth:992,maxWidth:1199},layoutProperties:{maintainAspectRatio:!1,scaleStrategy:"stretch",alignment:"bottom-left",height:80,padding:20}},{id:"footer-rectangle",breakpointCondition:{minWidth:992,maxWidth:1199},layoutProperties:{maintainAspectRatio:!1,scaleStrategy:"stretch",alignment:"bottom-left",height:80,padding:20}}],xl:[{id:"root-container",breakpointCondition:{minWidth:1200,maxWidth:void 0},layoutProperties:{maintainAspectRatio:!1,scaleStrategy:"stretch",alignment:"center",positionX:0,positionY:0,width:"fill",height:"fill",zOrder:0,backgroundColor:"#6a6a7e",interactive:!1,classes:["container-autumn","root-container","xl-root"]}},{id:"background-container",breakpointCondition:{minWidth:1200,maxWidth:void 0},layoutProperties:{maintainAspectRatio:!0,scaleStrategy:"fit",alignment:"center",backgroundImage:"levis2025r3wheel-desktop-bg"}},{id:"footer-container",breakpointCondition:{minWidth:1200,maxWidth:void 0},layoutProperties:{maintainAspectRatio:!1,scaleStrategy:"stretch",alignment:"bottom-left",height:80,padding:20}},{id:"footer-rectangle",breakpointCondition:{minWidth:1200,maxWidth:void 0},layoutProperties:{maintainAspectRatio:!1,scaleStrategy:"stretch",alignment:"bottom-left",height:80,padding:20}}]}},ct={sceneId:"levis2025r3wheel",sceneName:"Levis 2025 R3 Wheel Scene",version:"1.0.0",backgroundColor:"#000000",responsive:Re,gameObjects:[{id:"root-container",type:Te.CONTAINER,name:"Root Container",factory:{className:"Container",createMethod:"createFromConfig"},properties:{interactive:!1},children:[],parentId:void 0}],assetLoading:{preload:!0,priority:["background","ui","audio","effects"]}},lt=()=>({id:"levis2025R3-logging-config",name:"Levis2025R3 Logging Configuration",version:"1.0.0",isActive:!0,lastModified:new Date,metadata:{scene:"levis2025R3",environment:"development"},globalLevel:"debug",objects:[{name:"Logger",level:"debug",enabled:!0,includePerformance:!0,includeStackTrace:!0},{name:"LoggingConfigLoader",level:"debug",enabled:!0,includePerformance:!0,includeStackTrace:!0},{name:"LogServerClient",level:"debug",enabled:!0,includePerformance:!0,includeStackTrace:!0},{name:"HttpClient",level:"debug",enabled:!0,includePerformance:!0,includeStackTrace:!1},{name:"ErrorTracker",level:"debug",enabled:!0,includePerformance:!0,includeStackTrace:!0},{name:"Game",level:"debug",enabled:!0,includePerformance:!0,includeStackTrace:!0},{name:"Levis2025R3WheelScene",level:"debug",enabled:!0,includePerformance:!0,includeStackTrace:!0},{name:"IConfiguration",level:"debug",enabled:!0,includePerformance:!1,includeStackTrace:!1},{name:"IGameObject",level:"debug",enabled:!0,includePerformance:!1,includeStackTrace:!1},{name:"IHttpClient",level:"debug",enabled:!0,includePerformance:!1,includeStackTrace:!1},{name:"IWebhookClient",level:"debug",enabled:!0,includePerformance:!1,includeStackTrace:!1},{name:"LoggerConfig",level:"debug",enabled:!0,includePerformance:!1,includeStackTrace:!1},{name:"BackendConfig",level:"debug",enabled:!0,includePerformance:!1,includeStackTrace:!1},{name:"Main",level:"debug",enabled:!0,includePerformance:!1,includeStackTrace:!0},{name:"App",level:"debug",enabled:!0,includePerformance:!1,includeStackTrace:!0},{name:"Performance",level:"debug",enabled:!0,includePerformance:!0,includeStackTrace:!1},{name:"GameEvent",level:"debug",enabled:!0,includePerformance:!1,includeStackTrace:!1},{name:"GlobalError",level:"error",enabled:!0,includePerformance:!1,includeStackTrace:!0},{name:"UnhandledRejection",level:"error",enabled:!0,includePerformance:!1,includeStackTrace:!0}],server:{enabled:!0,endpoint:"",apiKey:void 0,batchSize:10,retryAttempts:1,retryDelay:3e3,timeout:1e4,sendErrorsImmediately:!0,sendGameEventsImmediately:!0,includePerformanceData:!0,includeUserAgent:!0,includeSessionData:!0},console:{enabled:!0,colors:!0,showData:!0,showStackTrace:!0,maxDataDepth:3},formatOptions:{showTimestamp:!0,showLogLevel:!0,showObjectName:!0,useJsonStringify:!0,maxMessageLength:200},performance:{enabled:!0,fpsThreshold:30,memoryThreshold:80,networkMonitoring:!0,customMetrics:["renderTime","updateTime"]},buffering:{enabled:!0,maxBufferSize:50,flushInterval:5e3,persistOnUnload:!0},errorTracking:{enabled:!0,includeStackTrace:!0,trackUnhandledErrors:!0,trackPromiseRejections:!0,maxErrorHistory:100},session:{enabled:!0,generateSessionId:!0,includeUserInfo:!0,trackPageViews:!0},validate(){const t=[];return this.id||t.push("ID is required"),this.name||t.push("Name is required"),this.version||t.push("Version is required"),t},clone(t){return m(m({},this),t)},toJSON(){return JSON.stringify(this)},fromJSON(t){return JSON.parse(t)},isValid(){return this.validate().length===0},getSummary(){return{id:this.id,name:this.name,version:this.version,isActive:this.isActive,lastModified:this.lastModified,isValid:this.isValid(),validationErrors:this.validate(),metadataKeys:Object.keys(this.metadata)}}}),ht=lt();var _=(n=>(n.DEFAULT="default",n.POINTER="pointer",n.HAND="hand",n.TEXT="text",n.MOVE="move",n.NOT_ALLOWED="not-allowed",n.WAIT="wait",n.CROSSHAIR="crosshair",n.GRAB="grab",n.GRABBING="grabbing",n))(_||{}),$=(n=>(n.ROW="row",n.ROW_REVERSE="row-reverse",n.COLUMN="column",n.COLUMN_REVERSE="column-reverse",n))($||{}),je=(n=>(n.NOWRAP="nowrap",n.WRAP="wrap",n.WRAP_REVERSE="wrap-reverse",n))(je||{}),M=(n=>(n.FLEX_START="flex-start",n.FLEX_END="flex-end",n.CENTER="center",n.SPACE_BETWEEN="space-between",n.SPACE_AROUND="space-around",n.SPACE_EVENLY="space-evenly",n))(M||{}),P=(n=>(n.STRETCH="stretch",n.FLEX_START="flex-start",n.FLEX_END="flex-end",n.CENTER="center",n.BASELINE="baseline",n))(P||{}),fe=(n=>(n.VISIBLE="visible",n.HIDDEN="hidden",n.COLLAPSE="collapse",n))(fe||{}),Me=(n=>(n.NORMAL="normal",n.BREAK_ALL="break-all",n.KEEP_ALL="keep-all",n.BREAK_WORD="break-word",n))(Me||{}),Pe=(n=>(n.NORMAL="normal",n.BREAK_WORD="break-word",n.ANYWHERE="anywhere",n))(Pe||{}),q=(n=>(n.CONTENT_BOX="content-box",n.BORDER_BOX="border-box",n))(q||{});const gt={id:"fortune-wheel-theme",name:"fortune-wheel",displayName:"Fortune Wheel Theme",description:"Vibrant theme designed for fortune wheel games with bright colors and engaging animations",type:O.CUSTOM,variant:Fe.PRIMARY,isActive:!0,supportsDarkMode:!1,oppositeTheme:void 0,version:"1.0.0",author:"Fortune Wheel Game Team",tags:["game","fortune-wheel","vibrant","engaging","casino-style"],colors:{primary:{main:"#ff6b35",light:"#ff8c69",dark:"#e55a2b",contrast:"#ffffff",variants:{50:"#fff7ed",100:"#ffedd5",200:"#fed7aa",300:"#fdba74",400:"#fb923c",500:"#ff6b35",600:"#ea580c",700:"#c2410c",800:"#9a3412",900:"#7c2d12"}},secondary:{main:"#3b82f6",light:"#60a5fa",dark:"#2563eb",contrast:"#ffffff",variants:{50:"#eff6ff",100:"#dbeafe",200:"#bfdbfe",300:"#93c5fd",400:"#60a5fa",500:"#3b82f6",600:"#2563eb",700:"#1d4ed8",800:"#1e40af",900:"#1e3a8a"}},background:{primary:"#fef3c7",secondary:"#fde68a",tertiary:"#fbbf24",overlay:"rgba(0, 0, 0, 0.7)",variants:{"game-bg":"#1a1a2e","wheel-bg":"#2a2a3e","modal-bg":"rgba(255, 255, 255, 0.95)","card-bg":"#ffffff"}},text:{primary:"#1f2937",secondary:"#6b7280",disabled:"#9ca3af",inverse:"#ffffff",variants:{accent:"#ff6b35",success:"#10b981",warning:"#f59e0b",error:"#ef4444"}},status:{success:"#10b981",warning:"#f59e0b",error:"#ef4444",info:"#3b82f6",variants:{"big-win":"#fbbf24","small-win":"#10b981",lose:"#ef4444",jackpot:"#ff6b35"}},ui:{border:"#d1d5db",shadow:"rgba(0, 0, 0, 0.1)",highlight:"#fbbf24",disabled:"#e5e7eb",variants:{"wheel-border":"#ff6b35","button-border":"#3b82f6","modal-border":"#d1d5db","card-border":"#e5e7eb"}},semantic:{brand:{"levis-primary":"#ff6b35","levis-secondary":"#3b82f6","levis-accent":"#fbbf24"},functional:{"spin-button":"#ff6b35","stop-button":"#ef4444","reset-button":"#6b7280","settings-button":"#3b82f6"},state:{spinning:"#fbbf24",stopped:"#10b981",disabled:"#9ca3af",hover:"#ff8c69",active:"#e55a2b"},custom:{"wheel-segment-1":"#ff6b35","wheel-segment-2":"#3b82f6","wheel-segment-3":"#10b981","wheel-segment-4":"#f59e0b","wheel-segment-5":"#ef4444","wheel-segment-6":"#8b5cf6","wheel-segment-7":"#06b6d4","wheel-segment-8":"#84cc16","wheel-segment-9":"#f97316","wheel-segment-10":"#ec4899","wheel-segment-11":"#14b8a6","wheel-segment-12":"#f43f5e"}},custom:{"pointer-color":"#ff6b35","pointer-shadow":"rgba(255, 107, 53, 0.3)","wheel-glow":"rgba(251, 191, 36, 0.5)","prize-glow":"rgba(16, 185, 129, 0.3)","jackpot-glow":"rgba(255, 107, 53, 0.6)"}},typography:{fontFamily:{primary:"Inter, system-ui, -apple-system, sans-serif",secondary:"Poppins, sans-serif",monospace:"JetBrains Mono, monospace",display:"Poppins, sans-serif",variants:{"game-title":"Poppins, sans-serif","button-text":"Inter, sans-serif","prize-text":"Poppins, sans-serif"}},fontSize:{xs:12,sm:14,base:16,lg:18,xl:20,"2xl":24,"3xl":30,display:48,variants:{"game-title":36,"prize-amount":28,"button-text":16,"small-text":12}},fontWeight:{light:300,normal:400,medium:500,semibold:600,bold:700,extrabold:800,variants:{"game-title":700,"prize-amount":600,"button-text":500}},lineHeight:{tight:1.25,normal:1.5,relaxed:1.75,loose:2,variants:{"game-title":1.2,"prize-text":1.3,"button-text":1.4}},letterSpacing:{tight:-.025,normal:0,wide:.025,variants:{"game-title":.05,"prize-amount":.02}},textAlign:{left:"left",center:"center",right:"right",justify:"justify"},custom:{"text-shadow":"0 2px 4px rgba(0, 0, 0, 0.1)","text-glow":"0 0 10px rgba(255, 107, 53, 0.5)"}},spacing:{base:16,scale:{xs:4,sm:8,md:16,lg:24,xl:32,"2xl":48,"3xl":64,variants:{"wheel-padding":20,"button-padding":12,"modal-padding":24,"card-padding":16}},custom:{"wheel-radius":400,"pointer-offset":50,"button-spacing":16}},borderRadius:{none:0,sm:4,base:8,lg:12,xl:16,full:9999,variants:{wheel:9999,button:8,modal:12,card:8,"prize-badge":20}},shadows:{sm:"0 1px 2px 0 rgba(0, 0, 0, 0.05)",base:"0 2px 4px rgba(0, 0, 0, 0.1)",md:"0 4px 6px -1px rgba(0, 0, 0, 0.1)",lg:"0 10px 15px -3px rgba(0, 0, 0, 0.1)",xl:"0 20px 25px -5px rgba(0, 0, 0, 0.1)","2xl":"0 25px 50px -12px rgba(0, 0, 0, 0.25)",variants:{"wheel-shadow":"0 10px 30px rgba(0, 0, 0, 0.3)","button-shadow":"0 4px 12px rgba(255, 107, 53, 0.3)","modal-shadow":"0 20px 40px rgba(0, 0, 0, 0.4)","prize-glow":"0 0 20px rgba(16, 185, 129, 0.5)","jackpot-glow":"0 0 30px rgba(255, 107, 53, 0.7)"}},animation:{duration:{fast:150,normal:300,slow:500,verySlow:1e3,variants:{"wheel-spin":3e3,"wheel-slow":2e3,"button-hover":200,"modal-fade":300,"prize-popup":500}},easing:{linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",variants:{"wheel-spin":"cubic-bezier(0.25, 0.46, 0.45, 0.94)","button-bounce":"cubic-bezier(0.68, -0.55, 0.265, 1.55)","modal-slide":"cubic-bezier(0.25, 0.46, 0.45, 0.94)"}},properties:{all:"all",opacity:"opacity",transform:"transform",color:"color",background:"background",variants:{"wheel-rotation":"transform","button-scale":"transform","modal-fade":"opacity","prize-glow":"box-shadow"}},custom:{"spin-keyframes":"spin 3s cubic-bezier(0.25, 0.46, 0.45, 0.94)","bounce-keyframes":"bounce 0.5s ease-in-out","glow-keyframes":"glow 2s ease-in-out infinite alternate"}},breakpoints:{xs:0,sm:640,md:768,lg:1024,xl:1280,"2xl":1536,variants:{mobile:480,tablet:768,desktop:1024,"large-desktop":1440}},themeClasses:{".game-container":{backgroundColor:"#1a1a2e",color:"#ffffff",padding:20,borderRadiusValue:0,boxShadow:"0 0 0 rgba(0, 0, 0, 0)",display:j.FLEX,flexDirection:$.COLUMN,alignItems:P.CENTER,justifyContent:M.CENTER,minHeight:"100vh",boxSizing:q.BORDER_BOX},".wheel-container":{backgroundColor:"#2a2a3e",borderRadiusValue:9999,padding:20,boxShadow:"0 10px 30px rgba(0, 0, 0, 0.3)",width:{value:800,unit:I.PIXEL},height:{value:800,unit:I.PIXEL},display:j.FLEX,alignItems:P.CENTER,justifyContent:M.CENTER,position:ue.RELATIVE,boxSizing:q.BORDER_BOX},".wheel-base":{backgroundColor:"transparent",borderRadiusValue:9999,width:{value:760,unit:I.PIXEL},height:{value:760,unit:I.PIXEL}},".wheel-pointer":{backgroundColor:"#ff6b35",borderRadiusValue:4,width:{value:100,unit:I.PIXEL},height:{value:150,unit:I.PIXEL},boxShadow:"0 4px 12px rgba(255, 107, 53, 0.3)"},".wheel-center":{backgroundColor:"#fbbf24",borderRadiusValue:9999,width:{value:120,unit:I.PIXEL},height:{value:120,unit:I.PIXEL},boxShadow:"0 4px 12px rgba(251, 191, 36, 0.3)"},".spin-button":{backgroundColor:"#ff6b35",color:"#ffffff",padding:16,borderRadiusValue:8,fontWeight:600,fontSize:18,boxShadow:"0 4px 12px rgba(255, 107, 53, 0.3)",width:{value:200,unit:I.PIXEL},height:{value:60,unit:I.PIXEL},display:j.FLEX,alignItems:P.CENTER,justifyContent:M.CENTER,cursor:_.POINTER,border:"none",boxSizing:q.BORDER_BOX,transition:"all 0.3s ease"},".spin-button:hover":{backgroundColor:"#ff8c69",boxShadow:"0 6px 16px rgba(255, 107, 53, 0.4)",transform:"scale(1.05)",cursor:_.POINTER},".spin-button:active":{backgroundColor:"#e55a2b",transform:"scale(0.95)"},".spin-button:disabled":{backgroundColor:"#9ca3af",color:"#6b7280",cursor:_.NOT_ALLOWED},".prize-modal":{backgroundColor:"rgba(255, 255, 255, 0.95)",color:"#1f2937",padding:32,borderRadiusValue:12,boxShadow:"0 20px 40px rgba(0, 0, 0, 0.4)",width:{value:400,unit:I.PIXEL},height:{value:300,unit:I.PIXEL},display:j.FLEX,flexDirection:$.COLUMN,alignItems:P.CENTER,justifyContent:M.CENTER,position:ue.RELATIVE,boxSizing:q.BORDER_BOX,backdropFilter:"blur(10px)"},".prize-modal-header":{color:"#ff6b35",fontSize:24,fontWeight:700,textAlign:H.CENTER},".prize-modal-content":{color:"#1f2937",fontSize:18,marginTop:16,textAlign:H.CENTER},".prize-amount":{color:"#10b981",fontSize:28,fontWeight:600,textAlign:H.CENTER},".jackpot-amount":{color:"#ff6b35",fontSize:32,fontWeight:700,textAlign:H.CENTER},".close-button":{backgroundColor:"#ef4444",color:"#ffffff",borderRadiusValue:9999,width:{value:40,unit:I.PIXEL},height:{value:40,unit:I.PIXEL},fontSize:20,fontWeight:600,boxShadow:"0 2px 8px rgba(239, 68, 68, 0.3)"},".close-button:hover":{backgroundColor:"#dc2626",transform:"scale(1.1)",cursor:_.POINTER},".prize-badge":{backgroundColor:"#10b981",color:"#ffffff",padding:8,borderRadiusValue:20,fontSize:14,fontWeight:600,textAlign:H.CENTER},".prize-badge.big-win":{backgroundColor:"#fbbf24",color:"#1f2937",boxShadow:"0 0 20px rgba(251, 191, 36, 0.5)"},".prize-badge.jackpot":{backgroundColor:"#ff6b35",color:"#ffffff",boxShadow:"0 0 30px rgba(255, 107, 53, 0.7)"},".mobile-wheel":{width:{value:600,unit:I.PIXEL},height:{value:600,unit:I.PIXEL}},".tablet-wheel":{width:{value:700,unit:I.PIXEL},height:{value:700,unit:I.PIXEL}},".desktop-wheel":{width:{value:800,unit:I.PIXEL},height:{value:800,unit:I.PIXEL}},".button-container":{display:j.FLEX,flexDirection:$.ROW,alignItems:P.CENTER,justifyContent:M.CENTER,gap:16,marginTop:32,flexWrap:je.WRAP},".control-panel":{display:j.FLEX,flexDirection:$.COLUMN,alignItems:P.CENTER,justifyContent:M.CENTER,gap:16,padding:24,backgroundColor:"rgba(42, 42, 62, 0.8)",borderRadiusValue:12,backdropFilter:"blur(10px)",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.3)"},".score-display":{display:j.FLEX,flexDirection:$.COLUMN,alignItems:P.CENTER,justifyContent:M.CENTER,gap:8,padding:16,backgroundColor:"rgba(255, 107, 53, 0.1)",borderRadiusValue:8,border:"2px solid rgba(255, 107, 53, 0.3)",minWidth:120},".loading-spinner":{display:j.FLEX,alignItems:P.CENTER,justifyContent:M.CENTER,width:{value:40,unit:I.PIXEL},height:{value:40,unit:I.PIXEL},border:"4px solid rgba(255, 107, 53, 0.3)",borderTop:"4px solid #ff6b35",borderRadiusValue:9999,cssAnimation:"spin 1s linear infinite"},".hidden":{visibility:fe.HIDDEN,opacity:0,transition:"opacity 0.3s ease, visibility 0.3s ease"},".visible":{visibility:fe.VISIBLE,opacity:1,transition:"opacity 0.3s ease, visibility 0.3s ease"},".text-ellipsis":{whiteSpace:Ee.NOWRAP,overflow:Be.HIDDEN,textOverflow:Oe.ELLIPSIS},".text-break":{wordBreak:Me.BREAK_WORD,overflowWrap:Pe.BREAK_WORD}},custom:{"wheel-segments":12,"wheel-colors":["#ff6b35","#3b82f6","#10b981","#f59e0b","#ef4444","#8b5cf6","#06b6d4","#84cc16","#f97316","#ec4899","#14b8a6","#f43f5e"],"prize-values":[100,200,500,1e3,2e3,5e3,1e4,25e3,5e4,1e5,25e4,1e6],"animation-speeds":{fast:1e3,normal:3e3,slow:5e3},"sound-effects":{spin:"wheel_spin.mp3",tick:"wheel_tick.mp3",stop:"wheel_stop.mp3",win:"prize_popup.mp3","big-win":"big_win.mp3",jackpot:"jackpot.mp3"}},metadata:{createdAt:new Date("2024-01-01"),modifiedAt:new Date,author:"Fortune Wheel Game Team",version:"1.0.0",tags:["game","fortune-wheel","vibrant","engaging","casino-style"],custom:{"game-type":"fortune-wheel","target-audience":"casual-gamers","color-scheme":"vibrant","animation-style":"engaging"}},getColor(n){return{"primary.main":this.colors.primary.main,"primary.light":this.colors.primary.light,"primary.dark":this.colors.primary.dark,"secondary.main":this.colors.secondary.main,"background.primary":this.colors.background.primary,"text.primary":this.colors.text.primary,"status.success":this.colors.status.success,"status.warning":this.colors.status.warning,"status.error":this.colors.status.error,"ui.border":this.colors.ui.border,"ui.highlight":this.colors.ui.highlight}[n]||"#000000"},getSpacing(n){const t=this.spacing.scale[n];return typeof t=="number"?t:0},getFontSize(n){const t=this.typography.fontSize[n];return typeof t=="number"?t:16},getBorderRadius(n){const t=this.borderRadius[n];return typeof t=="number"?t:0},getShadow(n){const t=this.shadows[n];return typeof t=="string"?t:"none"},getAnimationDuration(n){const t=this.animation.duration[n];return typeof t=="number"?t:300},supportsBreakpoint(n){return n in this.breakpoints},getOppositeTheme(){return null},clone(){return JSON.parse(JSON.stringify(this))},merge(n){return m(m({},this),n)}};class te extends ot{constructor(){super("Levis2025R3WheelScene")}registerSceneConfigs(){this.configManager.registerSceneConfigs("levis2025r3wheel",ht,Re,ct,dt,gt)}getSceneName(){return"levis2025r3wheel"}preload(){super.preload(),this.logger.info("Levis2025R3WheelScene","preload","Asset loading handled by BaseScene through ConfigManager")}create(){return l(this,null,function*(){this.logger.info("Levis2025R3WheelScene","create","Starting scene creation");try{yield ne(te.prototype,this,"create").call(this),this.addSceneSpecificElements(),yield this.activateSceneTheme(),this.logger.info("Levis2025R3WheelScene","create","Scene creation completed")}catch(t){throw this.logger.error("Levis2025R3WheelScene","create","Failed to create scene",{error:t}),t}})}addSceneSpecificElements(){try{this.add.text(this.scale.width/2,50,"Levis 2025 R3 Wheel - Scene 1",{fontSize:"32px",color:"#ffffff",fontFamily:"Arial"}).setOrigin(.5,0),this.add.text(this.scale.width/2,this.scale.height-50,"Scene Created with ConfigManager",{fontSize:"16px",color:"#ffffff",fontFamily:"Arial"}).setOrigin(.5,1),this.logger.info("Levis2025R3WheelScene","addSceneSpecificElements","Scene-specific elements added")}catch(t){this.logger.error("Levis2025R3WheelScene","addSceneSpecificElements","Failed to add scene-specific elements",{error:t})}}activateSceneTheme(){return l(this,null,function*(){try{this.logger.info("Levis2025R3WheelScene","activateSceneTheme","Activating scene theme");const t=this.sceneConfigs.theme;t&&t.id?(yield this.activateTheme(t.id),this.logger.info("Levis2025R3WheelScene","activateSceneTheme","Scene theme activated successfully",{themeId:t.id,themeName:t.name})):this.logger.warn("Levis2025R3WheelScene","activateSceneTheme","No theme found in scene configs")}catch(t){this.logger.error("Levis2025R3WheelScene","activateSceneTheme","Failed to activate scene theme",{error:t})}})}shutdown(){return l(this,null,function*(){this.logger.info("Levis2025R3WheelScene","shutdown","Scene shutting down"),yield ne(te.prototype,this,"shutdown").call(this)})}}class ut{constructor(){d(this,"baseGame");h.debug("Game","constructor","Initializing minimal game with asset system");const t={gameId:"levis-2025-r3-wheel-game",phaserConfig:{backgroundColor:"#1a1a2e",physics:{default:"arcade",arcade:{gravity:{x:0,y:0},debug:!1}}}};this.baseGame=new Xe(t);const e=new te;this.baseGame.addScene(e),h.info("Game","constructor","Game initialized successfully",{sceneKey:"Levis2025R3WheelScene",gameId:t.gameId})}start(){return l(this,null,function*(){try{h.info("Game","start","Starting game"),this.baseGame.startScene("Levis2025R3WheelScene"),h.info("Game","start","Game started successfully")}catch(t){throw h.error("Game","start","Failed to start game",{error:t}),t}})}getBaseGame(){return this.baseGame}destroy(){this.baseGame&&(h.info("Game","destroy","Destroying game"),this.baseGame.destroy(),h.debug("Game","destroy","Game destroyed successfully"))}}document.addEventListener("DOMContentLoaded",()=>l(void 0,null,function*(){h.info("Main","unknown","main","Initializing Phaser Game");try{yield new ut().start(),h.info("Main","unknown","main","Game started successfully")}catch(n){h.error("Main","unknown","Failed to start game",{error:n})}}));class ye extends ie{constructor(e,s,i=0,a=0,r=null){super(e,s,i,a,r);d(this,"backgroundImageKey",null);d(this,"backgroundImage",null);d(this,"backgroundDimensions",null);d(this,"maintainAspectRatio",!0);d(this,"scalingMode","fit");d(this,"alignment",{x:"center",y:"center"});d(this,"backgroundColor","#000000");d(this,"originalWidth",1920);d(this,"originalHeight",1080);d(this,"isBackgroundLoaded",!1);d(this,"responsiveBackgroundImages",new Map);d(this,"logger",A.getInstance());this.logger.debug("BackgroundContainer","super","BackgroundContainer constructor called",{id:s,x:i,y:a,hasParent:!!r,sceneKey:e.scene.key}),this.setContainerType("background"),this.setConstraints({maxChildren:1e3,autoSize:!1,clipOverflow:!1,overflow:"visible",respectParentBounds:!0,maintainAspectRatio:!0}),this.setupResizeListener(),setTimeout(()=>{this.parent&&this.applyResponsiveSizing()},100)}static createFromConfig(e,s,i){const a=A.getInstance();a.debug("BackgroundContainer","createFromConfig","createFromConfig called",{objectId:e.id,config:e,sceneKey:s.scene.key,hasParent:!!i});try{const r=new ye(s,e.id,e.x||0,e.y||0,i||null);return a.debug("BackgroundContainer","createFromConfig","BackgroundContainer instance created",{objectId:e.id,phaserObjectType:r.constructor.name,position:{x:r.x,y:r.y}}),e.properties&&(a.debug("BackgroundContainer","createFromConfig","Applying properties from config",{objectId:e.id,properties:e.properties}),e.properties.interactive!==void 0&&(a.debug("BackgroundContainer","unknown","Setting interactive",{objectId:e.id,interactive:e.properties.interactive}),r.setInteractive(e.properties.interactive))),r.name=e.name||e.id,a.debug("BackgroundContainer","unknown","BackgroundContainer configured successfully",{objectId:e.id,finalSize:{width:r.width,height:r.height},finalPosition:{x:r.x,y:r.y},finalName:r.name}),r}catch(r){throw a.error("BackgroundContainer","unknown","Error in createFromConfig for ${config.id}:",r),r}}setOriginalDimensions(e,s){this.originalWidth=e,this.originalHeight=s,this.logger.debug("BackgroundContainer","setOriginalDimensions","Original dimensions set",{objectId:this.id,originalWidth:this.originalWidth,originalHeight:this.originalHeight})}setBackgroundImage(e,s={}){var i,a,r,o;this.logger.debug("BackgroundContainer","setOriginalDimensions","setBackgroundImage called",{objectId:this.id,textureKey:e,hasTexture:this.scene.textures.exists(e)}),this.backgroundImageKey=e,this.maintainAspectRatio=(i=s.maintainAspectRatio)!=null?i:!0,this.scalingMode=(a=s.scalingMode)!=null?a:"fit",this.alignment=(r=s.alignment)!=null?r:{x:"center",y:"center"},this.backgroundColor=(o=s.backgroundColor)!=null?o:"#000000",this.loadBackgroundImage(e)}hasResponsiveBackgroundImages(){const e=this.responsiveBackgroundImages.size>0;return this.logger.debug("BackgroundContainer","hasResponsiveBackgroundImages","Checking responsive background images",{objectId:this.id,responsiveBackgroundImages:Array.from(this.responsiveBackgroundImages.entries()),hasResponsive:e}),e}setResponsiveBackgroundImage(e,s,i={}){this.responsiveBackgroundImages.set("desktop",e),this.responsiveBackgroundImages.set("mobile",s),this.logger.debug("BackgroundContainer","hasResponsiveBackgroundImages","setResponsiveBackgroundImage called",{objectId:this.id,desktopImageKey:e,mobileImageKey:s,currentWidth:this.scene.game.scale.width});const a=this.scene.game.scale.width;let r=this.getBackgroundImageFromResponsiveConfig(a);r||(r=a>=992?e:s),this.logger.debug("BackgroundContainer","hasResponsiveBackgroundImages","Selected background image",{objectId:this.id,selectedImageKey:r,currentWidth:a,hasResponsiveConfig:!!r}),this.setBackgroundImage(r,i)}loadBackgroundImage(e){if(e)try{if(!this.scene.textures.exists(e)){this.logger.warn("BackgroundContainer","loadBackgroundImage",`Background texture "${e}" not found`,{objectId:this.id,availableTextures:Object.keys(this.scene.textures.list)});return}this.backgroundImage&&(this.logger.debug("BackgroundContainer","loadBackgroundImage","Removing existing background image",{objectId:this.id}),this.backgroundImage.destroy(),this.backgroundImage=null),this.backgroundImage=this.scene.add.image(0,0,e),this.backgroundDimensions={width:this.backgroundImage.width,height:this.backgroundImage.height},this.add(this.backgroundImage),this.isBackgroundLoaded=!0,this.ensureBackgroundImageZOrder(),this.refreshChildZOrders(),this.applyResponsiveSizing(),this.logger.debug("BackgroundContainer","loadBackgroundImage","Background image loaded: ${imageKey}",{objectId:this.id,imageSize:{width:this.backgroundImage.width,height:this.backgroundImage.height}})}catch(s){this.logger.error("BackgroundContainer","loadBackgroundImage","Failed to load background image:",s),this.isBackgroundLoaded=!1}}removeBackgroundImage(){this.backgroundImage&&(this.logger.debug("BackgroundContainer","removeBackgroundImage","Removing background image",{objectId:this.id}),this.backgroundImage.destroy(),this.backgroundImage=null),this.backgroundImageKey=null,this.backgroundDimensions=null,this.isBackgroundLoaded=!1,this.resize(800,600)}setBackgroundColor(e){this.backgroundColor=e,this.isBackgroundLoaded||this.createBackgroundRectangle()}createBackgroundRectangle(e,s){this.list.forEach(o=>{o instanceof B.GameObjects.Graphics&&o.destroy()});const i=e!=null?e:this.width,a=s!=null?s:this.height,r=this.scene.add.graphics();r.fillStyle(B.Display.Color.ValueToColor(this.backgroundColor).color),r.fillRect(0,0,i,a),this.add(r),this.logger.debug("BackgroundContainer","createBackgroundRectangle","Background rectangle created/updated",{objectId:this.id,backgroundColor:this.backgroundColor,rectangleSize:{width:i,height:a},containerSize:{width:this.width,height:this.height}})}getBackgroundImageFromResponsiveConfig(e){var s;try{if((s=this.injectedConfigs)!=null&&s.responsive){const i=this.id||"background-container";if(this.injectedConfigs.responsive.responsiveSettings){const a=this.injectedConfigs.responsive.responsiveSettings;for(const[,r]of Object.entries(a)){const c=r.find(f=>f.id===i);if(c){const{minWidth:f,maxWidth:g}=c.breakpointCondition;if(e>=f&&(g===void 0||e<=g))return c.layoutProperties.backgroundImage}}}if(this.injectedConfigs.responsive.default){const a=this.injectedConfigs.responsive.default.find(r=>r.id===i);if(a)return a.layoutProperties.backgroundImage}}if(this.responsiveBackgroundImages.size>0)return e>=992?this.responsiveBackgroundImages.get("desktop"):this.responsiveBackgroundImages.get("mobile")}catch(i){this.logger.warn("BackgroundContainer","getBackgroundImageFromResponsiveConfig","Failed to get background image from responsive config",{objectId:this.id,width:e,error:i instanceof Error?i.message:String(i)})}}applyResponsiveSizing(){if(!this.parent)return;const e=this.parent.getContainerBounds(),s=e.width,i=e.height;this.resize(s,i),this.propagateResizeToChildren(s,i),this.logger.debug("BackgroundContainer","applyResponsiveSizing","Responsive sizing applied from parent",{objectId:this.id,parentDimensions:{width:s,height:i},finalSize:{width:this.width,height:this.height},hasBackgroundImage:this.isBackgroundLoaded})}scaleBackgroundImageToFit(){if(!this.backgroundImage||!this.backgroundDimensions)return;const e=this.getCurrentResponsiveBehaviorFromContainer();switch(e.scaleStrategy){case"fit":if(e.maintainAspectRatio){const s=this.backgroundDimensions.width/this.backgroundDimensions.height,i=this.width/this.height;let a,r;i>s?(r=this.height,a=r*s):(a=this.width,r=a/s),this.backgroundImage.setDisplaySize(a,r),this.backgroundImage.setPosition(this.width/2,this.height/2),this.logger.debug("BackgroundContainer","scaleBackgroundImageToFit","Background image fitted with aspect ratio",{objectId:this.id,containerSize:{width:this.width,height:this.height},imageDisplaySize:{width:a,height:r},imagePosition:{x:this.width/2,y:this.height/2},scaleStrategy:"fit",maintainAspectRatio:!0})}else this.backgroundImage.setDisplaySize(this.width,this.height),this.backgroundImage.setPosition(this.width/2,this.height/2),this.logger.debug("BackgroundContainer","scaleBackgroundImageToFit","Background image fitted without aspect ratio",{objectId:this.id,containerSize:{width:this.width,height:this.height},imageDisplaySize:{width:this.width,height:this.height},imagePosition:{x:this.width/2,y:this.height/2},scaleStrategy:"fit",maintainAspectRatio:!1});break;case"stretch":default:this.backgroundImage.setDisplaySize(this.width,this.height),this.backgroundImage.setPosition(this.width/2,this.height/2),this.logger.debug("BackgroundContainer","scaleBackgroundImageToFit","Background image stretched to fill container",{objectId:this.id,containerSize:{width:this.width,height:this.height},imageDisplaySize:{width:this.width,height:this.height},imagePosition:{x:this.width/2,y:this.height/2},scaleStrategy:"stretch",note:"Image stretched to fill container completely"});break}this.ensureBackgroundImageZOrder()}getCurrentResponsiveBehaviorFromContainer(){var e,s,i,a,r,o,c;if((e=this.injectedConfigs)!=null&&e.responsive){const f=this.id||"background-container";if(this.injectedConfigs.responsive.responsiveSettings&&this.injectedConfigs.currentBreakpoint){const g=this.injectedConfigs.responsive.responsiveSettings[this.injectedConfigs.currentBreakpoint];if(g){const u=g.find(p=>p.id===f);if(u!=null&&u.layoutProperties)return{maintainAspectRatio:(s=u.layoutProperties.maintainAspectRatio)!=null?s:!0,scaleStrategy:(i=u.layoutProperties.scaleStrategy)!=null?i:"fit",alignment:(a=u.layoutProperties.alignment)!=null?a:"center"}}}if(this.injectedConfigs.responsive.default){const g=this.injectedConfigs.responsive.default.find(u=>u.id===f);if(g)return{maintainAspectRatio:(r=g.layoutProperties.maintainAspectRatio)!=null?r:!0,scaleStrategy:(o=g.layoutProperties.scaleStrategy)!=null?o:"fit",alignment:(c=g.layoutProperties.alignment)!=null?c:"center"}}}return{maintainAspectRatio:this.maintainAspectRatio,scaleStrategy:this.scalingMode,alignment:this.alignment.x+"-"+this.alignment.y}}setupResizeListener(){}cleanup(){}destroy(){this.cleanup(),super.destroy()}measureLayout(){return this.isBackgroundLoaded&&this.backgroundDimensions?this.backgroundDimensions:{width:this.width,height:this.height}}getBackgroundInfo(){return{isLoaded:this.isBackgroundLoaded,imageKey:this.backgroundImageKey,dimensions:this.backgroundDimensions,scalingMode:this.scalingMode,alignment:this.alignment,maintainAspectRatio:this.maintainAspectRatio}}updateBackgroundProperties(e){e.scalingMode&&(this.scalingMode=e.scalingMode),e.alignment&&(this.alignment=e.alignment,this.logger.debug("BackgroundContainer","getBackgroundInfo","Alignment updated",{objectId:this.id,newAlignment:e.alignment,oldAlignment:this.alignment})),e.maintainAspectRatio!==void 0&&(this.maintainAspectRatio=e.maintainAspectRatio),this.isBackgroundLoaded&&this.applyResponsiveSizing()}setAlignment(e){this.logger.debug("BackgroundContainer","setAlignment","Setting alignment",{objectId:this.id,oldAlignment:this.alignment,newAlignment:e}),this.alignment=e,this.isBackgroundLoaded&&this.applyResponsiveSizing()}getAlignment(){return m({},this.alignment)}switchBackgroundImageForDeviceType(e,s){if(this.responsiveBackgroundImages.size===0){this.logger.debug("BackgroundContainer","switchBackgroundImageForDeviceType","No responsive background images configured",{objectId:this.id,responsiveBackgroundImages:Array.from(this.responsiveBackgroundImages.entries())});return}const i=this.getBackgroundImageFromResponsiveConfig(e);if(!i){this.logger.warn("BackgroundContainer","switchBackgroundImageForDeviceType","No background image found in responsive config",{objectId:this.id,width:e});return}if(!this.scene.textures.exists(i)){this.logger.warn("BackgroundContainer","switchBackgroundImageForDeviceType","Background texture not found",{objectId:this.id,textureKey:i,availableTextures:Object.keys(this.scene.textures.list)});return}i!==this.backgroundImageKey?(this.logger.debug("BackgroundContainer","switchBackgroundImageForDeviceType","Switching background image",{objectId:this.id,oldImageKey:this.backgroundImageKey,newImageKey:i,width:e}),this.backgroundImageKey=i,this.loadBackgroundImage(i),this.ensureBackgroundImageZOrder(),this.refreshChildZOrders(),this.scene.events.emit("backgroundImageSwitched",this.id)):this.logger.debug("BackgroundContainer","switchBackgroundImageForDeviceType","Background image already correct for device type",{objectId:this.id,currentImageKey:this.backgroundImageKey,newImageKey:i,width:e})}debugBackgroundState(){this.logger.debug("BackgroundContainer","debugBackgroundState","Background Container Debug:",{id:this.id,backgroundInfo:this.getBackgroundInfo(),containerBounds:{x:this.x,y:this.y,width:this.width,height:this.height},phaserObjectBounds:{x:this.x,y:this.y,width:this.width,height:this.height},children:this.children.length,gameDimensions:{width:this.scene.game.scale.width,height:this.scene.game.scale.height},currentAlignment:this.alignment})}testAlignments(){const e=[{x:"left",y:"top"},{x:"center",y:"top"},{x:"right",y:"top"},{x:"left",y:"center"},{x:"center",y:"center"},{x:"right",y:"center"},{x:"left",y:"bottom"},{x:"center",y:"bottom"},{x:"right",y:"bottom"}];this.logger.debug("BackgroundContainer","testAlignments","Testing all alignment configurations",{objectId:this.id,alignments:e}),this.setAlignment({x:"center",y:"center"})}setBackground(e){e.color&&this.setBackgroundColor(e.color)}setConstraints(e){e.maintainAspectRatio!==void 0&&(this.maintainAspectRatio=e.maintainAspectRatio)}setContainerType(e){this.containerType=e}ensureBackgroundImageZOrder(){this.backgroundImage&&(this.backgroundImage.setDepth(-1),this.logger.debug("BackgroundContainer","ensureBackgroundImageZOrder","Background image z-order ensured",{objectId:this.id,depth:-1}))}refreshChildZOrders(){var a,r,o,c,f,g,u,p,C;this.logger.debug("BackgroundContainer","refreshChildZOrders","Refreshing child z-orders",{objectId:this.id,childCount:this.children.length});let e=null,s="unknown";if((r=(a=this.scene.sceneConfigs)==null?void 0:a.scene)!=null&&r.gameObjects?(e=this.scene.sceneConfigs.scene,s="sceneConfigs.scene"):(o=this.scene.sceneConfigs)!=null&&o.gameObjects?(e=this.scene.sceneConfigs,s="sceneConfigs"):(g=(f=(c=this.scene.configManager)==null?void 0:c.sceneLoader)==null?void 0:f.sceneConfig)!=null&&g.gameObjects?(e=this.scene.configManager.sceneLoader.sceneConfig,s="configManager.sceneLoader.sceneConfig"):(p=(u=this.scene.configManager)==null?void 0:u.sceneConfig)!=null&&p.gameObjects&&(e=this.scene.configManager.sceneConfig,s="configManager.sceneConfig"),!(e!=null&&e.gameObjects)){this.logger.debug("BackgroundContainer","sceneConfig","No scene config available for z-order refresh, using fallback",{objectId:this.id,triedPaths:["sceneConfigs.scene","sceneConfigs","configManager.sceneLoader.sceneConfig","configManager.sceneConfig"],availablePaths:Object.keys(this.scene||{}),hasSceneConfigs:!!this.scene.sceneConfigs,hasConfigManager:!!this.scene.configManager}),this.assignFallbackZOrders();return}const i=e.gameObjects.find(k=>k.id===this.id);if(!(i!=null&&i.children)){this.logger.debug("BackgroundContainer","sceneConfig","No background config found for z-order refresh, using fallback",{objectId:this.id,configPath:s,availableGameObjects:((C=e.gameObjects)==null?void 0:C.map(k=>k.id))||[],backgroundConfig:i||"not found"}),this.assignFallbackZOrders();return}this.children.forEach((k,ae)=>{if(k&&typeof k.setDepth=="function"){const X=i.children.find(K=>K.id===k.name||K.id===k.id||K.id===k.id);if((X==null?void 0:X.zOrder)!==void 0)k.setDepth(X.zOrder),this.logger.debug("BackgroundContainer","sceneConfig","Child z-order refreshed from config",{objectId:this.id,childName:k.name||k.id||"unnamed",childIndex:ae,configZOrder:X.zOrder,configPath:s});else{const K=ae+1;k.setDepth(K),this.logger.debug("BackgroundContainer","sceneConfig","Child z-order set to fallback",{objectId:this.id,childName:k.name||k.id||"unnamed",childIndex:ae,fallbackZOrder:K,configPath:s})}}})}assignFallbackZOrders(){this.logger.debug("BackgroundContainer","assignFallbackZOrders","Assigning fallback z-orders",{objectId:this.id,childCount:this.children.length}),this.children.forEach((e,s)=>{if(e&&typeof e.setDepth=="function"){const i=s+1;e.setDepth(i),this.logger.debug("BackgroundContainer","assignFallbackZOrders","Fallback z-order assigned",{objectId:this.id,childName:e.name||e.id||"unnamed",childIndex:s,fallbackZOrder:i})}})}setInteractive(e){return e?this.setInteractive():this.disableInteractive(),this}resizeSelf(e,s){if(this.logger.debug("BackgroundContainer","setInteractive","resizeSelf called",{objectId:this.id,newDimensions:{width:e,height:s},currentDimensions:{width:this.width,height:this.height},hasBackgroundImage:!!this.backgroundImage,hasParent:!!this.parent}),this.backgroundImageKey&&this.hasResponsiveBackgroundImages()?(this.logger.debug("BackgroundContainer","setInteractive","Checking if background image should be switched",{objectId:this.id,currentWidth:e,hasBackgroundImageKey:!!this.backgroundImageKey,hasResponsiveBackgroundImages:this.hasResponsiveBackgroundImages(),responsiveBackgroundImages:Array.from(this.responsiveBackgroundImages.entries())}),this.switchBackgroundImageForDeviceType(e,s)):this.logger.debug("BackgroundContainer","setInteractive","Skipping background image switch check",{objectId:this.id,hasBackgroundImageKey:!!this.backgroundImageKey,hasResponsiveBackgroundImages:this.hasResponsiveBackgroundImages(),responsiveBackgroundImages:Array.from(this.responsiveBackgroundImages.entries())}),this.isBackgroundLoaded&&this.backgroundDimensions){const i=this.getCurrentResponsiveBehaviorFromContainer();this.logger.debug("BackgroundContainer","setInteractive","Background image loaded, applying responsive behavior",{objectId:this.id,responsiveBehavior:i,scaleStrategy:i.scaleStrategy,maintainAspectRatio:i.maintainAspectRatio});let a,r,o;switch(i.scaleStrategy){case"fit":if(i.maintainAspectRatio){const c=this.backgroundDimensions.width/this.backgroundDimensions.height;e/s>c?(r=s,a=r*c):(a=e,r=a/c);const g=e/2,u=s/2;o={x:g-a/2,y:u-r/2}}else a=e,r=s,o={x:0,y:0};break;case"stretch":default:a=e,r=s,o={x:0,y:0};break}this.setSize(a,r),this.setPosition(o.x,o.y),this.scaleBackgroundImageToFit(),this.logger.debug("BackgroundContainer","setInteractive","Background container resized with responsive behavior",{objectId:this.id,responsiveBehavior:i,finalSize:{width:a,height:r},finalPosition:o,backgroundDimensions:this.backgroundDimensions})}else this.logger.debug("BackgroundContainer","unknown","No background image, using Container responsive sizing",{objectId:this.id,providedDimensions:{width:e,height:s}})}resizeAfter(e,s){this.logger.debug("BackgroundContainer","unknown","resizeAfter called",{objectId:this.id,newDimensions:{width:e,height:s}}),this.ensureBackgroundImageZOrder(),this.refreshChildZOrders(),this.logger.debug("BackgroundContainer","unknown","Post-resize operations completed",{objectId:this.id})}}const ft=Object.freeze(Object.defineProperty({__proto__:null,BackgroundContainer:ye},Symbol.toStringTag,{value:"Module"}));class se extends B.GameObjects.Rectangle{constructor(e,s,i=0,a=0,r=100,o=100,c=16777215,f=null){super(e,i,a,r,o,c);d(this,"shapeType","rectangle");d(this,"_id");d(this,"_parent");d(this,"logger",A.getInstance());d(this,"currentStyle",{maintainAspectRatio:!1,scaleStrategy:"stretch",alignment:"center"});d(this,"layoutProperties",{maintainAspectRatio:!1,scaleStrategy:"stretch",alignment:"center"});this._id=s,this._parent=f,this.name=s,this.setOrigin(0,0),this.logger.debug("Rectangle","super","Rectangle created",{id:s,dimensions:{width:r,height:o},fillColor:c,position:{x:i,y:a},depth:this.depth,visible:this.visible,active:this.active,alpha:this.alpha,scale:{x:this.scaleX,y:this.scaleY}})}setStyle(e){this.logger.debug("Rectangle","setStyle","Setting style properties",{id:this.id,newStyle:e}),this.currentStyle=m({},e),this.applyPositionProperties(e),this.applySizeProperties(e),this.applyVisualProperties(e),this.applyFillAndStrokeProperties(e)}getStyle(){return m({},this.currentStyle)}getStyleId(){return this.id}applyPositionProperties(e){e.positionX!==void 0&&(typeof e.positionX=="number"?this.x=e.positionX:e.positionX==="center"&&(this.x=0)),e.positionY!==void 0&&(typeof e.positionY=="number"?this.y=e.positionY:e.positionY==="center"&&(this.y=0)),e.positionZ!==void 0&&this.setDepth(e.positionZ)}applySizeProperties(e){e.width!==void 0&&typeof e.width=="number"&&(this.width=e.width),e.height!==void 0&&typeof e.height=="number"&&(this.height=e.height)}applyVisualProperties(e){if(e.alpha!==void 0){if(typeof e.alpha=="number")this.setAlpha(e.alpha);else if(typeof e.alpha=="object"&&"min"in e.alpha&&"max"in e.alpha){const s=e.alpha.getRandomValue();this.setAlpha(s)}}if(e.rotation!==void 0){if(typeof e.rotation=="number")this.setRotation(e.rotation);else if(typeof e.rotation=="object"&&"min"in e.rotation&&"max"in e.rotation){const s=e.rotation.getRandomValue();this.setRotation(s)}}e.visible!==void 0&&this.setVisible(e.visible),e.interactive!==void 0&&(e.interactive?this.setInteractive():this.disableInteractive())}applyFillAndStrokeProperties(e){if(e.backgroundColor!==void 0&&this.setFillStyle(e.backgroundColor),e.borderColor!==void 0&&e.borderWidth!==void 0){if(typeof e.borderWidth=="number")this.setStrokeStyle(e.borderWidth,e.borderColor);else if(typeof e.borderWidth=="object"&&"min"in e.borderWidth&&"max"in e.borderWidth){const s=e.borderWidth.getRandomValue();this.setStrokeStyle(s,e.borderColor)}}}get id(){return this._id}get parent(){return this._parent}get phaserObject(){return this}get isActive(){return this.active}get isVisible(){return this.visible}get isInteractive(){var e;return((e=this.input)==null?void 0:e.enabled)||!1}get isDestroyed(){return this.destroyed||!1}get position(){return{x:this.x,y:this.y}}get size(){return{width:this.width,height:this.height}}get interactive(){var e;return((e=this.input)==null?void 0:e.enabled)||!1}getBounds(){return super.getBounds()}get dimensions(){return{width:this.width,height:this.height}}get strokeWidth(){return 0}setFillColor(e){this.setFillStyle(e)}setStroke(e,s){this.setStrokeStyle(s,e)}removeStroke(){this.setStrokeStyle(0,0)}resize(e,s){this.logger.debug("Rectangle","resize","Resizing rectangle",{id:this.id,oldDimensions:this.dimensions,newDimensions:{width:e,height:s}}),this.setSize(e,s)}show(){this.setVisible(!0)}hide(){this.setVisible(!1)}initialize(){this.logger.debug("Rectangle","initialize","Initializing rectangle",{id:this.id}),this.setActive(!0),this.setVisible(!0)}update(e,s){}activate(){this.logger.debug("Rectangle","activate","Activating rectangle",{id:this.id}),this.setActive(!0)}deactivate(){this.logger.debug("Rectangle","deactivate","Deactivating rectangle",{id:this.id}),this.setActive(!1)}clone(){return this.logger.debug("Rectangle","clone","Cloning rectangle",{id:this.id}),new se(this.scene,`${this.id}_clone`,this.position.x,this.position.y,this.size.width,this.size.height,this.fillColor||16777215,this.parent)}getSize(){return this.size}getPosition(){return this.position}getCornerRadius(){return this.radius}handleResponsiveResize(e,s){this.logger.debug("Rectangle","handleResponsiveResize","Handling responsive resize from scene",{id:this.id,newDimensions:{width:e,height:s},currentDimensions:this.dimensions}),this.resize(e,s)}logCurrentState(){var e;this.logger.debug("Rectangle","logCurrentState","Current Rectangle state",{id:this.id,dimensions:this.dimensions,position:this.position,depth:this.depth,visible:this.visible,active:this.active,alpha:this.alpha,scale:{x:this.scaleX,y:this.scaleY},fillColor:this.fillColor,strokeWidth:this.strokeWidth,parentId:((e=this.parent)==null?void 0:e.id)||"none",sceneKey:this.scene.scene.key})}static createFromConfig(e,s,i){const a=A.getInstance();a.debug("Rectangle","createFromConfig","createFromConfig called",{objectId:e.id,config:e,sceneKey:s.scene.key,hasParent:!!i,parentInfo:i?{id:i.id,type:i.constructor.name,bounds:i.getContainerBounds()}:null});try{let r=e.width||100,o=e.height||100;if(i&&(r==="fill"||o==="fill")){const f=i.getContainerBounds();r==="fill"&&(r=f.width),o==="fill"&&(o=f.height)}a.debug("Rectangle","createFromConfig","Dimensions resolved",{objectId:e.id,finalDimensions:{width:r,height:o},hasParent:!!i});const c=new se(s,e.id,e.x||0,e.y||0,r,o,e.fillColor||16777215,i||null);return e.properties&&(e.properties.strokeColor!==void 0&&e.properties.strokeWidth!==void 0&&c.setStroke(e.properties.strokeColor,e.properties.strokeWidth),e.properties.interactive!==void 0&&c.setInteractive(e.properties.interactive)),a.debug("Rectangle","createFromConfig","Final Rectangle state after property application",{objectId:e.id,finalDimensions:c.dimensions,finalPosition:c.position,finalDepth:c.depth,finalVisible:c.visible,finalActive:c.active,finalAlpha:c.alpha,finalScale:{x:c.scaleX,y:c.scaleY},fillColor:c.fillColor,strokeWidth:c.strokeWidth}),c.logCurrentState(),a.debug("Rectangle","createFromConfig","Rectangle created successfully from config",{objectId:e.id,finalDimensions:c.dimensions,hasStroke:c.strokeWidth>0,position:c.position,depth:c.depth,visible:c.visible,active:c.active,alpha:c.alpha,scale:{x:c.scaleX,y:c.scaleY}}),c}catch(r){throw a.error("Rectangle","logCurrentState","Error in createFromConfig for ${config.id}:",r),r}}}const mt=Object.freeze(Object.defineProperty({__proto__:null,Rectangle:se},Symbol.toStringTag,{value:"Module"}));export{bt as c,Ct as g};
//# sourceMappingURL=common-DJaWdktT.js.map
